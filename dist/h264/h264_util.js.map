{"version":3,"sources":["../../src/h264/h264_util.js"],"names":["Util","src","src_length","length","dst","Buffer","allocUnsafe","dst_idx","i","slice","exports","module"],"mappings":";;;;;;AAAA;;;;IAIMA,I;;;;;;;kCACeC,G,EAAK;AAClB,gBAAIC,aAAaD,IAAIE,MAArB;AACA,gBAAIC,MAAMC,OAAOC,WAAP,CAAmBJ,UAAnB,CAAV;AACA,gBAAIK,UAAU,CAAd;;AAEA,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIN,UAApB,EAAgCM,GAAhC,EAAqC;AACjC,oBAAIA,KAAK,CAAT,EAAY;AACR;AACA,wBAAIP,IAAIO,CAAJ,MAAW,IAAX,IAAmBP,IAAIO,IAAI,CAAR,MAAe,IAAlC,IAA0CP,IAAIO,IAAI,CAAR,MAAe,IAA7D,EAAmE;AAC/D;AACH;AACJ;AACDJ,oBAAIG,OAAJ,IAAeN,IAAIO,CAAJ,CAAf;AACAD;AACH;AACD,mBAAOH,IAAIK,KAAJ,CAAU,CAAV,EAAaF,OAAb,CAAP;AACH;;;;;;AAGLG,UAAQC,OAAOD,OAAP,GAAeV,IAAvB","file":"h264_util.js","sourcesContent":["/**\r\n * Created by Luky on 2017/8/2.\r\n */\r\n\r\nclass Util{\r\n    static ebsp2rbsp(src) {\r\n        let src_length = src.length;\r\n        let dst = Buffer.allocUnsafe(src_length);\r\n        let dst_idx = 0;\r\n\r\n        for (let i = 0; i < src_length; i++) {\r\n            if (i >= 2) {\r\n                // Unescape: Skip 0x03 after 00 00\r\n                if (src[i] === 0x03 && src[i - 1] === 0x00 && src[i - 2] === 0x00) {\r\n                    continue;\r\n                }\r\n            }\r\n            dst[dst_idx] = src[i];\r\n            dst_idx++;\r\n        }\r\n        return dst.slice(0, dst_idx);\r\n    }\r\n}\r\n\r\nexports=module.exports=Util;"]}