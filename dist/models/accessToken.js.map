{"version":3,"sources":["../../src/models/accessToken.js"],"names":["mongoose","require","Schema","duration","ObjectId","Types","TokenSchema","token","type","String","unique","required","user","ref","createAt","Date","default","now","expires","virtual","get","getTime","Number","parseInt","expiresAt","module","exports","model"],"mappings":";;AAAA;AACA,IAAMA,WAASC,QAAQ,UAAR,CAAf;AACA,IAAMC,SAASF,SAASE,MAAxB;AACA,IAAMC,WAAW,KAAK,EAAL,GAAU,EAAV,GAAe,CAAhC,C,CAAmC;AACnC,IAAMC,WAAWF,OAAOG,KAAP,CAAaD,QAA9B;;AAEA,IAAME,cAAc,IAAIJ,MAAJ,CAAW;AAC3BK,WAAO;AACHC,cAAMC,MADH;AAEHC,gBAAQ,IAFL;AAGHC,kBAAU;AAHP,KADoB;AAM3BC,UAAM;AACFJ,cAAMJ,QADJ;AAEFS,aAAK,OAFH;AAGFF,kBAAU;AAHR,KANqB;AAW3BG,cAAU;AACNN,cAAMO,IADA;AAENC,iBAASD,KAAKE,GAAL,EAFH;AAGNC,iBAASf;AAHH;AAXiB,CAAX,CAApB;;AAkBA;AACAG,YAAYa,OAAZ,CAAoB,WAApB,EAAiCC,GAAjC,CAAqC,YAAU;AAC3C,WAAO,IAAIL,IAAJ,CAAS,KAAKD,QAAL,CAAcO,OAAd,KAA0BlB,WAAW,IAA9C,CAAP;AACH,CAFD;;AAIA;AACAG,YAAYa,OAAZ,CAAoB,WAApB,EAAiCC,GAAjC,CAAqC,YAAU;AAC3C,WAAOE,OAAOC,QAAP,CAAiB,CAAC,KAAKC,SAAL,GAAiBT,KAAKE,GAAL,EAAlB,IAAgC,IAAjD,EAAwD,EAAxD,CAAP;AACH,CAFD;;AAIAQ,OAAOC,OAAP,GAAiB1B,SAAS2B,KAAT,CAAe,QAAf,EAAyBrB,WAAzB,CAAjB","file":"accessToken.js","sourcesContent":["//import mongoose from 'mongoose';\r\nconst mongoose=require('mongoose');\r\nconst Schema = mongoose.Schema;\r\nconst duration = 60 * 60 * 24 * 7; // 7days\r\nconst ObjectId = Schema.Types.ObjectId;\r\n\r\nconst TokenSchema = new Schema({\r\n    token: {\r\n        type: String,\r\n        unique: true,\r\n        required: true\r\n    },\r\n    user: {\r\n        type: ObjectId,\r\n        ref: 'Users',\r\n        required: true\r\n    },\r\n    createAt: {\r\n        type: Date,\r\n        default: Date.now(),\r\n        expires: duration\r\n    }\r\n});\r\n\r\n// 过期时间\r\nTokenSchema.virtual('expiresAt').get(function(){\r\n    return new Date(this.createAt.getTime() + duration * 1000);\r\n});\r\n\r\n// 剩余时间\r\nTokenSchema.virtual('expiresIn').get(function(){\r\n    return Number.parseInt(((this.expiresAt - Date.now()) / 1000), 10);\r\n});\r\n\r\nmodule.exports = mongoose.model('Tokens', TokenSchema);"]}