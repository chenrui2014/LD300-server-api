{"version":3,"sources":["../../src/acc/acc_adts_parser.js"],"names":["ExpGolomb","require","freqs","ADTSHeaderParser","buf","gb","length","readUN","ret","ID","skipBits","protection_absent","readBoolean","profile","freqIndex","freq","channel","acc_frame_length","acc_raw_data_length","acc_raw_data_index","fixedRate","blocks","exports","module"],"mappings":";;;;;;AAAA;;;;AAIA,IAAMA,YAAUC,QAAQ,gBAAR,CAAhB;;AAEA,IAAMC,QAAM,CACR,KADQ,EACF,KADE,EACI,KADJ,EACU,KADV,EACgB,KADhB,EACsB,KADtB,EAC4B,KAD5B,EACkC,KADlC,EAER,KAFQ,EAEF,KAFE,EAEI,KAFJ,EAEU,IAFV,EAEgB,IAFhB,EAEsB,CAFtB,EAE4B,CAF5B,EAEkC,CAFlC,CAAZ;;IAKMC,gB;;;;;;;wCACqBC,G,EAAI;AACvB,gBAAIC,KAAK,IAAIL,SAAJ,CAAcI,GAAd,CAAT;AACA,gBAAGA,IAAIE,MAAJ,GAAW,CAAd,EAAiB,OAAO,EAAP;AACjB,gBAAGD,GAAGE,MAAH,CAAU,EAAV,MAAgB,KAAnB,EAA0B,OAAO,EAAP;AAC1B,gBAAIC,MAAI,EAAR;AACAA,gBAAIC,EAAJ,GAAOJ,GAAGE,MAAH,CAAU,CAAV,CAAP;AACAF,eAAGK,QAAH,CAAY,CAAZ,EANuB,CAMR;AACfF,gBAAIG,iBAAJ,GAAsBN,GAAGO,WAAH,EAAtB;AACAJ,gBAAIK,OAAJ,GAAYR,GAAGE,MAAH,CAAU,CAAV,CAAZ;AACAC,gBAAIM,SAAJ,GAAcT,GAAGE,MAAH,CAAU,CAAV,CAAd;AACAC,gBAAIO,IAAJ,GAASb,MAAMM,IAAIM,SAAV,CAAT;AACAT,eAAGK,QAAH,CAAY,CAAZ,EAXuB,CAWR;AACfF,gBAAIQ,OAAJ,GAAYX,GAAGE,MAAH,CAAU,CAAV,CAAZ;AACAF,eAAGK,QAAH,CAAY,CAAZ,EAbuB,CAaR;AACfF,gBAAIS,gBAAJ,GAAqBZ,GAAGE,MAAH,CAAU,EAAV,CAArB;AACAC,gBAAIU,mBAAJ,GAAwBV,IAAIS,gBAAJ,IAAsBT,IAAIG,iBAAJ,GAAsB,CAAtB,GAAwB,CAA9C,CAAxB;AACAH,gBAAIW,kBAAJ,GAAuBX,IAAIG,iBAAJ,GAAsB,CAAtB,GAAwB,CAA/C;AACAH,gBAAIY,SAAJ,GAAcf,GAAGE,MAAH,CAAU,EAAV,MAAgB,KAA9B;AACAC,gBAAIa,MAAJ,GAAWhB,GAAGE,MAAH,CAAU,CAAV,IAAa,CAAxB;AACA,mBAAOC,GAAP;AACH;;;;;;AAGLc,UAAQC,OAAOD,OAAP,GAAenB,gBAAvB","file":"acc_adts_parser.js","sourcesContent":["/**\r\n * Created by Luky on 2017/8/15.\r\n */\r\n\r\nconst ExpGolomb=require('../h264/golomb');\r\n\r\nconst freqs=[\r\n    96000,88200,64000,48000,44100,32000,24000,22050,\r\n    16000,12000,11025,8000 ,7350 ,0    ,0    ,0\r\n];\r\n\r\nclass ADTSHeaderParser{\r\n    static ParseADTSHeader(buf){\r\n        let gb = new ExpGolomb(buf);\r\n        if(buf.length<7) return {};\r\n        if(gb.readUN(12)!==0xFFF) return {};\r\n        let ret={};\r\n        ret.ID=gb.readUN(1);\r\n        gb.skipBits(2);//level\r\n        ret.protection_absent=gb.readBoolean();\r\n        ret.profile=gb.readUN(2);\r\n        ret.freqIndex=gb.readUN(4);\r\n        ret.freq=freqs[ret.freqIndex];\r\n        gb.skipBits(1);//private_bit\r\n        ret.channel=gb.readUN(3);\r\n        gb.skipBits(4);//original_copy,home,copyright_1,copyright_2\r\n        ret.acc_frame_length=gb.readUN(13);\r\n        ret.acc_raw_data_length=ret.acc_frame_length-(ret.protection_absent?7:9);\r\n        ret.acc_raw_data_index=ret.protection_absent?7:9;\r\n        ret.fixedRate=gb.readUN(11)===0x7ff;\r\n        ret.blocks=gb.readUN(2)+1;\r\n        return ret;\r\n    }\r\n}\r\n\r\nexports=module.exports=ADTSHeaderParser;\r\n"]}