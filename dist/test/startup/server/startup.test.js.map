{"version":3,"sources":["../../../../src/test/startup/server/startup.test.js"],"names":["require","db","file","StartUp","vHost","_","process","debugPort","s","vh","dbInstance","before","Promise","all","start","after","close","stop","console","log","exit","run","setInterval","r","random","send","CMD","normal","alarm","then"],"mappings":";;;;;;;;;;eAAgBA,QAAQ,YAAR,C;IAATC,E,YAAAA,E;IAAGC,I,YAAAA,I;;AACV,IAAMC,UAAQH,QAAQ,0BAAR,CAAd;AACA,IAAMI,QAAMJ,QAAQ,4BAAR,CAAZ;AACA,IAAMK,IAAEL,QAAQ,QAAR,CAAR;AACAM,QAAQC,SAAR,GAAkB,IAAlB;;AAEA,IAAIC,IAAE,IAAN;AAAA,IAAWC,KAAG,IAAd;AACA,IAAIC,aAAW,IAAf;;AAEA,IAAIC;AAAA,0EAAO;AAAA;AAAA;AAAA;AAAA;AACP;AACA;AACAH,4BAAE,IAAIL,OAAJ,EAAF;AACAM,6BAAG,IAAIL,KAAJ,CAAU,CAAV,CAAH;AAJO;AAAA,+BAKDQ,QAAQC,GAAR,CAAY,CAACJ,GAAGK,KAAH,EAAD,EAAYN,EAAEM,KAAF,EAAZ,CAAZ,CALC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA,GAAJ;;AAQA,IAAIC;AAAA,2EAAM;AAAA;AAAA;AAAA;AAAA;AAAA,6BACHL,UADG;AAAA;AAAA;AAAA;;AAAA;AAAA,+BACeA,WAAWM,KAAX,EADf;;AAAA;AAENR,0BAAES,IAAF;AACAC,gCAAQC,GAAR,CAAY,KAAZ;AACAb,gCAAQc,IAAR;;AAJM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAN;;AAAA;AAAA;AAAA;AAAA,GAAJ;;AAOA,IAAIC,MAAK,SAALA,GAAK,GAAI;AACTC,gBAAY,YAAI;AACZ,YAAIC,IAAElB,EAAEmB,MAAF,CAAS,CAAT,EAAW,CAAX,EAAa,KAAb,CAAN;AACAD,cAAI,CAAJ,GAAMd,GAAGgB,IAAH,CAAQrB,MAAMsB,GAAN,CAAUC,MAAlB,CAAN,GAAgClB,GAAGgB,IAAH,CAAQrB,MAAMsB,GAAN,CAAUE,KAAlB,EAAwB,GAAxB,CAAhC;AACH,KAHD,EAGE,KAHF;AAIH,CALD;;AAOAjB,SAASkB,IAAT,CAAcR,GAAd;AACA","file":"startup.test.js","sourcesContent":["const {db,file}=require('../../init');\r\nconst StartUp=require('../../../servers/startup');\r\nconst vHost=require('../../../host/virtual_host');\r\nconst _=require('lodash');\r\nprocess.debugPort=9600;\r\n\r\nlet s=null,vh=null;\r\nlet dbInstance=null;\r\n\r\nlet before=async ()=>{\r\n    //打开注释启动数据库取数据\r\n    //dbInstance=await db();\r\n    s=new StartUp();\r\n    vh=new vHost(1);\r\n    await Promise.all([vh.start(),s.start()]);\r\n};\r\n\r\nlet after=async ()=>{\r\n    if(dbInstance)await  dbInstance.close();\r\n    s.stop();\r\n    console.log('结束了');\r\n    process.exit();\r\n};\r\n\r\nlet run= ()=>{\r\n    setInterval(()=>{\r\n        let r=_.random(0,1,false);\r\n        r===0?vh.send(vHost.CMD.normal):vh.send(vHost.CMD.alarm,100);\r\n    },40000);\r\n};\r\n\r\nbefore().then(run);\r\n//setTimeout(after,15000);"]}