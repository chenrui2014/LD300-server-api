{"version":3,"sources":["../../../../src/test/startup/client/flv.js"],"names":["f","exports","module","define","amd","g","window","global","self","flvjs","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","_dereq_","process","factory","ES6Promise","objectOrFunction","x","isFunction","_isArray","undefined","Array","isArray","Object","prototype","toString","len","vertxNext","customSchedulerFn","asap","callback","arg","queue","flush","scheduleFlush","setScheduler","scheduleFn","setAsap","asapFn","browserWindow","browserGlobal","BrowserMutationObserver","MutationObserver","WebKitMutationObserver","isNode","isWorker","Uint8ClampedArray","importScripts","MessageChannel","useNextTick","nextTick","useVertxTimer","useSetTimeout","useMutationObserver","iterations","observer","node","document","createTextNode","observe","characterData","data","useMessageChannel","channel","port1","onmessage","port2","postMessage","globalSetTimeout","setTimeout","attemptVertx","vertx","runOnLoop","runOnContext","then","onFulfillment","onRejection","_arguments","arguments","parent","child","constructor","noop","PROMISE_ID","makePromise","_state","invokeCallback","_result","subscribe","resolve","object","Constructor","promise","_resolve","Math","random","substring","PENDING","FULFILLED","REJECTED","GET_THEN_ERROR","ErrorObject","selfFulfillment","TypeError","cannotReturnOwn","getThen","error","tryThen","value","fulfillmentHandler","rejectionHandler","handleForeignThenable","thenable","sealed","fulfill","reason","_reject","_label","handleOwnThenable","handleMaybeThenable","maybeThenable","then$$","publishRejection","_onerror","publish","_subscribers","subscribers","settled","detail","TRY_CATCH_ERROR","tryCatch","hasCallback","succeeded","failed","initializePromise","resolver","resolvePromise","rejectPromise","id","nextId","Enumerator","input","_instanceConstructor","_input","_remaining","_enumerate","validationError","_eachEntry","entry","c","resolve$$","_then","_settledAt","Promise","_willSettleAt","state","enumerator","all","entries","race","_","reject","needsResolver","needsNew","_setScheduler","_setAsap","_asap","_catch","polyfill","local","Function","P","promiseToString","cast","EventEmitter","_events","_maxListeners","defaultMaxListeners","setMaxListeners","isNumber","isNaN","emit","type","er","handler","args","listeners","isObject","err","context","isUndefined","slice","apply","addListener","listener","m","newListener","push","warned","console","trace","on","once","fired","removeListener","list","position","splice","removeAllListeners","key","ret","listenerCount","evlistener","emitter","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","clearTimeout","runTimeout","fun","runClearTimeout","marker","draining","currentQueue","queueIndex","cleanUpNextTick","concat","drainQueue","timeout","run","Item","array","title","browser","env","argv","version","versions","off","prependListener","prependOnceListener","name","binding","cwd","chdir","dir","umask","bundleFn","sources","cache","stringify","JSON","fn","options","wkey","cacheKeys","keys","exp","default","floor","pow","wcache","skey","scache","workerSources","resolveSources","depPath","depKey","src","map","join","URL","webkitURL","mozURL","msURL","blob","Blob","bare","workerUrl","createObjectURL","worker","Worker","objectURL","defineProperty","createDefaultConfig","defaultConfig","enableWorker","enableStashBuffer","stashInitialSize","isLive","lazyLoad","lazyLoadMaxDuration","lazyLoadRecoverDuration","deferLoadAfterSourceOpen","autoCleanupMaxBackwardDuration","autoCleanupMinBackwardDuration","statisticsInfoReportInterval","fixAudioTimestampGap","accurateSeek","seekType","seekParamStart","seekParamEnd","rangeLoadZeroStart","customSeekHandler","reuseRedirectedURL","assign","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","protoProps","staticProps","_ioController","_ioController2","_interopRequireDefault","_config","obj","__esModule","_classCallCheck","instance","Features","supportMSEH264Playback","MediaSource","isTypeSupported","supportNetworkStreamIO","ioctl","loaderType","destroy","getNetworkLoaderTypeName","supportNativeMediaPlayback","mimeType","videoElement","createElement","canPlay","canPlayType","getFeatureList","features","mseFlvPlayback","mseLiveFlvPlayback","networkStreamIO","networkLoaderName","nativeMP4H264Playback","nativeWebmVP8Playback","nativeWebmVP9Playback","MediaInfo","duration","hasAudio","hasVideo","audioCodec","videoCodec","audioDataRate","videoDataRate","audioSampleRate","audioChannelCount","width","height","fps","profile","level","chromaFormat","sarNum","sarDen","metadata","segments","segmentCount","hasKeyframesIndex","keyframesIndex","isComplete","audioInfoComplete","videoInfoComplete","isSeekable","getNearestKeyframe","milliseconds","table","keyframeIdx","_search","times","index","fileposition","filepositions","idx","last","mid","lbound","ubound","SampleInfo","dts","pts","originalDts","isSync","isSyncPoint","MediaSegmentInfo","beginDts","endDts","beginPts","endPts","originalBeginDts","originalEndDts","syncPoints","firstSample","lastSample","appendSyncPoint","sampleInfo","IDRSampleList","_list","clear","appendArray","getLastSyncPointBeforeDts","MediaSegmentInfoList","_type","_lastAppendLocation","isEmpty","_searchNearestSegmentBefore","_searchNearestSegmentAfter","append","mediaSegmentInfo","msi","lastAppendIdx","insertIdx","getLastSegmentBefore","getLastSampleBefore","segment","getLastSyncPointBefore","segmentIdx","get","_events2","_logger","_logger2","_browser","_browser2","_mseEvents","_mseEvents2","_mediaSegmentInfo","_exception","MSEController","config","TAG","_emitter","autoCleanupSourceBuffer","onSourceOpen","_onSourceOpen","bind","onSourceEnded","_onSourceEnded","onSourceClose","_onSourceClose","onSourceBufferError","_onSourceBufferError","onSourceBufferUpdateEnd","_onSourceBufferUpdateEnd","_mediaSource","_mediaSourceObjectURL","_mediaElement","_isBufferFull","_hasPendingEos","_requireSetMediaDuration","_pendingMediaDuration","_pendingSourceBufferInit","_mimeTypes","video","audio","_sourceBuffers","_lastInitSegments","_pendingSegments","_pendingRemoveRanges","_idrList","detachMediaElement","event","attachMediaElement","mediaElement","IllegalStateException","ms","addEventListener","ps","sb","readyState","removeSourceBuffer","removeEventListener","endOfStream","message","removeAttribute","revokeObjectURL","appendInitSegment","initSegment","deferred","is","container","codec","firstInitSegment","v","addSourceBuffer","ERROR","msg","updating","_doAppendSegments","safari","mediaDuration","_updateMediaSourceDuration","appendMediaSegment","mediaSegment","_needCleanupSourceBuffer","_doCleanupSourceBuffer","_hasPendingRemoveRanges","seek","seconds","abort","buffered","start","end","_doRemoveRanges","lastInitSegment","_hasPendingSegments","currentTime","doRemove","removeEnd","current","ranges","range","shift","remove","pendingSegments","timestampOffset","currentOffset","targetOffset","delta","abs","byteLength","appendBuffer","hasOwnProperty","info","unshift","BUFFER_FULL","pendings","SOURCE_OPEN","prr","UPDATE_END","MSEEvents","_loggingControl","_loggingControl2","_transmuxingController","_transmuxingController2","_transmuxingEvents","_transmuxingEvents2","_transmuxingWorker","_transmuxingWorker2","_mediaInfo","_mediaInfo2","Transmuxer","mediaDataSource","work","_worker","_workerDestroying","_onWorkerMessage","cmd","param","onLoggingConfigChanged","_onLoggingConfigChanged","registerListener","getConfig","_controller","ctl","IO_ERROR","_onIOError","DEMUX_ERROR","_onDemuxError","INIT_SEGMENT","_onInitSegment","MEDIA_SEGMENT","_onMediaSegment","LOADING_COMPLETE","_onLoadingComplete","RECOVERED_EARLY_EOF","_onRecoveredEarlyEof","MEDIA_INFO","_onMediaInfo","STATISTICS_INFO","_onStatisticsInfo","RECOMMEND_SEEKPOINT","_onRecommendSeekpoint","hasWorker","open","close","stop","pause","resume","_this","_this2","_this3","_this4","mediaInfo","_this5","statisticsInfo","_this6","_this7","_this8","_this9","terminate","setPrototypeOf","logcat","_flvDemuxer","_flvDemuxer2","_mp4Remuxer","_mp4Remuxer2","_demuxErrors","_demuxErrors2","_loader","TransmuxingController","filesize","url","cors","withCredentials","_mediaDataSource","_currentSegmentIndex","totalDuration","forEach","timestampBase","referrerPolicy","_demuxer","_remuxer","_ioctl","_pendingSeekTime","_pendingResolveSeekPoint","_statisticsReporter","_disableStatisticsReporter","_loadSegment","_enableStatisticsReporter","segmentIndex","optionalFrom","dataSource","onError","_onIOException","onSeeked","_onIOSeeked","onComplete","_onIOComplete","onRedirect","_onIORedirect","onRecoveredEarlyEof","_onIORecoveredEarlyEof","bindDataSource","onDataArrival","_onInitChunkArrival","_internalAbort","isWorking","isPaused","targetSegmentIndex","_searchSegmentIndexContains","segmentInfo","keyframe","targetSegmentInfo","insertDiscontinuity","_keyframe","resetMediaInfo","_reportSegmentMediaInfo","byteStart","probeData","consumed","parseChunks","probe","match","mds","overridedDuration","overridedHasAudio","overridedHasVideo","_onDemuxException","onMediaInfo","onInitSegment","_onRemuxerInitSegmentArrival","onMediaSegment","_onRemuxerMediaSegmentArrival","FORMAT_UNSUPPORTED","extraData","nextSegmentIndex","redirectedURL","seekpoint","setInterval","_reportStatisticsInfo","clearInterval","exportInfo","currentURL","hasRedirect","currentRedirectedURL","speed","currentSpeed","currentSegmentIndex","totalSegmentCount","TransmuxingEvents","_polyfill","_polyfill2","TransmuxingWorker","controller","logcatListener","onLogcatCallback","install","onIOError","onDemuxError","onLoadingComplete","onStatisticsInfo","onRecommendSeekpoint","applyConfig","enableCallback","addLogListener","removeLogListener","statInfo","str","_utf8Conv","_utf8Conv2","le","buf","ArrayBuffer","DataView","setInt16","Int16Array","AMF","parseScriptData","arrayBuffer","dataOffset","dataSize","parseValue","size","parseObject","parseString","isObjectEnd","objectEnd","parseVariable","getUint16","Uint8Array","parseLongString","getUint32","parseDate","timestamp","getFloat64","localTimeOffset","getInt16","Date","offset","getUint8","b","amfstr","terminal","amfobj","_terminal","amfvar","_marker","strictArrayLength","val","date","amfLongStr","w","DemuxErrors","OK","FORMAT_ERROR","CODEC_UNSUPPORTED","ExpGolomb","uint8array","_buffer","_buffer_index","_total_bytes","_total_bits","_current_word","_current_word_bits_left","_fillCurrentWord","buffer_bytes_left","bytes_read","min","word","set","subarray","buffer","readBits","bits","InvalidArgumentException","result","bits_need_left","bits_read_next","result2","readBool","readByte","_skipLeadingZero","zero_count","readUEG","leading_zeros","readSEG","_typeof","Symbol","iterator","_amfParser","_amfParser2","_spsParser","_spsParser2","Swap16","Swap32","ReadBig32","FLVDemuxer","_onError","_onTrackMetadata","_onDataAvailable","_dataOffset","_firstParse","_dispatch","_hasAudio","hasAudioTrack","_hasVideo","hasVideoTrack","_hasAudioFlagOverrided","_hasVideoFlagOverrided","_audioInitialMetadataDispatched","_videoInitialMetadataDispatched","_metadata","_audioMetadata","_videoMetadata","_naluLengthSize","_timestampBase","_timescale","_duration","_durationOverrided","_referenceFrameRate","fixed","fps_num","fps_den","_flvSoundRateTable","_mpegSamplingRates","_mpegAudioV10SampleRateTable","_mpegAudioV20SampleRateTable","_mpegAudioV25SampleRateTable","_mpegAudioL1BitRateTable","_mpegAudioL2BitRateTable","_mpegAudioL3BitRateTable","_videoTrack","sequenceNumber","samples","_audioTrack","_littleEndian","loader","_isInitialMetadataDispatched","chunk","prevTagSize0","_v","tagType","ts2","ts1","ts0","ts3","streamId","_parseAudioData","_parseVideoData","_parseScriptData","prevTagSize","scriptData","onMetaData","audiodatarate","videodatarate","framerate","keyframes","_parseKeyframesIndex","time","tagTimestamp","soundSpec","soundFormat","soundRate","soundRateIndex","soundSize","soundType","meta","track","timescale","channelCount","aacData","_parseAACAudioData","packetType","misc","samplingRate","originalCodec","refSampleDuration","mi","aacSample","unit","_misc","_parseMP3AudioData","_mi","bitRate","_dts","mp3Sample","_parseAACAudioSpecificConfig","audioObjectType","originalAudioObjectType","audioExtensionObjectType","samplingIndex","extensionSamplingIndex","samplingFrequence","channelConfig","userAgent","navigator","toLowerCase","indexOf","requestHeader","ver","layer","bitrate_index","sampling_freq_index","channel_mode","channel_count","sample_rate","bit_rate","object_type","tagPosition","spec","frameType","codecId","_parseAVCVideoPacket","cts","_parseAVCDecoderConfigurationRecord","_parseAVCVideoData","log","avcc","avcProfile","profileCompatibility","avcLevel","spsCount","sps","parseSPS","codecWidth","codec_size","codecHeight","presentWidth","present_size","presentHeight","profile_string","level_string","bitDepth","bit_depth","chroma_format","sarRatio","sar_ratio","frameRate","frame_rate","codecArray","codecString","j","h","chroma_format_string","ppsCount","_i","_len","units","lengthSize","naluSize","unitType","avcSample","isKeyframe","base","mismatch","_expGolomb","_expGolomb2","SPSParser","_ebsp2rbsp","src_length","dst","dst_idx","rbsp","gb","profile_idc","level_idc","getProfileString","getLevelString","chroma_format_idc","chroma_format_table","scaling_list_count","_skipScalingList","pic_order_cnt_type","num_ref_frames_in_pic_order_cnt_cycle","pic_width_in_mbs_minus1","pic_height_in_map_units_minus1","frame_mbs_only_flag","frame_crop_left_offset","frame_crop_right_offset","frame_crop_top_offset","frame_crop_bottom_offset","frame_cropping_flag","sar_width","sar_height","fps_fixed","vui_parameters_present_flag","aspect_ratio_idc","sar_w_table","sar_h_table","num_units_in_tick","time_scale","sarScale","crop_unit_x","crop_unit_y","sub_wc","sub_hc","codec_width","codec_height","present_width","ceil","getChromaFormatString","count","last_scale","next_scale","delta_scale","toFixed","chroma","_features","_features2","_flvPlayer","_flvPlayer2","_nativePlayer","_nativePlayer2","_playerEvents","_playerEvents2","_playerErrors","createPlayer","optionalConfig","isSupported","Events","ErrorTypes","ErrorDetails","FlvPlayer","NativePlayer","LoggingControl","_get","property","receiver","desc","getOwnPropertyDescriptor","getPrototypeOf","getter","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","__proto__","FetchStreamLoader","_BaseLoader","isWorkWellEdge","msedge","minor","browserNotBlacklisted","fetch","ReadableStream","seekHandler","_seekHandler","_needStash","_requestAbort","_contentLength","_receivedLength","_dataSource","_range","sourceURL","seekConfig","headers","Headers","configHeaders","params","method","mode","credentials","_status","LoaderStatus","kConnecting","res","kIdle","ok","status","_onURLRedirect","removeURLParameters","lengthHeader","parseInt","_onContentLengthKnown","_pump","body","getReader","kError","LoaderErrors","HTTP_STATUS_CODE_INVALID","statusText","RuntimeException","catch","EXCEPTION","reader","read","done","kComplete","_onComplete","from","cancel","kBuffering","_onDataArrival","EARLY_EOF","BaseLoader","_speedSampler","_speedSampler2","_fetchStreamLoader","_fetchStreamLoader2","_xhrMozChunkedLoader","_xhrMozChunkedLoader2","_xhrMsstreamLoader","_xhrMsstreamLoader2","_xhrRangeLoader","_xhrRangeLoader2","_websocketLoader","_websocketLoader2","_rangeSeekHandler","_rangeSeekHandler2","_paramSeekHandler","_paramSeekHandler2","IOController","_extraData","_stashInitialSize","_stashUsed","_stashSize","_bufferSize","_stashBuffer","_stashByteStart","_enableStash","_loaderClass","_isWebSocketURL","test","_refTotalLength","_totalLength","_fullRequestFlag","_currentRange","_redirectedURL","_speedNormalized","_speedNormalizeList","_isEarlyEofReconnecting","_paused","_resumeFrom","_onSeeked","_onRedirect","_selectSeekHandler","_selectLoader","_createLoader","paramStart","paramEnd","needStashBuffer","onContentLengthKnown","onURLRedirect","_onLoaderChunkArrival","_onLoaderComplete","_onLoaderError","to","reset","bytes","_internalSeek","dropUnconsumed","_flushStashBuffer","requestRange","updateUrl","_expandBuffer","expectedBytes","bufferNewSize","newBuffer","stashOldArray","stashNewArray","_normalizeSpeed","_adjustStashSize","normalized","stashSizeKB","bufferSize","_dispatchChunks","chunks","contentLength","receivedLength","addBytes","KBps","lastSecondKBps","remain","stashArray","_stashArray","_consumed","remainArray","_stashArray2","_stashArray3","_consumed2","_remainArray","_consumed3","_remain","UNRECOVERABLE_EARLY_EOF","nextFrom","CONNECTING_TIMEOUT","typeName","NotImplementedException","ParamSeekHandler","_startName","_endName","baseUrl","needAnd","seekedURL","baseURL","split","queryIndex","resultParams","pairs","pair","requireAnd","RangeSeekHandler","zeroStart","_zeroStart","SpeedSampler","_firstCheckpoint","_lastCheckpoint","_intervalBytes","_totalBytes","_lastSecondBytes","performance","now","_now","durationSeconds","currentKBps","WebSocketLoader","WebSocket","_ws","ws","binaryType","onopen","_onWebSocketOpen","onclose","_onWebSocketClose","_onWebSocketMessage","onerror","_onWebSocketError","_dispatchArrayBuffer","FileReader","onload","readAsArrayBuffer","arraybuffer","MozChunkedLoader","xhr","XMLHttpRequest","responseType","_xhr","onreadystatechange","onprogress","onloadend","_requestURL","_onReadyStateChange","_onProgress","_onLoadEnd","_onXhrError","setRequestHeader","send","responseURL","total","response","loaded","MSStreamLoader","MSStream","MSStreamReader","_reader","_totalRange","_currentRequestURL","_currentRedirectedURL","_bufferLimit","_lastTimeBufferSize","_isReconnecting","_internalOpen","isSubrange","_msrOnProgress","_msrOnLoad","_msrOnError","_xhrOnReadyStateChange","_xhrOnError","getResponseHeader","msstream","bigbuffer","_doReconnectIfNeeded","RangeLoader","_chunkSizeKBList","_currentChunkSizeKB","_currentSpeedNormalized","_zeroSpeedChunkCount","_waitForTotalLength","_totalLengthReceived","_currentRequestRange","_lastTimeLoaded","_openSubRange","chunkSize","_onLoad","openNextRange","reportComplete","_transmuxer","_transmuxer2","_mseController","_mseController2","onvLoadedMetadata","_onvLoadedMetadata","onvSeeking","_onvSeeking","onvCanPlay","_onvCanPlay","onvStalled","_onvStalled","onvProgress","_onvProgress","_requestSetTime","_seekpointRecord","_progressChecker","_msectl","_mseSourceOpened","_hasPendingLoad","_receivedCanPlay","_statisticsInfo","chromeNeedIDRFix","chrome","major","build","_alwaysSeekKeyframe","msie","unload","_onmseUpdateEnd","_onmseBufferFull","load","MEDIA_ERROR","MEDIA_MSE_ERROR","_suspendTransmuxer","NETWORK_ERROR","_fillStatisticsInfo","play","playerType","HTMLVideoElement","hasQualityInfo","decoded","dropped","getVideoPlaybackQuality","quality","totalVideoFrames","droppedVideoFrames","webkitDecodedFrameCount","webkitDroppedFrameCount","decodedFrames","droppedFrames","currentRangeStart","currentRangeEnd","_checkProgressAndResume","needResume","_isTimepointBuffered","directSeek","directSeekBegin","directSeekBeginTime","videoBeginTime","idr","_checkAndApplyUnbufferedSeekpoint","recordTime","_checkAndResumeStuckPlayback","stalled","media","seekPoint","volume","muted","preload","mediaPrefix","HTMLAudioElement","videoWidth","videoHeight","OTHER_ERROR","NETWORK_EXCEPTION","NETWORK_STATUS_CODE_INVALID","NETWORK_TIMEOUT","NETWORK_UNRECOVERABLE_EARLY_EOF","MEDIA_FORMAT_ERROR","MEDIA_FORMAT_UNSUPPORTED","MEDIA_CODEC_UNSUPPORTED","PlayerEvents","AAC","getSilentFrame","MP4","init","types","avc1","avcC","btrt","dinf","dref","esds","ftyp","hdlr","mdat","mdhd","mdia","mfhd","minf","moof","moov","mp4a","mvex","mvhd","sdtp","stbl","stco","stsc","stsd","stsz","stts","tfdt","tfhd","traf","trak","trun","trex","tkhd","vmhd","smhd","charCodeAt","constants","FTYP","STSD_PREFIX","STTS","STSC","STCO","STSZ","HDLR_VIDEO","HDLR_AUDIO","DREF","SMHD","VMHD","box","datas","arrayCount","generateInitSegment","trackId","xmhd","mp3","sampleRate","configSize","baseMediaDecodeTime","sampleCount","flags","isLeading","dependsOn","isDependedOn","hasRedundancy","isNonSync","_mp4Generator","_mp4Generator2","_aacSilent","_aacSilent2","MP4Remuxer","_isLive","_dtsBase","_dtsBaseInited","_audioDtsBase","Infinity","_videoDtsBase","_audioNextDts","_videoNextDts","_audioMeta","_videoMeta","_audioSegmentInfoList","_videoSegmentInfoList","_forceFirstIDR","_fillSilentAfterSeek","_mp3UseMpegAudio","firefox","_fillAudioTimestampGap","producer","onDataAvailable","remux","onTrackMetadata","_onTrackMetadataReceived","audioTrack","videoTrack","_calculateDtsBase","_remuxVideo","_remuxAudio","metabox","dtsCorrection","firstDts","lastDts","lastPts","mpegRawTrack","firstSegmentAfterSeek","insertPrefixSilentFrame","mdatbox","mdatBytes","firstSampleOriginalDts","distance","expectedDts","firstSampleDts","videoSegment","silentUnit","silentFrameDuration","mp4Samples","sample","sampleDuration","nextDts","needFillSilentFrames","silentFrames","frameCount","currentDts","round","_silentUnit","intDts","previousFrame","frame","lastFrame","_unit","latest","moofbox","_mergeBoxes","firstPts","syncPoint","_i2","Browser","detect","ua","exec","platform_match","matched","majorVersion","platform","versionArray","string","opr","webkit","rv","iemobile","edge","opera","android","_message","_RuntimeException","_RuntimeException2","_RuntimeException3","Log","tag","FORCE_GLOBAL_TAG","GLOBAL_TAG","ENABLE_CALLBACK","ENABLE_ERROR","warn","ENABLE_INFO","ENABLE_WARN","d","ENABLE_DEBUG","debug","ENABLE_VERBOSE","globalTag","forceGlobalTag","enableVerbose","enableDebug","enableInfo","enableWarn","enableError","_notifyChange","enable","Polyfill","proto","output","source","checkContinuation","checkLength","decodeUTF8","out","String","fromCharCode","ucs4","_ucs","_ucs2"],"mappings":"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","file":"flv.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.flvjs = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\r\n(function (process,global){\r\n/*!\r\n * @overview es6-promise - a tiny implementation of Promises/A+.\r\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\r\n * @license   Licensed under MIT license\r\n *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE\r\n * @version   4.1.0\r\n */\r\n\r\n(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    (global.ES6Promise = factory());\r\n}(this, (function () { 'use strict';\r\n\r\nfunction objectOrFunction(x) {\r\n  return typeof x === 'function' || typeof x === 'object' && x !== null;\r\n}\r\n\r\nfunction isFunction(x) {\r\n  return typeof x === 'function';\r\n}\r\n\r\nvar _isArray = undefined;\r\nif (!Array.isArray) {\r\n  _isArray = function (x) {\r\n    return Object.prototype.toString.call(x) === '[object Array]';\r\n  };\r\n} else {\r\n  _isArray = Array.isArray;\r\n}\r\n\r\nvar isArray = _isArray;\r\n\r\nvar len = 0;\r\nvar vertxNext = undefined;\r\nvar customSchedulerFn = undefined;\r\n\r\nvar asap = function asap(callback, arg) {\r\n  queue[len] = callback;\r\n  queue[len + 1] = arg;\r\n  len += 2;\r\n  if (len === 2) {\r\n    // If len is 2, that means that we need to schedule an async flush.\r\n    // If additional callbacks are queued before the queue is flushed, they\r\n    // will be processed by this flush that we are scheduling.\r\n    if (customSchedulerFn) {\r\n      customSchedulerFn(flush);\r\n    } else {\r\n      scheduleFlush();\r\n    }\r\n  }\r\n};\r\n\r\nfunction setScheduler(scheduleFn) {\r\n  customSchedulerFn = scheduleFn;\r\n}\r\n\r\nfunction setAsap(asapFn) {\r\n  asap = asapFn;\r\n}\r\n\r\nvar browserWindow = typeof window !== 'undefined' ? window : undefined;\r\nvar browserGlobal = browserWindow || {};\r\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\r\nvar isNode = typeof self === 'undefined' && typeof process !== 'undefined' && ({}).toString.call(process) === '[object process]';\r\n\r\n// test for web worker but not in IE10\r\nvar isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';\r\n\r\n// node\r\nfunction useNextTick() {\r\n  // node version 0.10.x displays a deprecation warning when nextTick is used recursively\r\n  // see https://github.com/cujojs/when/issues/410 for details\r\n  return function () {\r\n    return process.nextTick(flush);\r\n  };\r\n}\r\n\r\n// vertx\r\nfunction useVertxTimer() {\r\n  if (typeof vertxNext !== 'undefined') {\r\n    return function () {\r\n      vertxNext(flush);\r\n    };\r\n  }\r\n\r\n  return useSetTimeout();\r\n}\r\n\r\nfunction useMutationObserver() {\r\n  var iterations = 0;\r\n  var observer = new BrowserMutationObserver(flush);\r\n  var node = document.createTextNode('');\r\n  observer.observe(node, { characterData: true });\r\n\r\n  return function () {\r\n    node.data = iterations = ++iterations % 2;\r\n  };\r\n}\r\n\r\n// web worker\r\nfunction useMessageChannel() {\r\n  var channel = new MessageChannel();\r\n  channel.port1.onmessage = flush;\r\n  return function () {\r\n    return channel.port2.postMessage(0);\r\n  };\r\n}\r\n\r\nfunction useSetTimeout() {\r\n  // Store setTimeout reference so es6-promise will be unaffected by\r\n  // other code modifying setTimeout (like sinon.useFakeTimers())\r\n  var globalSetTimeout = setTimeout;\r\n  return function () {\r\n    return globalSetTimeout(flush, 1);\r\n  };\r\n}\r\n\r\nvar queue = new Array(1000);\r\nfunction flush() {\r\n  for (var i = 0; i < len; i += 2) {\r\n    var callback = queue[i];\r\n    var arg = queue[i + 1];\r\n\r\n    callback(arg);\r\n\r\n    queue[i] = undefined;\r\n    queue[i + 1] = undefined;\r\n  }\r\n\r\n  len = 0;\r\n}\r\n\r\nfunction attemptVertx() {\r\n  try {\r\n    var r = _dereq_;\r\n    var vertx = r('vertx');\r\n    vertxNext = vertx.runOnLoop || vertx.runOnContext;\r\n    return useVertxTimer();\r\n  } catch (e) {\r\n    return useSetTimeout();\r\n  }\r\n}\r\n\r\nvar scheduleFlush = undefined;\r\n// Decide what async method to use to triggering processing of queued callbacks:\r\nif (isNode) {\r\n  scheduleFlush = useNextTick();\r\n} else if (BrowserMutationObserver) {\r\n  scheduleFlush = useMutationObserver();\r\n} else if (isWorker) {\r\n  scheduleFlush = useMessageChannel();\r\n} else if (browserWindow === undefined && typeof _dereq_ === 'function') {\r\n  scheduleFlush = attemptVertx();\r\n} else {\r\n  scheduleFlush = useSetTimeout();\r\n}\r\n\r\nfunction then(onFulfillment, onRejection) {\r\n  var _arguments = arguments;\r\n\r\n  var parent = this;\r\n\r\n  var child = new this.constructor(noop);\r\n\r\n  if (child[PROMISE_ID] === undefined) {\r\n    makePromise(child);\r\n  }\r\n\r\n  var _state = parent._state;\r\n\r\n  if (_state) {\r\n    (function () {\r\n      var callback = _arguments[_state - 1];\r\n      asap(function () {\r\n        return invokeCallback(_state, child, callback, parent._result);\r\n      });\r\n    })();\r\n  } else {\r\n    subscribe(parent, child, onFulfillment, onRejection);\r\n  }\r\n\r\n  return child;\r\n}\r\n\r\n/**\r\n  `Promise.resolve` returns a promise that will become resolved with the\r\n  passed `value`. It is shorthand for the following:\r\n\r\n  ```javascript\r\n  let promise = new Promise(function(resolve, reject){\r\n    resolve(1);\r\n  });\r\n\r\n  promise.then(function(value){\r\n    // value === 1\r\n  });\r\n  ```\r\n\r\n  Instead of writing the above, your code now simply becomes the following:\r\n\r\n  ```javascript\r\n  let promise = Promise.resolve(1);\r\n\r\n  promise.then(function(value){\r\n    // value === 1\r\n  });\r\n  ```\r\n\r\n  @method resolve\r\n  @static\r\n  @param {Any} value value that the returned promise will be resolved with\r\n  Useful for tooling.\r\n  @return {Promise} a promise that will become fulfilled with the given\r\n  `value`\r\n*/\r\nfunction resolve(object) {\r\n  /*jshint validthis:true */\r\n  var Constructor = this;\r\n\r\n  if (object && typeof object === 'object' && object.constructor === Constructor) {\r\n    return object;\r\n  }\r\n\r\n  var promise = new Constructor(noop);\r\n  _resolve(promise, object);\r\n  return promise;\r\n}\r\n\r\nvar PROMISE_ID = Math.random().toString(36).substring(16);\r\n\r\nfunction noop() {}\r\n\r\nvar PENDING = void 0;\r\nvar FULFILLED = 1;\r\nvar REJECTED = 2;\r\n\r\nvar GET_THEN_ERROR = new ErrorObject();\r\n\r\nfunction selfFulfillment() {\r\n  return new TypeError(\"You cannot resolve a promise with itself\");\r\n}\r\n\r\nfunction cannotReturnOwn() {\r\n  return new TypeError('A promises callback cannot return that same promise.');\r\n}\r\n\r\nfunction getThen(promise) {\r\n  try {\r\n    return promise.then;\r\n  } catch (error) {\r\n    GET_THEN_ERROR.error = error;\r\n    return GET_THEN_ERROR;\r\n  }\r\n}\r\n\r\nfunction tryThen(then, value, fulfillmentHandler, rejectionHandler) {\r\n  try {\r\n    then.call(value, fulfillmentHandler, rejectionHandler);\r\n  } catch (e) {\r\n    return e;\r\n  }\r\n}\r\n\r\nfunction handleForeignThenable(promise, thenable, then) {\r\n  asap(function (promise) {\r\n    var sealed = false;\r\n    var error = tryThen(then, thenable, function (value) {\r\n      if (sealed) {\r\n        return;\r\n      }\r\n      sealed = true;\r\n      if (thenable !== value) {\r\n        _resolve(promise, value);\r\n      } else {\r\n        fulfill(promise, value);\r\n      }\r\n    }, function (reason) {\r\n      if (sealed) {\r\n        return;\r\n      }\r\n      sealed = true;\r\n\r\n      _reject(promise, reason);\r\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\r\n\r\n    if (!sealed && error) {\r\n      sealed = true;\r\n      _reject(promise, error);\r\n    }\r\n  }, promise);\r\n}\r\n\r\nfunction handleOwnThenable(promise, thenable) {\r\n  if (thenable._state === FULFILLED) {\r\n    fulfill(promise, thenable._result);\r\n  } else if (thenable._state === REJECTED) {\r\n    _reject(promise, thenable._result);\r\n  } else {\r\n    subscribe(thenable, undefined, function (value) {\r\n      return _resolve(promise, value);\r\n    }, function (reason) {\r\n      return _reject(promise, reason);\r\n    });\r\n  }\r\n}\r\n\r\nfunction handleMaybeThenable(promise, maybeThenable, then$$) {\r\n  if (maybeThenable.constructor === promise.constructor && then$$ === then && maybeThenable.constructor.resolve === resolve) {\r\n    handleOwnThenable(promise, maybeThenable);\r\n  } else {\r\n    if (then$$ === GET_THEN_ERROR) {\r\n      _reject(promise, GET_THEN_ERROR.error);\r\n      GET_THEN_ERROR.error = null;\r\n    } else if (then$$ === undefined) {\r\n      fulfill(promise, maybeThenable);\r\n    } else if (isFunction(then$$)) {\r\n      handleForeignThenable(promise, maybeThenable, then$$);\r\n    } else {\r\n      fulfill(promise, maybeThenable);\r\n    }\r\n  }\r\n}\r\n\r\nfunction _resolve(promise, value) {\r\n  if (promise === value) {\r\n    _reject(promise, selfFulfillment());\r\n  } else if (objectOrFunction(value)) {\r\n    handleMaybeThenable(promise, value, getThen(value));\r\n  } else {\r\n    fulfill(promise, value);\r\n  }\r\n}\r\n\r\nfunction publishRejection(promise) {\r\n  if (promise._onerror) {\r\n    promise._onerror(promise._result);\r\n  }\r\n\r\n  publish(promise);\r\n}\r\n\r\nfunction fulfill(promise, value) {\r\n  if (promise._state !== PENDING) {\r\n    return;\r\n  }\r\n\r\n  promise._result = value;\r\n  promise._state = FULFILLED;\r\n\r\n  if (promise._subscribers.length !== 0) {\r\n    asap(publish, promise);\r\n  }\r\n}\r\n\r\nfunction _reject(promise, reason) {\r\n  if (promise._state !== PENDING) {\r\n    return;\r\n  }\r\n  promise._state = REJECTED;\r\n  promise._result = reason;\r\n\r\n  asap(publishRejection, promise);\r\n}\r\n\r\nfunction subscribe(parent, child, onFulfillment, onRejection) {\r\n  var _subscribers = parent._subscribers;\r\n  var length = _subscribers.length;\r\n\r\n  parent._onerror = null;\r\n\r\n  _subscribers[length] = child;\r\n  _subscribers[length + FULFILLED] = onFulfillment;\r\n  _subscribers[length + REJECTED] = onRejection;\r\n\r\n  if (length === 0 && parent._state) {\r\n    asap(publish, parent);\r\n  }\r\n}\r\n\r\nfunction publish(promise) {\r\n  var subscribers = promise._subscribers;\r\n  var settled = promise._state;\r\n\r\n  if (subscribers.length === 0) {\r\n    return;\r\n  }\r\n\r\n  var child = undefined,\r\n      callback = undefined,\r\n      detail = promise._result;\r\n\r\n  for (var i = 0; i < subscribers.length; i += 3) {\r\n    child = subscribers[i];\r\n    callback = subscribers[i + settled];\r\n\r\n    if (child) {\r\n      invokeCallback(settled, child, callback, detail);\r\n    } else {\r\n      callback(detail);\r\n    }\r\n  }\r\n\r\n  promise._subscribers.length = 0;\r\n}\r\n\r\nfunction ErrorObject() {\r\n  this.error = null;\r\n}\r\n\r\nvar TRY_CATCH_ERROR = new ErrorObject();\r\n\r\nfunction tryCatch(callback, detail) {\r\n  try {\r\n    return callback(detail);\r\n  } catch (e) {\r\n    TRY_CATCH_ERROR.error = e;\r\n    return TRY_CATCH_ERROR;\r\n  }\r\n}\r\n\r\nfunction invokeCallback(settled, promise, callback, detail) {\r\n  var hasCallback = isFunction(callback),\r\n      value = undefined,\r\n      error = undefined,\r\n      succeeded = undefined,\r\n      failed = undefined;\r\n\r\n  if (hasCallback) {\r\n    value = tryCatch(callback, detail);\r\n\r\n    if (value === TRY_CATCH_ERROR) {\r\n      failed = true;\r\n      error = value.error;\r\n      value.error = null;\r\n    } else {\r\n      succeeded = true;\r\n    }\r\n\r\n    if (promise === value) {\r\n      _reject(promise, cannotReturnOwn());\r\n      return;\r\n    }\r\n  } else {\r\n    value = detail;\r\n    succeeded = true;\r\n  }\r\n\r\n  if (promise._state !== PENDING) {\r\n    // noop\r\n  } else if (hasCallback && succeeded) {\r\n      _resolve(promise, value);\r\n    } else if (failed) {\r\n      _reject(promise, error);\r\n    } else if (settled === FULFILLED) {\r\n      fulfill(promise, value);\r\n    } else if (settled === REJECTED) {\r\n      _reject(promise, value);\r\n    }\r\n}\r\n\r\nfunction initializePromise(promise, resolver) {\r\n  try {\r\n    resolver(function resolvePromise(value) {\r\n      _resolve(promise, value);\r\n    }, function rejectPromise(reason) {\r\n      _reject(promise, reason);\r\n    });\r\n  } catch (e) {\r\n    _reject(promise, e);\r\n  }\r\n}\r\n\r\nvar id = 0;\r\nfunction nextId() {\r\n  return id++;\r\n}\r\n\r\nfunction makePromise(promise) {\r\n  promise[PROMISE_ID] = id++;\r\n  promise._state = undefined;\r\n  promise._result = undefined;\r\n  promise._subscribers = [];\r\n}\r\n\r\nfunction Enumerator(Constructor, input) {\r\n  this._instanceConstructor = Constructor;\r\n  this.promise = new Constructor(noop);\r\n\r\n  if (!this.promise[PROMISE_ID]) {\r\n    makePromise(this.promise);\r\n  }\r\n\r\n  if (isArray(input)) {\r\n    this._input = input;\r\n    this.length = input.length;\r\n    this._remaining = input.length;\r\n\r\n    this._result = new Array(this.length);\r\n\r\n    if (this.length === 0) {\r\n      fulfill(this.promise, this._result);\r\n    } else {\r\n      this.length = this.length || 0;\r\n      this._enumerate();\r\n      if (this._remaining === 0) {\r\n        fulfill(this.promise, this._result);\r\n      }\r\n    }\r\n  } else {\r\n    _reject(this.promise, validationError());\r\n  }\r\n}\r\n\r\nfunction validationError() {\r\n  return new Error('Array Methods must be provided an Array');\r\n};\r\n\r\nEnumerator.prototype._enumerate = function () {\r\n  var length = this.length;\r\n  var _input = this._input;\r\n\r\n  for (var i = 0; this._state === PENDING && i < length; i++) {\r\n    this._eachEntry(_input[i], i);\r\n  }\r\n};\r\n\r\nEnumerator.prototype._eachEntry = function (entry, i) {\r\n  var c = this._instanceConstructor;\r\n  var resolve$$ = c.resolve;\r\n\r\n  if (resolve$$ === resolve) {\r\n    var _then = getThen(entry);\r\n\r\n    if (_then === then && entry._state !== PENDING) {\r\n      this._settledAt(entry._state, i, entry._result);\r\n    } else if (typeof _then !== 'function') {\r\n      this._remaining--;\r\n      this._result[i] = entry;\r\n    } else if (c === Promise) {\r\n      var promise = new c(noop);\r\n      handleMaybeThenable(promise, entry, _then);\r\n      this._willSettleAt(promise, i);\r\n    } else {\r\n      this._willSettleAt(new c(function (resolve$$) {\r\n        return resolve$$(entry);\r\n      }), i);\r\n    }\r\n  } else {\r\n    this._willSettleAt(resolve$$(entry), i);\r\n  }\r\n};\r\n\r\nEnumerator.prototype._settledAt = function (state, i, value) {\r\n  var promise = this.promise;\r\n\r\n  if (promise._state === PENDING) {\r\n    this._remaining--;\r\n\r\n    if (state === REJECTED) {\r\n      _reject(promise, value);\r\n    } else {\r\n      this._result[i] = value;\r\n    }\r\n  }\r\n\r\n  if (this._remaining === 0) {\r\n    fulfill(promise, this._result);\r\n  }\r\n};\r\n\r\nEnumerator.prototype._willSettleAt = function (promise, i) {\r\n  var enumerator = this;\r\n\r\n  subscribe(promise, undefined, function (value) {\r\n    return enumerator._settledAt(FULFILLED, i, value);\r\n  }, function (reason) {\r\n    return enumerator._settledAt(REJECTED, i, reason);\r\n  });\r\n};\r\n\r\n/**\r\n  `Promise.all` accepts an array of promises, and returns a new promise which\r\n  is fulfilled with an array of fulfillment values for the passed promises, or\r\n  rejected with the reason of the first passed promise to be rejected. It casts all\r\n  elements of the passed iterable to promises as it runs this algorithm.\r\n\r\n  Example:\r\n\r\n  ```javascript\r\n  let promise1 = resolve(1);\r\n  let promise2 = resolve(2);\r\n  let promise3 = resolve(3);\r\n  let promises = [ promise1, promise2, promise3 ];\r\n\r\n  Promise.all(promises).then(function(array){\r\n    // The array here would be [ 1, 2, 3 ];\r\n  });\r\n  ```\r\n\r\n  If any of the `promises` given to `all` are rejected, the first promise\r\n  that is rejected will be given as an argument to the returned promises's\r\n  rejection handler. For example:\r\n\r\n  Example:\r\n\r\n  ```javascript\r\n  let promise1 = resolve(1);\r\n  let promise2 = reject(new Error(\"2\"));\r\n  let promise3 = reject(new Error(\"3\"));\r\n  let promises = [ promise1, promise2, promise3 ];\r\n\r\n  Promise.all(promises).then(function(array){\r\n    // Code here never runs because there are rejected promises!\r\n  }, function(error) {\r\n    // error.message === \"2\"\r\n  });\r\n  ```\r\n\r\n  @method all\r\n  @static\r\n  @param {Array} entries array of promises\r\n  @param {String} label optional string for labeling the promise.\r\n  Useful for tooling.\r\n  @return {Promise} promise that is fulfilled when all `promises` have been\r\n  fulfilled, or rejected if any of them become rejected.\r\n  @static\r\n*/\r\nfunction all(entries) {\r\n  return new Enumerator(this, entries).promise;\r\n}\r\n\r\n/**\r\n  `Promise.race` returns a new promise which is settled in the same way as the\r\n  first passed promise to settle.\r\n\r\n  Example:\r\n\r\n  ```javascript\r\n  let promise1 = new Promise(function(resolve, reject){\r\n    setTimeout(function(){\r\n      resolve('promise 1');\r\n    }, 200);\r\n  });\r\n\r\n  let promise2 = new Promise(function(resolve, reject){\r\n    setTimeout(function(){\r\n      resolve('promise 2');\r\n    }, 100);\r\n  });\r\n\r\n  Promise.race([promise1, promise2]).then(function(result){\r\n    // result === 'promise 2' because it was resolved before promise1\r\n    // was resolved.\r\n  });\r\n  ```\r\n\r\n  `Promise.race` is deterministic in that only the state of the first\r\n  settled promise matters. For example, even if other promises given to the\r\n  `promises` array argument are resolved, but the first settled promise has\r\n  become rejected before the other promises became fulfilled, the returned\r\n  promise will become rejected:\r\n\r\n  ```javascript\r\n  let promise1 = new Promise(function(resolve, reject){\r\n    setTimeout(function(){\r\n      resolve('promise 1');\r\n    }, 200);\r\n  });\r\n\r\n  let promise2 = new Promise(function(resolve, reject){\r\n    setTimeout(function(){\r\n      reject(new Error('promise 2'));\r\n    }, 100);\r\n  });\r\n\r\n  Promise.race([promise1, promise2]).then(function(result){\r\n    // Code here never runs\r\n  }, function(reason){\r\n    // reason.message === 'promise 2' because promise 2 became rejected before\r\n    // promise 1 became fulfilled\r\n  });\r\n  ```\r\n\r\n  An example real-world use case is implementing timeouts:\r\n\r\n  ```javascript\r\n  Promise.race([ajax('foo.json'), timeout(5000)])\r\n  ```\r\n\r\n  @method race\r\n  @static\r\n  @param {Array} promises array of promises to observe\r\n  Useful for tooling.\r\n  @return {Promise} a promise which settles in the same way as the first passed\r\n  promise to settle.\r\n*/\r\nfunction race(entries) {\r\n  /*jshint validthis:true */\r\n  var Constructor = this;\r\n\r\n  if (!isArray(entries)) {\r\n    return new Constructor(function (_, reject) {\r\n      return reject(new TypeError('You must pass an array to race.'));\r\n    });\r\n  } else {\r\n    return new Constructor(function (resolve, reject) {\r\n      var length = entries.length;\r\n      for (var i = 0; i < length; i++) {\r\n        Constructor.resolve(entries[i]).then(resolve, reject);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n  `Promise.reject` returns a promise rejected with the passed `reason`.\r\n  It is shorthand for the following:\r\n\r\n  ```javascript\r\n  let promise = new Promise(function(resolve, reject){\r\n    reject(new Error('WHOOPS'));\r\n  });\r\n\r\n  promise.then(function(value){\r\n    // Code here doesn't run because the promise is rejected!\r\n  }, function(reason){\r\n    // reason.message === 'WHOOPS'\r\n  });\r\n  ```\r\n\r\n  Instead of writing the above, your code now simply becomes the following:\r\n\r\n  ```javascript\r\n  let promise = Promise.reject(new Error('WHOOPS'));\r\n\r\n  promise.then(function(value){\r\n    // Code here doesn't run because the promise is rejected!\r\n  }, function(reason){\r\n    // reason.message === 'WHOOPS'\r\n  });\r\n  ```\r\n\r\n  @method reject\r\n  @static\r\n  @param {Any} reason value that the returned promise will be rejected with.\r\n  Useful for tooling.\r\n  @return {Promise} a promise rejected with the given `reason`.\r\n*/\r\nfunction reject(reason) {\r\n  /*jshint validthis:true */\r\n  var Constructor = this;\r\n  var promise = new Constructor(noop);\r\n  _reject(promise, reason);\r\n  return promise;\r\n}\r\n\r\nfunction needsResolver() {\r\n  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\r\n}\r\n\r\nfunction needsNew() {\r\n  throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\r\n}\r\n\r\n/**\r\n  Promise objects represent the eventual result of an asynchronous operation. The\r\n  primary way of interacting with a promise is through its `then` method, which\r\n  registers callbacks to receive either a promise's eventual value or the reason\r\n  why the promise cannot be fulfilled.\r\n\r\n  Terminology\r\n  -----------\r\n\r\n  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\r\n  - `thenable` is an object or function that defines a `then` method.\r\n  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\r\n  - `exception` is a value that is thrown using the throw statement.\r\n  - `reason` is a value that indicates why a promise was rejected.\r\n  - `settled` the final resting state of a promise, fulfilled or rejected.\r\n\r\n  A promise can be in one of three states: pending, fulfilled, or rejected.\r\n\r\n  Promises that are fulfilled have a fulfillment value and are in the fulfilled\r\n  state.  Promises that are rejected have a rejection reason and are in the\r\n  rejected state.  A fulfillment value is never a thenable.\r\n\r\n  Promises can also be said to *resolve* a value.  If this value is also a\r\n  promise, then the original promise's settled state will match the value's\r\n  settled state.  So a promise that *resolves* a promise that rejects will\r\n  itself reject, and a promise that *resolves* a promise that fulfills will\r\n  itself fulfill.\r\n\r\n\r\n  Basic Usage:\r\n  ------------\r\n\r\n  ```js\r\n  let promise = new Promise(function(resolve, reject) {\r\n    // on success\r\n    resolve(value);\r\n\r\n    // on failure\r\n    reject(reason);\r\n  });\r\n\r\n  promise.then(function(value) {\r\n    // on fulfillment\r\n  }, function(reason) {\r\n    // on rejection\r\n  });\r\n  ```\r\n\r\n  Advanced Usage:\r\n  ---------------\r\n\r\n  Promises shine when abstracting away asynchronous interactions such as\r\n  `XMLHttpRequest`s.\r\n\r\n  ```js\r\n  function getJSON(url) {\r\n    return new Promise(function(resolve, reject){\r\n      let xhr = new XMLHttpRequest();\r\n\r\n      xhr.open('GET', url);\r\n      xhr.onreadystatechange = handler;\r\n      xhr.responseType = 'json';\r\n      xhr.setRequestHeader('Accept', 'application/json');\r\n      xhr.send();\r\n\r\n      function handler() {\r\n        if (this.readyState === this.DONE) {\r\n          if (this.status === 200) {\r\n            resolve(this.response);\r\n          } else {\r\n            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\r\n          }\r\n        }\r\n      };\r\n    });\r\n  }\r\n\r\n  getJSON('/posts.json').then(function(json) {\r\n    // on fulfillment\r\n  }, function(reason) {\r\n    // on rejection\r\n  });\r\n  ```\r\n\r\n  Unlike callbacks, promises are great composable primitives.\r\n\r\n  ```js\r\n  Promise.all([\r\n    getJSON('/posts'),\r\n    getJSON('/comments')\r\n  ]).then(function(values){\r\n    values[0] // => postsJSON\r\n    values[1] // => commentsJSON\r\n\r\n    return values;\r\n  });\r\n  ```\r\n\r\n  @class Promise\r\n  @param {function} resolver\r\n  Useful for tooling.\r\n  @constructor\r\n*/\r\nfunction Promise(resolver) {\r\n  this[PROMISE_ID] = nextId();\r\n  this._result = this._state = undefined;\r\n  this._subscribers = [];\r\n\r\n  if (noop !== resolver) {\r\n    typeof resolver !== 'function' && needsResolver();\r\n    this instanceof Promise ? initializePromise(this, resolver) : needsNew();\r\n  }\r\n}\r\n\r\nPromise.all = all;\r\nPromise.race = race;\r\nPromise.resolve = resolve;\r\nPromise.reject = reject;\r\nPromise._setScheduler = setScheduler;\r\nPromise._setAsap = setAsap;\r\nPromise._asap = asap;\r\n\r\nPromise.prototype = {\r\n  constructor: Promise,\r\n\r\n  /**\r\n    The primary way of interacting with a promise is through its `then` method,\r\n    which registers callbacks to receive either a promise's eventual value or the\r\n    reason why the promise cannot be fulfilled.\r\n  \r\n    ```js\r\n    findUser().then(function(user){\r\n      // user is available\r\n    }, function(reason){\r\n      // user is unavailable, and you are given the reason why\r\n    });\r\n    ```\r\n  \r\n    Chaining\r\n    --------\r\n  \r\n    The return value of `then` is itself a promise.  This second, 'downstream'\r\n    promise is resolved with the return value of the first promise's fulfillment\r\n    or rejection handler, or rejected if the handler throws an exception.\r\n  \r\n    ```js\r\n    findUser().then(function (user) {\r\n      return user.name;\r\n    }, function (reason) {\r\n      return 'default name';\r\n    }).then(function (userName) {\r\n      // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\r\n      // will be `'default name'`\r\n    });\r\n  \r\n    findUser().then(function (user) {\r\n      throw new Error('Found user, but still unhappy');\r\n    }, function (reason) {\r\n      throw new Error('`findUser` rejected and we're unhappy');\r\n    }).then(function (value) {\r\n      // never reached\r\n    }, function (reason) {\r\n      // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\r\n      // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\r\n    });\r\n    ```\r\n    If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\r\n  \r\n    ```js\r\n    findUser().then(function (user) {\r\n      throw new PedagogicalException('Upstream error');\r\n    }).then(function (value) {\r\n      // never reached\r\n    }).then(function (value) {\r\n      // never reached\r\n    }, function (reason) {\r\n      // The `PedgagocialException` is propagated all the way down to here\r\n    });\r\n    ```\r\n  \r\n    Assimilation\r\n    ------------\r\n  \r\n    Sometimes the value you want to propagate to a downstream promise can only be\r\n    retrieved asynchronously. This can be achieved by returning a promise in the\r\n    fulfillment or rejection handler. The downstream promise will then be pending\r\n    until the returned promise is settled. This is called *assimilation*.\r\n  \r\n    ```js\r\n    findUser().then(function (user) {\r\n      return findCommentsByAuthor(user);\r\n    }).then(function (comments) {\r\n      // The user's comments are now available\r\n    });\r\n    ```\r\n  \r\n    If the assimliated promise rejects, then the downstream promise will also reject.\r\n  \r\n    ```js\r\n    findUser().then(function (user) {\r\n      return findCommentsByAuthor(user);\r\n    }).then(function (comments) {\r\n      // If `findCommentsByAuthor` fulfills, we'll have the value here\r\n    }, function (reason) {\r\n      // If `findCommentsByAuthor` rejects, we'll have the reason here\r\n    });\r\n    ```\r\n  \r\n    Simple Example\r\n    --------------\r\n  \r\n    Synchronous Example\r\n  \r\n    ```javascript\r\n    let result;\r\n  \r\n    try {\r\n      result = findResult();\r\n      // success\r\n    } catch(reason) {\r\n      // failure\r\n    }\r\n    ```\r\n  \r\n    Errback Example\r\n  \r\n    ```js\r\n    findResult(function(result, err){\r\n      if (err) {\r\n        // failure\r\n      } else {\r\n        // success\r\n      }\r\n    });\r\n    ```\r\n  \r\n    Promise Example;\r\n  \r\n    ```javascript\r\n    findResult().then(function(result){\r\n      // success\r\n    }, function(reason){\r\n      // failure\r\n    });\r\n    ```\r\n  \r\n    Advanced Example\r\n    --------------\r\n  \r\n    Synchronous Example\r\n  \r\n    ```javascript\r\n    let author, books;\r\n  \r\n    try {\r\n      author = findAuthor();\r\n      books  = findBooksByAuthor(author);\r\n      // success\r\n    } catch(reason) {\r\n      // failure\r\n    }\r\n    ```\r\n  \r\n    Errback Example\r\n  \r\n    ```js\r\n  \r\n    function foundBooks(books) {\r\n  \r\n    }\r\n  \r\n    function failure(reason) {\r\n  \r\n    }\r\n  \r\n    findAuthor(function(author, err){\r\n      if (err) {\r\n        failure(err);\r\n        // failure\r\n      } else {\r\n        try {\r\n          findBoooksByAuthor(author, function(books, err) {\r\n            if (err) {\r\n              failure(err);\r\n            } else {\r\n              try {\r\n                foundBooks(books);\r\n              } catch(reason) {\r\n                failure(reason);\r\n              }\r\n            }\r\n          });\r\n        } catch(error) {\r\n          failure(err);\r\n        }\r\n        // success\r\n      }\r\n    });\r\n    ```\r\n  \r\n    Promise Example;\r\n  \r\n    ```javascript\r\n    findAuthor().\r\n      then(findBooksByAuthor).\r\n      then(function(books){\r\n        // found books\r\n    }).catch(function(reason){\r\n      // something went wrong\r\n    });\r\n    ```\r\n  \r\n    @method then\r\n    @param {Function} onFulfilled\r\n    @param {Function} onRejected\r\n    Useful for tooling.\r\n    @return {Promise}\r\n  */\r\n  then: then,\r\n\r\n  /**\r\n    `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\r\n    as the catch block of a try/catch statement.\r\n  \r\n    ```js\r\n    function findAuthor(){\r\n      throw new Error('couldn't find that author');\r\n    }\r\n  \r\n    // synchronous\r\n    try {\r\n      findAuthor();\r\n    } catch(reason) {\r\n      // something went wrong\r\n    }\r\n  \r\n    // async with promises\r\n    findAuthor().catch(function(reason){\r\n      // something went wrong\r\n    });\r\n    ```\r\n  \r\n    @method catch\r\n    @param {Function} onRejection\r\n    Useful for tooling.\r\n    @return {Promise}\r\n  */\r\n  'catch': function _catch(onRejection) {\r\n    return this.then(null, onRejection);\r\n  }\r\n};\r\n\r\nfunction polyfill() {\r\n    var local = undefined;\r\n\r\n    if (typeof global !== 'undefined') {\r\n        local = global;\r\n    } else if (typeof self !== 'undefined') {\r\n        local = self;\r\n    } else {\r\n        try {\r\n            local = Function('return this')();\r\n        } catch (e) {\r\n            throw new Error('polyfill failed because global object is unavailable in this environment');\r\n        }\r\n    }\r\n\r\n    var P = local.Promise;\r\n\r\n    if (P) {\r\n        var promiseToString = null;\r\n        try {\r\n            promiseToString = Object.prototype.toString.call(P.resolve());\r\n        } catch (e) {\r\n            // silently ignored\r\n        }\r\n\r\n        if (promiseToString === '[object Promise]' && !P.cast) {\r\n            return;\r\n        }\r\n    }\r\n\r\n    local.Promise = Promise;\r\n}\r\n\r\n// Strange compat..\r\nPromise.polyfill = polyfill;\r\nPromise.Promise = Promise;\r\n\r\nreturn Promise;\r\n\r\n})));\r\n\r\n\r\n}).call(this,_dereq_('_process'),typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\r\n\r\n},{\"_process\":3}],2:[function(_dereq_,module,exports){\r\n// Copyright Joyent, Inc. and other Node contributors.\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a\r\n// copy of this software and associated documentation files (the\r\n// \"Software\"), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to permit\r\n// persons to whom the Software is furnished to do so, subject to the\r\n// following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included\r\n// in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\r\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\r\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\r\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\r\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\r\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n\r\nfunction EventEmitter() {\r\n  this._events = this._events || {};\r\n  this._maxListeners = this._maxListeners || undefined;\r\n}\r\nmodule.exports = EventEmitter;\r\n\r\n// Backwards-compat with node 0.10.x\r\nEventEmitter.EventEmitter = EventEmitter;\r\n\r\nEventEmitter.prototype._events = undefined;\r\nEventEmitter.prototype._maxListeners = undefined;\r\n\r\n// By default EventEmitters will print a warning if more than 10 listeners are\r\n// added to it. This is a useful default which helps finding memory leaks.\r\nEventEmitter.defaultMaxListeners = 10;\r\n\r\n// Obviously not all Emitters should be limited to 10. This function allows\r\n// that to be increased. Set to zero for unlimited.\r\nEventEmitter.prototype.setMaxListeners = function(n) {\r\n  if (!isNumber(n) || n < 0 || isNaN(n))\r\n    throw TypeError('n must be a positive number');\r\n  this._maxListeners = n;\r\n  return this;\r\n};\r\n\r\nEventEmitter.prototype.emit = function(type) {\r\n  var er, handler, len, args, i, listeners;\r\n\r\n  if (!this._events)\r\n    this._events = {};\r\n\r\n  // If there is no 'error' event listener then throw.\r\n  if (type === 'error') {\r\n    if (!this._events.error ||\r\n        (isObject(this._events.error) && !this._events.error.length)) {\r\n      er = arguments[1];\r\n      if (er instanceof Error) {\r\n        throw er; // Unhandled 'error' event\r\n      } else {\r\n        // At least give some kind of context to the user\r\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\r\n        err.context = er;\r\n        throw err;\r\n      }\r\n    }\r\n  }\r\n\r\n  handler = this._events[type];\r\n\r\n  if (isUndefined(handler))\r\n    return false;\r\n\r\n  if (isFunction(handler)) {\r\n    switch (arguments.length) {\r\n      // fast cases\r\n      case 1:\r\n        handler.call(this);\r\n        break;\r\n      case 2:\r\n        handler.call(this, arguments[1]);\r\n        break;\r\n      case 3:\r\n        handler.call(this, arguments[1], arguments[2]);\r\n        break;\r\n      // slower\r\n      default:\r\n        args = Array.prototype.slice.call(arguments, 1);\r\n        handler.apply(this, args);\r\n    }\r\n  } else if (isObject(handler)) {\r\n    args = Array.prototype.slice.call(arguments, 1);\r\n    listeners = handler.slice();\r\n    len = listeners.length;\r\n    for (i = 0; i < len; i++)\r\n      listeners[i].apply(this, args);\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nEventEmitter.prototype.addListener = function(type, listener) {\r\n  var m;\r\n\r\n  if (!isFunction(listener))\r\n    throw TypeError('listener must be a function');\r\n\r\n  if (!this._events)\r\n    this._events = {};\r\n\r\n  // To avoid recursion in the case that type === \"newListener\"! Before\r\n  // adding it to the listeners, first emit \"newListener\".\r\n  if (this._events.newListener)\r\n    this.emit('newListener', type,\r\n              isFunction(listener.listener) ?\r\n              listener.listener : listener);\r\n\r\n  if (!this._events[type])\r\n    // Optimize the case of one listener. Don't need the extra array object.\r\n    this._events[type] = listener;\r\n  else if (isObject(this._events[type]))\r\n    // If we've already got an array, just append.\r\n    this._events[type].push(listener);\r\n  else\r\n    // Adding the second element, need to change to array.\r\n    this._events[type] = [this._events[type], listener];\r\n\r\n  // Check for listener leak\r\n  if (isObject(this._events[type]) && !this._events[type].warned) {\r\n    if (!isUndefined(this._maxListeners)) {\r\n      m = this._maxListeners;\r\n    } else {\r\n      m = EventEmitter.defaultMaxListeners;\r\n    }\r\n\r\n    if (m && m > 0 && this._events[type].length > m) {\r\n      this._events[type].warned = true;\r\n      console.error('(node) warning: possible EventEmitter memory ' +\r\n                    'leak detected. %d listeners added. ' +\r\n                    'Use emitter.setMaxListeners() to increase limit.',\r\n                    this._events[type].length);\r\n      if (typeof console.trace === 'function') {\r\n        // not supported in IE 10\r\n        console.trace();\r\n      }\r\n    }\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\r\n\r\nEventEmitter.prototype.once = function(type, listener) {\r\n  if (!isFunction(listener))\r\n    throw TypeError('listener must be a function');\r\n\r\n  var fired = false;\r\n\r\n  function g() {\r\n    this.removeListener(type, g);\r\n\r\n    if (!fired) {\r\n      fired = true;\r\n      listener.apply(this, arguments);\r\n    }\r\n  }\r\n\r\n  g.listener = listener;\r\n  this.on(type, g);\r\n\r\n  return this;\r\n};\r\n\r\n// emits a 'removeListener' event iff the listener was removed\r\nEventEmitter.prototype.removeListener = function(type, listener) {\r\n  var list, position, length, i;\r\n\r\n  if (!isFunction(listener))\r\n    throw TypeError('listener must be a function');\r\n\r\n  if (!this._events || !this._events[type])\r\n    return this;\r\n\r\n  list = this._events[type];\r\n  length = list.length;\r\n  position = -1;\r\n\r\n  if (list === listener ||\r\n      (isFunction(list.listener) && list.listener === listener)) {\r\n    delete this._events[type];\r\n    if (this._events.removeListener)\r\n      this.emit('removeListener', type, listener);\r\n\r\n  } else if (isObject(list)) {\r\n    for (i = length; i-- > 0;) {\r\n      if (list[i] === listener ||\r\n          (list[i].listener && list[i].listener === listener)) {\r\n        position = i;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (position < 0)\r\n      return this;\r\n\r\n    if (list.length === 1) {\r\n      list.length = 0;\r\n      delete this._events[type];\r\n    } else {\r\n      list.splice(position, 1);\r\n    }\r\n\r\n    if (this._events.removeListener)\r\n      this.emit('removeListener', type, listener);\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nEventEmitter.prototype.removeAllListeners = function(type) {\r\n  var key, listeners;\r\n\r\n  if (!this._events)\r\n    return this;\r\n\r\n  // not listening for removeListener, no need to emit\r\n  if (!this._events.removeListener) {\r\n    if (arguments.length === 0)\r\n      this._events = {};\r\n    else if (this._events[type])\r\n      delete this._events[type];\r\n    return this;\r\n  }\r\n\r\n  // emit removeListener for all listeners on all events\r\n  if (arguments.length === 0) {\r\n    for (key in this._events) {\r\n      if (key === 'removeListener') continue;\r\n      this.removeAllListeners(key);\r\n    }\r\n    this.removeAllListeners('removeListener');\r\n    this._events = {};\r\n    return this;\r\n  }\r\n\r\n  listeners = this._events[type];\r\n\r\n  if (isFunction(listeners)) {\r\n    this.removeListener(type, listeners);\r\n  } else if (listeners) {\r\n    // LIFO order\r\n    while (listeners.length)\r\n      this.removeListener(type, listeners[listeners.length - 1]);\r\n  }\r\n  delete this._events[type];\r\n\r\n  return this;\r\n};\r\n\r\nEventEmitter.prototype.listeners = function(type) {\r\n  var ret;\r\n  if (!this._events || !this._events[type])\r\n    ret = [];\r\n  else if (isFunction(this._events[type]))\r\n    ret = [this._events[type]];\r\n  else\r\n    ret = this._events[type].slice();\r\n  return ret;\r\n};\r\n\r\nEventEmitter.prototype.listenerCount = function(type) {\r\n  if (this._events) {\r\n    var evlistener = this._events[type];\r\n\r\n    if (isFunction(evlistener))\r\n      return 1;\r\n    else if (evlistener)\r\n      return evlistener.length;\r\n  }\r\n  return 0;\r\n};\r\n\r\nEventEmitter.listenerCount = function(emitter, type) {\r\n  return emitter.listenerCount(type);\r\n};\r\n\r\nfunction isFunction(arg) {\r\n  return typeof arg === 'function';\r\n}\r\n\r\nfunction isNumber(arg) {\r\n  return typeof arg === 'number';\r\n}\r\n\r\nfunction isObject(arg) {\r\n  return typeof arg === 'object' && arg !== null;\r\n}\r\n\r\nfunction isUndefined(arg) {\r\n  return arg === void 0;\r\n}\r\n\r\n},{}],3:[function(_dereq_,module,exports){\r\n// shim for using process in browser\r\nvar process = module.exports = {};\r\n\r\n// cached from whatever global is present so that test runners that stub it\r\n// don't break things.  But we need to wrap it in a try catch in case it is\r\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\r\n// function because try/catches deoptimize in certain engines.\r\n\r\nvar cachedSetTimeout;\r\nvar cachedClearTimeout;\r\n\r\nfunction defaultSetTimout() {\r\n    throw new Error('setTimeout has not been defined');\r\n}\r\nfunction defaultClearTimeout () {\r\n    throw new Error('clearTimeout has not been defined');\r\n}\r\n(function () {\r\n    try {\r\n        if (typeof setTimeout === 'function') {\r\n            cachedSetTimeout = setTimeout;\r\n        } else {\r\n            cachedSetTimeout = defaultSetTimout;\r\n        }\r\n    } catch (e) {\r\n        cachedSetTimeout = defaultSetTimout;\r\n    }\r\n    try {\r\n        if (typeof clearTimeout === 'function') {\r\n            cachedClearTimeout = clearTimeout;\r\n        } else {\r\n            cachedClearTimeout = defaultClearTimeout;\r\n        }\r\n    } catch (e) {\r\n        cachedClearTimeout = defaultClearTimeout;\r\n    }\r\n} ())\r\nfunction runTimeout(fun) {\r\n    if (cachedSetTimeout === setTimeout) {\r\n        //normal enviroments in sane situations\r\n        return setTimeout(fun, 0);\r\n    }\r\n    // if setTimeout wasn't available but was latter defined\r\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\r\n        cachedSetTimeout = setTimeout;\r\n        return setTimeout(fun, 0);\r\n    }\r\n    try {\r\n        // when when somebody has screwed with setTimeout but no I.E. maddness\r\n        return cachedSetTimeout(fun, 0);\r\n    } catch(e){\r\n        try {\r\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\r\n            return cachedSetTimeout.call(null, fun, 0);\r\n        } catch(e){\r\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\r\n            return cachedSetTimeout.call(this, fun, 0);\r\n        }\r\n    }\r\n\r\n\r\n}\r\nfunction runClearTimeout(marker) {\r\n    if (cachedClearTimeout === clearTimeout) {\r\n        //normal enviroments in sane situations\r\n        return clearTimeout(marker);\r\n    }\r\n    // if clearTimeout wasn't available but was latter defined\r\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\r\n        cachedClearTimeout = clearTimeout;\r\n        return clearTimeout(marker);\r\n    }\r\n    try {\r\n        // when when somebody has screwed with setTimeout but no I.E. maddness\r\n        return cachedClearTimeout(marker);\r\n    } catch (e){\r\n        try {\r\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\r\n            return cachedClearTimeout.call(null, marker);\r\n        } catch (e){\r\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\r\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\r\n            return cachedClearTimeout.call(this, marker);\r\n        }\r\n    }\r\n\r\n\r\n\r\n}\r\nvar queue = [];\r\nvar draining = false;\r\nvar currentQueue;\r\nvar queueIndex = -1;\r\n\r\nfunction cleanUpNextTick() {\r\n    if (!draining || !currentQueue) {\r\n        return;\r\n    }\r\n    draining = false;\r\n    if (currentQueue.length) {\r\n        queue = currentQueue.concat(queue);\r\n    } else {\r\n        queueIndex = -1;\r\n    }\r\n    if (queue.length) {\r\n        drainQueue();\r\n    }\r\n}\r\n\r\nfunction drainQueue() {\r\n    if (draining) {\r\n        return;\r\n    }\r\n    var timeout = runTimeout(cleanUpNextTick);\r\n    draining = true;\r\n\r\n    var len = queue.length;\r\n    while(len) {\r\n        currentQueue = queue;\r\n        queue = [];\r\n        while (++queueIndex < len) {\r\n            if (currentQueue) {\r\n                currentQueue[queueIndex].run();\r\n            }\r\n        }\r\n        queueIndex = -1;\r\n        len = queue.length;\r\n    }\r\n    currentQueue = null;\r\n    draining = false;\r\n    runClearTimeout(timeout);\r\n}\r\n\r\nprocess.nextTick = function (fun) {\r\n    var args = new Array(arguments.length - 1);\r\n    if (arguments.length > 1) {\r\n        for (var i = 1; i < arguments.length; i++) {\r\n            args[i - 1] = arguments[i];\r\n        }\r\n    }\r\n    queue.push(new Item(fun, args));\r\n    if (queue.length === 1 && !draining) {\r\n        runTimeout(drainQueue);\r\n    }\r\n};\r\n\r\n// v8 likes predictible objects\r\nfunction Item(fun, array) {\r\n    this.fun = fun;\r\n    this.array = array;\r\n}\r\nItem.prototype.run = function () {\r\n    this.fun.apply(null, this.array);\r\n};\r\nprocess.title = 'browser';\r\nprocess.browser = true;\r\nprocess.env = {};\r\nprocess.argv = [];\r\nprocess.version = ''; // empty string to avoid regexp issues\r\nprocess.versions = {};\r\n\r\nfunction noop() {}\r\n\r\nprocess.on = noop;\r\nprocess.addListener = noop;\r\nprocess.once = noop;\r\nprocess.off = noop;\r\nprocess.removeListener = noop;\r\nprocess.removeAllListeners = noop;\r\nprocess.emit = noop;\r\nprocess.prependListener = noop;\r\nprocess.prependOnceListener = noop;\r\n\r\nprocess.listeners = function (name) { return [] }\r\n\r\nprocess.binding = function (name) {\r\n    throw new Error('process.binding is not supported');\r\n};\r\n\r\nprocess.cwd = function () { return '/' };\r\nprocess.chdir = function (dir) {\r\n    throw new Error('process.chdir is not supported');\r\n};\r\nprocess.umask = function() { return 0; };\r\n\r\n},{}],4:[function(_dereq_,module,exports){\r\nvar bundleFn = arguments[3];\r\nvar sources = arguments[4];\r\nvar cache = arguments[5];\r\n\r\nvar stringify = JSON.stringify;\r\n\r\nmodule.exports = function (fn, options) {\r\n    var wkey;\r\n    var cacheKeys = Object.keys(cache);\r\n\r\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\r\n        var key = cacheKeys[i];\r\n        var exp = cache[key].exports;\r\n        // Using babel as a transpiler to use esmodule, the export will always\r\n        // be an object with the default export as a property of it. To ensure\r\n        // the existing api and babel esmodule exports are both supported we\r\n        // check for both\r\n        if (exp === fn || exp && exp.default === fn) {\r\n            wkey = key;\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!wkey) {\r\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\r\n        var wcache = {};\r\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\r\n            var key = cacheKeys[i];\r\n            wcache[key] = key;\r\n        }\r\n        sources[wkey] = [\r\n            Function(['require','module','exports'], '(' + fn + ')(self)'),\r\n            wcache\r\n        ];\r\n    }\r\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\r\n\r\n    var scache = {}; scache[wkey] = wkey;\r\n    sources[skey] = [\r\n        Function(['require'], (\r\n            // try to call default if defined to also support babel esmodule\r\n            // exports\r\n            'var f = require(' + stringify(wkey) + ');' +\r\n            '(f.default ? f.default : f)(self);'\r\n        )),\r\n        scache\r\n    ];\r\n\r\n    var workerSources = {};\r\n    resolveSources(skey);\r\n\r\n    function resolveSources(key) {\r\n        workerSources[key] = true;\r\n\r\n        for (var depPath in sources[key][1]) {\r\n            var depKey = sources[key][1][depPath];\r\n            if (!workerSources[depKey]) {\r\n                resolveSources(depKey);\r\n            }\r\n        }\r\n    }\r\n\r\n    var src = '(' + bundleFn + ')({'\r\n        + Object.keys(workerSources).map(function (key) {\r\n            return stringify(key) + ':['\r\n                + sources[key][0]\r\n                + ',' + stringify(sources[key][1]) + ']'\r\n            ;\r\n        }).join(',')\r\n        + '},{},[' + stringify(skey) + '])'\r\n    ;\r\n\r\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\r\n\r\n    var blob = new Blob([src], { type: 'text/javascript' });\r\n    if (options && options.bare) { return blob; }\r\n    var workerUrl = URL.createObjectURL(blob);\r\n    var worker = new Worker(workerUrl);\r\n    worker.objectURL = workerUrl;\r\n    return worker;\r\n};\r\n\r\n},{}],5:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\nexports.createDefaultConfig = createDefaultConfig;\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nvar defaultConfig = exports.defaultConfig = {\r\n    enableWorker: false,\r\n    enableStashBuffer: true,\r\n    stashInitialSize: undefined,\r\n\r\n    isLive: false,\r\n\r\n    lazyLoad: true,\r\n    lazyLoadMaxDuration: 3 * 60,\r\n    lazyLoadRecoverDuration: 30,\r\n    deferLoadAfterSourceOpen: true,\r\n\r\n    // autoCleanupSourceBuffer: default as false, leave unspecified\r\n    autoCleanupMaxBackwardDuration: 3 * 60,\r\n    autoCleanupMinBackwardDuration: 2 * 60,\r\n\r\n    statisticsInfoReportInterval: 600,\r\n\r\n    fixAudioTimestampGap: true,\r\n\r\n    accurateSeek: false,\r\n    seekType: 'range', // [range, param, custom]\r\n    seekParamStart: 'bstart',\r\n    seekParamEnd: 'bend',\r\n    rangeLoadZeroStart: false,\r\n    customSeekHandler: undefined,\r\n    reuseRedirectedURL: false\r\n    // referrerPolicy: leave as unspecified\r\n};\r\n\r\nfunction createDefaultConfig() {\r\n    return Object.assign({}, defaultConfig);\r\n}\r\n\r\n},{}],6:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _ioController = _dereq_('../io/io-controller.js');\r\n\r\nvar _ioController2 = _interopRequireDefault(_ioController);\r\n\r\nvar _config = _dereq_('../config.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nvar Features = function () {\r\n    function Features() {\r\n        _classCallCheck(this, Features);\r\n    }\r\n\r\n    _createClass(Features, null, [{\r\n        key: 'supportMSEH264Playback',\r\n        value: function supportMSEH264Playback() {\r\n            return window.MediaSource && window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\r\n        }\r\n    }, {\r\n        key: 'supportNetworkStreamIO',\r\n        value: function supportNetworkStreamIO() {\r\n            var ioctl = new _ioController2.default({}, (0, _config.createDefaultConfig)());\r\n            var loaderType = ioctl.loaderType;\r\n            ioctl.destroy();\r\n            return loaderType == 'fetch-stream-loader' || loaderType == 'xhr-moz-chunked-loader';\r\n        }\r\n    }, {\r\n        key: 'getNetworkLoaderTypeName',\r\n        value: function getNetworkLoaderTypeName() {\r\n            var ioctl = new _ioController2.default({}, (0, _config.createDefaultConfig)());\r\n            var loaderType = ioctl.loaderType;\r\n            ioctl.destroy();\r\n            return loaderType;\r\n        }\r\n    }, {\r\n        key: 'supportNativeMediaPlayback',\r\n        value: function supportNativeMediaPlayback(mimeType) {\r\n            if (Features.videoElement == undefined) {\r\n                Features.videoElement = window.document.createElement('video');\r\n            }\r\n            var canPlay = Features.videoElement.canPlayType(mimeType);\r\n            return canPlay === 'probably' || canPlay == 'maybe';\r\n        }\r\n    }, {\r\n        key: 'getFeatureList',\r\n        value: function getFeatureList() {\r\n            var features = {\r\n                mseFlvPlayback: false,\r\n                mseLiveFlvPlayback: false,\r\n                networkStreamIO: false,\r\n                networkLoaderName: '',\r\n                nativeMP4H264Playback: false,\r\n                nativeWebmVP8Playback: false,\r\n                nativeWebmVP9Playback: false\r\n            };\r\n\r\n            features.mseFlvPlayback = Features.supportMSEH264Playback();\r\n            features.networkStreamIO = Features.supportNetworkStreamIO();\r\n            features.networkLoaderName = Features.getNetworkLoaderTypeName();\r\n            features.mseLiveFlvPlayback = features.mseFlvPlayback && features.networkStreamIO;\r\n            features.nativeMP4H264Playback = Features.supportNativeMediaPlayback('video/mp4; codecs=\"avc1.42001E, mp4a.40.2\"');\r\n            features.nativeWebmVP8Playback = Features.supportNativeMediaPlayback('video/webm; codecs=\"vp8.0, vorbis\"');\r\n            features.nativeWebmVP9Playback = Features.supportNativeMediaPlayback('video/webm; codecs=\"vp9\"');\r\n\r\n            return features;\r\n        }\r\n    }]);\r\n\r\n    return Features;\r\n}();\r\n\r\nexports.default = Features;\r\n\r\n},{\"../config.js\":5,\"../io/io-controller.js\":23}],7:[function(_dereq_,module,exports){\r\n\"use strict\";\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nvar MediaInfo = function () {\r\n    function MediaInfo() {\r\n        _classCallCheck(this, MediaInfo);\r\n\r\n        this.mimeType = null;\r\n        this.duration = null;\r\n\r\n        this.hasAudio = null;\r\n        this.hasVideo = null;\r\n        this.audioCodec = null;\r\n        this.videoCodec = null;\r\n        this.audioDataRate = null;\r\n        this.videoDataRate = null;\r\n\r\n        this.audioSampleRate = null;\r\n        this.audioChannelCount = null;\r\n\r\n        this.width = null;\r\n        this.height = null;\r\n        this.fps = null;\r\n        this.profile = null;\r\n        this.level = null;\r\n        this.chromaFormat = null;\r\n        this.sarNum = null;\r\n        this.sarDen = null;\r\n\r\n        this.metadata = null;\r\n        this.segments = null; // MediaInfo[]\r\n        this.segmentCount = null;\r\n        this.hasKeyframesIndex = null;\r\n        this.keyframesIndex = null;\r\n    }\r\n\r\n    _createClass(MediaInfo, [{\r\n        key: \"isComplete\",\r\n        value: function isComplete() {\r\n            var audioInfoComplete = this.hasAudio === false || this.hasAudio === true && this.audioCodec != null && this.audioSampleRate != null && this.audioChannelCount != null;\r\n\r\n            var videoInfoComplete = this.hasVideo === false || this.hasVideo === true && this.videoCodec != null && this.width != null && this.height != null && this.fps != null && this.profile != null && this.level != null && this.chromaFormat != null && this.sarNum != null && this.sarDen != null;\r\n\r\n            // keyframesIndex may not be present\r\n            return this.mimeType != null && this.duration != null && this.metadata != null && this.hasKeyframesIndex != null && audioInfoComplete && videoInfoComplete;\r\n        }\r\n    }, {\r\n        key: \"isSeekable\",\r\n        value: function isSeekable() {\r\n            return this.hasKeyframesIndex === true;\r\n        }\r\n    }, {\r\n        key: \"getNearestKeyframe\",\r\n        value: function getNearestKeyframe(milliseconds) {\r\n            if (this.keyframesIndex == null) {\r\n                return null;\r\n            }\r\n\r\n            var table = this.keyframesIndex;\r\n            var keyframeIdx = this._search(table.times, milliseconds);\r\n\r\n            return {\r\n                index: keyframeIdx,\r\n                milliseconds: table.times[keyframeIdx],\r\n                fileposition: table.filepositions[keyframeIdx]\r\n            };\r\n        }\r\n    }, {\r\n        key: \"_search\",\r\n        value: function _search(list, value) {\r\n            var idx = 0;\r\n\r\n            var last = list.length - 1;\r\n            var mid = 0;\r\n            var lbound = 0;\r\n            var ubound = last;\r\n\r\n            if (value < list[0]) {\r\n                idx = 0;\r\n                lbound = ubound + 1; // skip search\r\n            }\r\n\r\n            while (lbound <= ubound) {\r\n                mid = lbound + Math.floor((ubound - lbound) / 2);\r\n                if (mid === last || value >= list[mid] && value < list[mid + 1]) {\r\n                    idx = mid;\r\n                    break;\r\n                } else if (list[mid] < value) {\r\n                    lbound = mid + 1;\r\n                } else {\r\n                    ubound = mid - 1;\r\n                }\r\n            }\r\n\r\n            return idx;\r\n        }\r\n    }]);\r\n\r\n    return MediaInfo;\r\n}();\r\n\r\nexports.default = MediaInfo;\r\n\r\n},{}],8:[function(_dereq_,module,exports){\r\n\"use strict\";\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\n// Represents an media sample (audio / video)\r\nvar SampleInfo = exports.SampleInfo = function SampleInfo(dts, pts, duration, originalDts, isSync) {\r\n    _classCallCheck(this, SampleInfo);\r\n\r\n    this.dts = dts;\r\n    this.pts = pts;\r\n    this.duration = duration;\r\n    this.originalDts = originalDts;\r\n    this.isSyncPoint = isSync;\r\n    this.fileposition = null;\r\n};\r\n\r\n// Media Segment concept is defined in Media Source Extensions spec.\r\n// Particularly in ISO BMFF format, an Media Segment contains a moof box followed by a mdat box.\r\n\r\n\r\nvar MediaSegmentInfo = exports.MediaSegmentInfo = function () {\r\n    function MediaSegmentInfo() {\r\n        _classCallCheck(this, MediaSegmentInfo);\r\n\r\n        this.beginDts = 0;\r\n        this.endDts = 0;\r\n        this.beginPts = 0;\r\n        this.endPts = 0;\r\n        this.originalBeginDts = 0;\r\n        this.originalEndDts = 0;\r\n        this.syncPoints = []; // SampleInfo[n], for video IDR frames only\r\n        this.firstSample = null; // SampleInfo\r\n        this.lastSample = null; // SampleInfo\r\n    }\r\n\r\n    _createClass(MediaSegmentInfo, [{\r\n        key: \"appendSyncPoint\",\r\n        value: function appendSyncPoint(sampleInfo) {\r\n            // also called Random Access Point\r\n            sampleInfo.isSyncPoint = true;\r\n            this.syncPoints.push(sampleInfo);\r\n        }\r\n    }]);\r\n\r\n    return MediaSegmentInfo;\r\n}();\r\n\r\n// Ordered list for recording video IDR frames, sorted by originalDts\r\n\r\n\r\nvar IDRSampleList = exports.IDRSampleList = function () {\r\n    function IDRSampleList() {\r\n        _classCallCheck(this, IDRSampleList);\r\n\r\n        this._list = [];\r\n    }\r\n\r\n    _createClass(IDRSampleList, [{\r\n        key: \"clear\",\r\n        value: function clear() {\r\n            this._list = [];\r\n        }\r\n    }, {\r\n        key: \"appendArray\",\r\n        value: function appendArray(syncPoints) {\r\n            var list = this._list;\r\n\r\n            if (syncPoints.length === 0) {\r\n                return;\r\n            }\r\n\r\n            if (list.length > 0 && syncPoints[0].originalDts < list[list.length - 1].originalDts) {\r\n                this.clear();\r\n            }\r\n\r\n            Array.prototype.push.apply(list, syncPoints);\r\n        }\r\n    }, {\r\n        key: \"getLastSyncPointBeforeDts\",\r\n        value: function getLastSyncPointBeforeDts(dts) {\r\n            if (this._list.length == 0) {\r\n                return null;\r\n            }\r\n\r\n            var list = this._list;\r\n            var idx = 0;\r\n            var last = list.length - 1;\r\n            var mid = 0;\r\n            var lbound = 0;\r\n            var ubound = last;\r\n\r\n            if (dts < list[0].dts) {\r\n                idx = 0;\r\n                lbound = ubound + 1;\r\n            }\r\n\r\n            while (lbound <= ubound) {\r\n                mid = lbound + Math.floor((ubound - lbound) / 2);\r\n                if (mid === last || dts >= list[mid].dts && dts < list[mid + 1].dts) {\r\n                    idx = mid;\r\n                    break;\r\n                } else if (list[mid].dts < dts) {\r\n                    lbound = mid + 1;\r\n                } else {\r\n                    ubound = mid - 1;\r\n                }\r\n            }\r\n            return this._list[idx];\r\n        }\r\n    }]);\r\n\r\n    return IDRSampleList;\r\n}();\r\n\r\n// Data structure for recording information of media segments in single track.\r\n\r\n\r\nvar MediaSegmentInfoList = exports.MediaSegmentInfoList = function () {\r\n    function MediaSegmentInfoList(type) {\r\n        _classCallCheck(this, MediaSegmentInfoList);\r\n\r\n        this._type = type;\r\n        this._list = [];\r\n        this._lastAppendLocation = -1; // cached last insert location\r\n    }\r\n\r\n    _createClass(MediaSegmentInfoList, [{\r\n        key: \"isEmpty\",\r\n        value: function isEmpty() {\r\n            return this._list.length === 0;\r\n        }\r\n    }, {\r\n        key: \"clear\",\r\n        value: function clear() {\r\n            this._list = [];\r\n            this._lastAppendLocation = -1;\r\n        }\r\n    }, {\r\n        key: \"_searchNearestSegmentBefore\",\r\n        value: function _searchNearestSegmentBefore(originalBeginDts) {\r\n            var list = this._list;\r\n            if (list.length === 0) {\r\n                return -2;\r\n            }\r\n            var last = list.length - 1;\r\n            var mid = 0;\r\n            var lbound = 0;\r\n            var ubound = last;\r\n\r\n            var idx = 0;\r\n\r\n            if (originalBeginDts < list[0].originalBeginDts) {\r\n                idx = -1;\r\n                return idx;\r\n            }\r\n\r\n            while (lbound <= ubound) {\r\n                mid = lbound + Math.floor((ubound - lbound) / 2);\r\n                if (mid === last || originalBeginDts > list[mid].lastSample.originalDts && originalBeginDts < list[mid + 1].originalBeginDts) {\r\n                    idx = mid;\r\n                    break;\r\n                } else if (list[mid].originalBeginDts < originalBeginDts) {\r\n                    lbound = mid + 1;\r\n                } else {\r\n                    ubound = mid - 1;\r\n                }\r\n            }\r\n            return idx;\r\n        }\r\n    }, {\r\n        key: \"_searchNearestSegmentAfter\",\r\n        value: function _searchNearestSegmentAfter(originalBeginDts) {\r\n            return this._searchNearestSegmentBefore(originalBeginDts) + 1;\r\n        }\r\n    }, {\r\n        key: \"append\",\r\n        value: function append(mediaSegmentInfo) {\r\n            var list = this._list;\r\n            var msi = mediaSegmentInfo;\r\n            var lastAppendIdx = this._lastAppendLocation;\r\n            var insertIdx = 0;\r\n\r\n            if (lastAppendIdx !== -1 && lastAppendIdx < list.length && msi.originalBeginDts >= list[lastAppendIdx].lastSample.originalDts && (lastAppendIdx === list.length - 1 || lastAppendIdx < list.length - 1 && msi.originalBeginDts < list[lastAppendIdx + 1].originalBeginDts)) {\r\n                insertIdx = lastAppendIdx + 1; // use cached location idx\r\n            } else {\r\n                if (list.length > 0) {\r\n                    insertIdx = this._searchNearestSegmentBefore(msi.originalBeginDts) + 1;\r\n                }\r\n            }\r\n\r\n            this._lastAppendLocation = insertIdx;\r\n            this._list.splice(insertIdx, 0, msi);\r\n        }\r\n    }, {\r\n        key: \"getLastSegmentBefore\",\r\n        value: function getLastSegmentBefore(originalBeginDts) {\r\n            var idx = this._searchNearestSegmentBefore(originalBeginDts);\r\n            if (idx >= 0) {\r\n                return this._list[idx];\r\n            } else {\r\n                // -1\r\n                return null;\r\n            }\r\n        }\r\n    }, {\r\n        key: \"getLastSampleBefore\",\r\n        value: function getLastSampleBefore(originalBeginDts) {\r\n            var segment = this.getLastSegmentBefore(originalBeginDts);\r\n            if (segment != null) {\r\n                return segment.lastSample;\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n    }, {\r\n        key: \"getLastSyncPointBefore\",\r\n        value: function getLastSyncPointBefore(originalBeginDts) {\r\n            var segmentIdx = this._searchNearestSegmentBefore(originalBeginDts);\r\n            var syncPoints = this._list[segmentIdx].syncPoints;\r\n            while (syncPoints.length === 0 && segmentIdx > 0) {\r\n                segmentIdx--;\r\n                syncPoints = this._list[segmentIdx].syncPoints;\r\n            }\r\n            if (syncPoints.length > 0) {\r\n                return syncPoints[syncPoints.length - 1];\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n    }, {\r\n        key: \"type\",\r\n        get: function get() {\r\n            return this._type;\r\n        }\r\n    }, {\r\n        key: \"length\",\r\n        get: function get() {\r\n            return this._list.length;\r\n        }\r\n    }]);\r\n\r\n    return MediaSegmentInfoList;\r\n}();\r\n\r\n},{}],9:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _events = _dereq_('events');\r\n\r\nvar _events2 = _interopRequireDefault(_events);\r\n\r\nvar _logger = _dereq_('../utils/logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nvar _browser = _dereq_('../utils/browser.js');\r\n\r\nvar _browser2 = _interopRequireDefault(_browser);\r\n\r\nvar _mseEvents = _dereq_('./mse-events.js');\r\n\r\nvar _mseEvents2 = _interopRequireDefault(_mseEvents);\r\n\r\nvar _mediaSegmentInfo = _dereq_('./media-segment-info.js');\r\n\r\nvar _exception = _dereq_('../utils/exception.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n// Media Source Extensions controller\r\nvar MSEController = function () {\r\n    function MSEController(config) {\r\n        _classCallCheck(this, MSEController);\r\n\r\n        this.TAG = 'MSEController';\r\n\r\n        this._config = config;\r\n        this._emitter = new _events2.default();\r\n\r\n        if (this._config.isLive && this._config.autoCleanupSourceBuffer == undefined) {\r\n            // For live stream, do auto cleanup by default\r\n            this._config.autoCleanupSourceBuffer = true;\r\n        }\r\n\r\n        this.e = {\r\n            onSourceOpen: this._onSourceOpen.bind(this),\r\n            onSourceEnded: this._onSourceEnded.bind(this),\r\n            onSourceClose: this._onSourceClose.bind(this),\r\n            onSourceBufferError: this._onSourceBufferError.bind(this),\r\n            onSourceBufferUpdateEnd: this._onSourceBufferUpdateEnd.bind(this)\r\n        };\r\n\r\n        this._mediaSource = null;\r\n        this._mediaSourceObjectURL = null;\r\n        this._mediaElement = null;\r\n\r\n        this._isBufferFull = false;\r\n        this._hasPendingEos = false;\r\n\r\n        this._requireSetMediaDuration = false;\r\n        this._pendingMediaDuration = 0;\r\n\r\n        this._pendingSourceBufferInit = [];\r\n        this._mimeTypes = {\r\n            video: null,\r\n            audio: null\r\n        };\r\n        this._sourceBuffers = {\r\n            video: null,\r\n            audio: null\r\n        };\r\n        this._lastInitSegments = {\r\n            video: null,\r\n            audio: null\r\n        };\r\n        this._pendingSegments = {\r\n            video: [],\r\n            audio: []\r\n        };\r\n        this._pendingRemoveRanges = {\r\n            video: [],\r\n            audio: []\r\n        };\r\n        this._idrList = new _mediaSegmentInfo.IDRSampleList();\r\n    }\r\n\r\n    _createClass(MSEController, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            if (this._mediaElement || this._mediaSource) {\r\n                this.detachMediaElement();\r\n            }\r\n            this.e = null;\r\n            this._emitter.removeAllListeners();\r\n            this._emitter = null;\r\n        }\r\n    }, {\r\n        key: 'on',\r\n        value: function on(event, listener) {\r\n            this._emitter.addListener(event, listener);\r\n        }\r\n    }, {\r\n        key: 'off',\r\n        value: function off(event, listener) {\r\n            this._emitter.removeListener(event, listener);\r\n        }\r\n    }, {\r\n        key: 'attachMediaElement',\r\n        value: function attachMediaElement(mediaElement) {\r\n            if (this._mediaSource) {\r\n                throw new _exception.IllegalStateException('MediaSource has been attached to an HTMLMediaElement!');\r\n            }\r\n            var ms = this._mediaSource = new window.MediaSource();\r\n            ms.addEventListener('sourceopen', this.e.onSourceOpen);\r\n            ms.addEventListener('sourceended', this.e.onSourceEnded);\r\n            ms.addEventListener('sourceclose', this.e.onSourceClose);\r\n\r\n            this._mediaElement = mediaElement;\r\n            this._mediaSourceObjectURL = window.URL.createObjectURL(this._mediaSource);\r\n            mediaElement.src = this._mediaSourceObjectURL;\r\n        }\r\n    }, {\r\n        key: 'detachMediaElement',\r\n        value: function detachMediaElement() {\r\n            if (this._mediaSource) {\r\n                var ms = this._mediaSource;\r\n                for (var type in this._sourceBuffers) {\r\n                    // pending segments should be discard\r\n                    var ps = this._pendingSegments[type];\r\n                    ps.splice(0, ps.length);\r\n                    this._pendingSegments[type] = null;\r\n                    this._pendingRemoveRanges[type] = null;\r\n                    this._lastInitSegments[type] = null;\r\n\r\n                    // remove all sourcebuffers\r\n                    var sb = this._sourceBuffers[type];\r\n                    if (sb) {\r\n                        if (ms.readyState !== 'closed') {\r\n                            ms.removeSourceBuffer(sb);\r\n                            sb.removeEventListener('error', this.e.onSourceBufferError);\r\n                            sb.removeEventListener('updateend', this.e.onSourceBufferUpdateEnd);\r\n                        }\r\n                        this._mimeTypes[type] = null;\r\n                        this._sourceBuffers[type] = null;\r\n                    }\r\n                }\r\n                if (ms.readyState === 'open') {\r\n                    try {\r\n                        ms.endOfStream();\r\n                    } catch (error) {\r\n                        _logger2.default.e(this.TAG, error.message);\r\n                    }\r\n                }\r\n                ms.removeEventListener('sourceopen', this.e.onSourceOpen);\r\n                ms.removeEventListener('sourceended', this.e.onSourceEnded);\r\n                ms.removeEventListener('sourceclose', this.e.onSourceClose);\r\n                this._pendingSourceBufferInit = [];\r\n                this._isBufferFull = false;\r\n                this._idrList.clear();\r\n                this._mediaSource = null;\r\n            }\r\n\r\n            if (this._mediaElement) {\r\n                this._mediaElement.src = '';\r\n                this._mediaElement.removeAttribute('src');\r\n                this._mediaElement = null;\r\n            }\r\n            if (this._mediaSourceObjectURL) {\r\n                window.URL.revokeObjectURL(this._mediaSourceObjectURL);\r\n                this._mediaSourceObjectURL = null;\r\n            }\r\n        }\r\n    }, {\r\n        key: 'appendInitSegment',\r\n        value: function appendInitSegment(initSegment, deferred) {\r\n            if (!this._mediaSource || this._mediaSource.readyState !== 'open') {\r\n                // sourcebuffer creation requires mediaSource.readyState === 'open'\r\n                // so we defer the sourcebuffer creation, until sourceopen event triggered\r\n                this._pendingSourceBufferInit.push(initSegment);\r\n                // make sure that this InitSegment is in the front of pending segments queue\r\n                this._pendingSegments[initSegment.type].push(initSegment);\r\n                return;\r\n            }\r\n\r\n            var is = initSegment;\r\n            var mimeType = '' + is.container;\r\n            if (is.codec && is.codec.length > 0) {\r\n                mimeType += ';codecs=' + is.codec;\r\n            }\r\n\r\n            var firstInitSegment = false;\r\n\r\n            _logger2.default.v(this.TAG, 'Received Initialization Segment, mimeType: ' + mimeType);\r\n            this._lastInitSegments[is.type] = is;\r\n\r\n            if (mimeType !== this._mimeTypes[is.type]) {\r\n                if (!this._mimeTypes[is.type]) {\r\n                    // empty, first chance create sourcebuffer\r\n                    firstInitSegment = true;\r\n                    try {\r\n                        var sb = this._sourceBuffers[is.type] = this._mediaSource.addSourceBuffer(mimeType);\r\n                        sb.addEventListener('error', this.e.onSourceBufferError);\r\n                        sb.addEventListener('updateend', this.e.onSourceBufferUpdateEnd);\r\n                    } catch (error) {\r\n                        _logger2.default.e(this.TAG, error.message);\r\n                        this._emitter.emit(_mseEvents2.default.ERROR, { code: error.code, msg: error.message });\r\n                        return;\r\n                    }\r\n                } else {\r\n                    _logger2.default.v(this.TAG, 'Notice: ' + is.type + ' mimeType changed, origin: ' + this._mimeTypes[is.type] + ', target: ' + mimeType);\r\n                }\r\n                this._mimeTypes[is.type] = mimeType;\r\n            }\r\n\r\n            if (!deferred) {\r\n                // deferred means this InitSegment has been pushed to pendingSegments queue\r\n                this._pendingSegments[is.type].push(is);\r\n            }\r\n            if (!firstInitSegment) {\r\n                // append immediately only if init segment in subsequence\r\n                if (this._sourceBuffers[is.type] && !this._sourceBuffers[is.type].updating) {\r\n                    this._doAppendSegments();\r\n                }\r\n            }\r\n            if (_browser2.default.safari && is.container === 'audio/mpeg' && is.mediaDuration > 0) {\r\n                // 'audio/mpeg' track under Safari may cause MediaElement's duration to be NaN\r\n                // Manually correct MediaSource.duration to make progress bar seekable, and report right duration\r\n                this._requireSetMediaDuration = true;\r\n                this._pendingMediaDuration = is.mediaDuration / 1000; // in seconds\r\n                this._updateMediaSourceDuration();\r\n            }\r\n        }\r\n    }, {\r\n        key: 'appendMediaSegment',\r\n        value: function appendMediaSegment(mediaSegment) {\r\n            var ms = mediaSegment;\r\n            this._pendingSegments[ms.type].push(ms);\r\n\r\n            if (this._config.autoCleanupSourceBuffer && this._needCleanupSourceBuffer()) {\r\n                this._doCleanupSourceBuffer();\r\n            }\r\n\r\n            var sb = this._sourceBuffers[ms.type];\r\n            if (sb && !sb.updating && !this._hasPendingRemoveRanges()) {\r\n                this._doAppendSegments();\r\n            }\r\n        }\r\n    }, {\r\n        key: 'seek',\r\n        value: function seek(seconds) {\r\n            // remove all appended buffers\r\n            for (var type in this._sourceBuffers) {\r\n                if (!this._sourceBuffers[type]) {\r\n                    continue;\r\n                }\r\n\r\n                // abort current buffer append algorithm\r\n                var sb = this._sourceBuffers[type];\r\n                if (this._mediaSource.readyState === 'open') {\r\n                    try {\r\n                        // If range removal algorithm is running, InvalidStateError will be throwed\r\n                        // Ignore it.\r\n                        sb.abort();\r\n                    } catch (error) {\r\n                        _logger2.default.e(this.TAG, error.message);\r\n                    }\r\n                }\r\n\r\n                // IDRList should be clear\r\n                this._idrList.clear();\r\n\r\n                // pending segments should be discard\r\n                var ps = this._pendingSegments[type];\r\n                ps.splice(0, ps.length);\r\n\r\n                if (this._mediaSource.readyState === 'closed') {\r\n                    // Parent MediaSource object has been detached from HTMLMediaElement\r\n                    continue;\r\n                }\r\n\r\n                // record ranges to be remove from SourceBuffer\r\n                for (var i = 0; i < sb.buffered.length; i++) {\r\n                    var start = sb.buffered.start(i);\r\n                    var end = sb.buffered.end(i);\r\n                    this._pendingRemoveRanges[type].push({ start: start, end: end });\r\n                }\r\n\r\n                // if sb is not updating, let's remove ranges now!\r\n                if (!sb.updating) {\r\n                    this._doRemoveRanges();\r\n                }\r\n\r\n                // Safari 10 may get InvalidStateError in the later appendBuffer() after SourceBuffer.remove() call\r\n                // Internal parser's state may be invalid at this time. Re-append last InitSegment to workaround.\r\n                // Related issue: https://bugs.webkit.org/show_bug.cgi?id=159230\r\n                if (_browser2.default.safari) {\r\n                    var lastInitSegment = this._lastInitSegments[type];\r\n                    if (lastInitSegment) {\r\n                        this._pendingSegments[type].push(lastInitSegment);\r\n                        if (!sb.updating) {\r\n                            this._doAppendSegments();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: 'endOfStream',\r\n        value: function endOfStream() {\r\n            var ms = this._mediaSource;\r\n            var sb = this._sourceBuffers;\r\n            if (!ms || ms.readyState !== 'open') {\r\n                if (ms && ms.readyState === 'closed' && this._hasPendingSegments()) {\r\n                    // If MediaSource hasn't turned into open state, and there're pending segments\r\n                    // Mark pending endOfStream, defer call until all pending segments appended complete\r\n                    this._hasPendingEos = true;\r\n                }\r\n                return;\r\n            }\r\n            if (sb.video && sb.video.updating || sb.audio && sb.audio.updating) {\r\n                // If any sourcebuffer is updating, defer endOfStream operation\r\n                // See _onSourceBufferUpdateEnd()\r\n                this._hasPendingEos = true;\r\n            } else {\r\n                this._hasPendingEos = false;\r\n                // Notify media data loading complete\r\n                // This is helpful for correcting total duration to match last media segment\r\n                // Otherwise MediaElement's ended event may not be triggered\r\n                ms.endOfStream();\r\n            }\r\n        }\r\n    }, {\r\n        key: 'getNearestKeyframe',\r\n        value: function getNearestKeyframe(dts) {\r\n            return this._idrList.getLastSyncPointBeforeDts(dts);\r\n        }\r\n    }, {\r\n        key: '_needCleanupSourceBuffer',\r\n        value: function _needCleanupSourceBuffer() {\r\n            if (!this._config.autoCleanupSourceBuffer) {\r\n                return false;\r\n            }\r\n\r\n            var currentTime = this._mediaElement.currentTime;\r\n\r\n            for (var type in this._sourceBuffers) {\r\n                var sb = this._sourceBuffers[type];\r\n                if (sb) {\r\n                    var buffered = sb.buffered;\r\n                    if (buffered.length >= 1) {\r\n                        if (currentTime - buffered.start(0) >= this._config.autoCleanupMaxBackwardDuration) {\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            return false;\r\n        }\r\n    }, {\r\n        key: '_doCleanupSourceBuffer',\r\n        value: function _doCleanupSourceBuffer() {\r\n            var currentTime = this._mediaElement.currentTime;\r\n\r\n            for (var type in this._sourceBuffers) {\r\n                var sb = this._sourceBuffers[type];\r\n                if (sb) {\r\n                    var buffered = sb.buffered;\r\n                    var doRemove = false;\r\n\r\n                    for (var i = 0; i < buffered.length; i++) {\r\n                        var start = buffered.start(i);\r\n                        var end = buffered.end(i);\r\n\r\n                        if (start <= currentTime && currentTime < end + 3) {\r\n                            // padding 3 seconds\r\n                            if (currentTime - start >= this._config.autoCleanupMaxBackwardDuration) {\r\n                                doRemove = true;\r\n                                var removeEnd = currentTime - this._config.autoCleanupMinBackwardDuration;\r\n                                this._pendingRemoveRanges[type].push({ start: start, end: removeEnd });\r\n                            }\r\n                        } else if (end < currentTime) {\r\n                            doRemove = true;\r\n                            this._pendingRemoveRanges[type].push({ start: start, end: end });\r\n                        }\r\n                    }\r\n\r\n                    if (doRemove && !sb.updating) {\r\n                        this._doRemoveRanges();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_updateMediaSourceDuration',\r\n        value: function _updateMediaSourceDuration() {\r\n            var sb = this._sourceBuffers;\r\n            if (this._mediaElement.readyState === 0 || this._mediaSource.readyState !== 'open') {\r\n                return;\r\n            }\r\n            if (sb.video && sb.video.updating || sb.audio && sb.audio.updating) {\r\n                return;\r\n            }\r\n\r\n            var current = this._mediaSource.duration;\r\n            var target = this._pendingMediaDuration;\r\n\r\n            if (target > 0 && (isNaN(current) || target > current)) {\r\n                _logger2.default.v(this.TAG, 'Update MediaSource duration from ' + current + ' to ' + target);\r\n                this._mediaSource.duration = target;\r\n            }\r\n\r\n            this._requireSetMediaDuration = false;\r\n            this._pendingMediaDuration = 0;\r\n        }\r\n    }, {\r\n        key: '_doRemoveRanges',\r\n        value: function _doRemoveRanges() {\r\n            for (var type in this._pendingRemoveRanges) {\r\n                if (!this._sourceBuffers[type] || this._sourceBuffers[type].updating) {\r\n                    continue;\r\n                }\r\n                var sb = this._sourceBuffers[type];\r\n                var ranges = this._pendingRemoveRanges[type];\r\n                while (ranges.length && !sb.updating) {\r\n                    var range = ranges.shift();\r\n                    sb.remove(range.start, range.end);\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_doAppendSegments',\r\n        value: function _doAppendSegments() {\r\n            var pendingSegments = this._pendingSegments;\r\n\r\n            for (var type in pendingSegments) {\r\n                if (!this._sourceBuffers[type] || this._sourceBuffers[type].updating) {\r\n                    continue;\r\n                }\r\n\r\n                if (pendingSegments[type].length > 0) {\r\n                    var segment = pendingSegments[type].shift();\r\n\r\n                    if (segment.timestampOffset) {\r\n                        // For MPEG audio stream in MSE, if unbuffered-seeking occurred\r\n                        // We need explicitly set timestampOffset to the desired point in timeline for mpeg SourceBuffer.\r\n                        var currentOffset = this._sourceBuffers[type].timestampOffset;\r\n                        var targetOffset = segment.timestampOffset / 1000; // in seconds\r\n\r\n                        var delta = Math.abs(currentOffset - targetOffset);\r\n                        if (delta > 0.1) {\r\n                            // If time delta > 100ms\r\n                            _logger2.default.v(this.TAG, 'Update MPEG audio timestampOffset from ' + currentOffset + ' to ' + targetOffset);\r\n                            this._sourceBuffers[type].timestampOffset = targetOffset;\r\n                        }\r\n                        delete segment.timestampOffset;\r\n                    }\r\n\r\n                    if (!segment.data || segment.data.byteLength === 0) {\r\n                        // Ignore empty buffer\r\n                        continue;\r\n                    }\r\n\r\n                    try {\r\n                        this._sourceBuffers[type].appendBuffer(segment.data);\r\n                        this._isBufferFull = false;\r\n                        if (type === 'video' && segment.hasOwnProperty('info')) {\r\n                            this._idrList.appendArray(segment.info.syncPoints);\r\n                        }\r\n                    } catch (error) {\r\n                        this._pendingSegments[type].unshift(segment);\r\n                        if (error.code === 22) {\r\n                            // QuotaExceededError\r\n                            /* Notice that FireFox may not throw QuotaExceededError if SourceBuffer is full\r\n                             * Currently we can only do lazy-load to avoid SourceBuffer become scattered.\r\n                             * SourceBuffer eviction policy may be changed in future version of FireFox.\r\n                             *\r\n                             * Related issues:\r\n                             * https://bugzilla.mozilla.org/show_bug.cgi?id=1279885\r\n                             * https://bugzilla.mozilla.org/show_bug.cgi?id=1280023\r\n                             */\r\n\r\n                            // report buffer full, abort network IO\r\n                            if (!this._isBufferFull) {\r\n                                this._emitter.emit(_mseEvents2.default.BUFFER_FULL);\r\n                            }\r\n                            this._isBufferFull = true;\r\n                        } else {\r\n                            _logger2.default.e(this.TAG, error.message);\r\n                            this._emitter.emit(_mseEvents2.default.ERROR, { code: error.code, msg: error.message });\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onSourceOpen',\r\n        value: function _onSourceOpen() {\r\n            _logger2.default.v(this.TAG, 'MediaSource onSourceOpen');\r\n            this._mediaSource.removeEventListener('sourceopen', this.e.onSourceOpen);\r\n            // deferred sourcebuffer creation / initialization\r\n            if (this._pendingSourceBufferInit.length > 0) {\r\n                var pendings = this._pendingSourceBufferInit;\r\n                while (pendings.length) {\r\n                    var segment = pendings.shift();\r\n                    this.appendInitSegment(segment, true);\r\n                }\r\n            }\r\n            // there may be some pending media segments, append them\r\n            if (this._hasPendingSegments()) {\r\n                this._doAppendSegments();\r\n            }\r\n            this._emitter.emit(_mseEvents2.default.SOURCE_OPEN);\r\n        }\r\n    }, {\r\n        key: '_onSourceEnded',\r\n        value: function _onSourceEnded() {\r\n            // fired on endOfStream\r\n            _logger2.default.v(this.TAG, 'MediaSource onSourceEnded');\r\n        }\r\n    }, {\r\n        key: '_onSourceClose',\r\n        value: function _onSourceClose() {\r\n            // fired on detaching from media element\r\n            _logger2.default.v(this.TAG, 'MediaSource onSourceClose');\r\n            if (this._mediaSource && this.e != null) {\r\n                this._mediaSource.removeEventListener('sourceopen', this.e.onSourceOpen);\r\n                this._mediaSource.removeEventListener('sourceended', this.e.onSourceEnded);\r\n                this._mediaSource.removeEventListener('sourceclose', this.e.onSourceClose);\r\n            }\r\n        }\r\n    }, {\r\n        key: '_hasPendingSegments',\r\n        value: function _hasPendingSegments() {\r\n            var ps = this._pendingSegments;\r\n            return ps.video.length > 0 || ps.audio.length > 0;\r\n        }\r\n    }, {\r\n        key: '_hasPendingRemoveRanges',\r\n        value: function _hasPendingRemoveRanges() {\r\n            var prr = this._pendingRemoveRanges;\r\n            return prr.video.length > 0 || prr.audio.length > 0;\r\n        }\r\n    }, {\r\n        key: '_onSourceBufferUpdateEnd',\r\n        value: function _onSourceBufferUpdateEnd() {\r\n            if (this._requireSetMediaDuration) {\r\n                this._updateMediaSourceDuration();\r\n            } else if (this._hasPendingRemoveRanges()) {\r\n                this._doRemoveRanges();\r\n            } else if (this._hasPendingSegments()) {\r\n                this._doAppendSegments();\r\n            } else if (this._hasPendingEos) {\r\n                this.endOfStream();\r\n            }\r\n            this._emitter.emit(_mseEvents2.default.UPDATE_END);\r\n        }\r\n    }, {\r\n        key: '_onSourceBufferError',\r\n        value: function _onSourceBufferError(e) {\r\n            _logger2.default.e(this.TAG, 'SourceBuffer Error: ' + e);\r\n            // this error might not always be fatal, just ignore it\r\n        }\r\n    }]);\r\n\r\n    return MSEController;\r\n}();\r\n\r\nexports.default = MSEController;\r\n\r\n},{\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./media-segment-info.js\":8,\"./mse-events.js\":10,\"events\":2}],10:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n  value: true\r\n});\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nvar MSEEvents = {\r\n  ERROR: 'error',\r\n  SOURCE_OPEN: 'source_open',\r\n  UPDATE_END: 'update_end',\r\n  BUFFER_FULL: 'buffer_full'\r\n};\r\n\r\nexports.default = MSEEvents;\r\n\r\n},{}],11:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _events = _dereq_('events');\r\n\r\nvar _events2 = _interopRequireDefault(_events);\r\n\r\nvar _logger = _dereq_('../utils/logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nvar _loggingControl = _dereq_('../utils/logging-control.js');\r\n\r\nvar _loggingControl2 = _interopRequireDefault(_loggingControl);\r\n\r\nvar _transmuxingController = _dereq_('./transmuxing-controller.js');\r\n\r\nvar _transmuxingController2 = _interopRequireDefault(_transmuxingController);\r\n\r\nvar _transmuxingEvents = _dereq_('./transmuxing-events.js');\r\n\r\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\r\n\r\nvar _transmuxingWorker = _dereq_('./transmuxing-worker.js');\r\n\r\nvar _transmuxingWorker2 = _interopRequireDefault(_transmuxingWorker);\r\n\r\nvar _mediaInfo = _dereq_('./media-info.js');\r\n\r\nvar _mediaInfo2 = _interopRequireDefault(_mediaInfo);\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nvar Transmuxer = function () {\r\n    function Transmuxer(mediaDataSource, config) {\r\n        _classCallCheck(this, Transmuxer);\r\n\r\n        this.TAG = 'Transmuxer';\r\n        this._emitter = new _events2.default();\r\n\r\n        if (config.enableWorker && typeof Worker !== 'undefined') {\r\n            try {\r\n                var work = _dereq_('webworkify');\r\n                this._worker = work(_transmuxingWorker2.default);\r\n                this._workerDestroying = false;\r\n                this._worker.addEventListener('message', this._onWorkerMessage.bind(this));\r\n                this._worker.postMessage({ cmd: 'init', param: [mediaDataSource, config] });\r\n                this.e = {\r\n                    onLoggingConfigChanged: this._onLoggingConfigChanged.bind(this)\r\n                };\r\n                _loggingControl2.default.registerListener(this.e.onLoggingConfigChanged);\r\n                this._worker.postMessage({ cmd: 'logging_config', param: _loggingControl2.default.getConfig() });\r\n            } catch (error) {\r\n                _logger2.default.e(this.TAG, 'Error while initialize transmuxing worker, fallback to inline transmuxing');\r\n                this._worker = null;\r\n                this._controller = new _transmuxingController2.default(mediaDataSource, config);\r\n            }\r\n        } else {\r\n            this._controller = new _transmuxingController2.default(mediaDataSource, config);\r\n        }\r\n\r\n        if (this._controller) {\r\n            var ctl = this._controller;\r\n            ctl.on(_transmuxingEvents2.default.IO_ERROR, this._onIOError.bind(this));\r\n            ctl.on(_transmuxingEvents2.default.DEMUX_ERROR, this._onDemuxError.bind(this));\r\n            ctl.on(_transmuxingEvents2.default.INIT_SEGMENT, this._onInitSegment.bind(this));\r\n            ctl.on(_transmuxingEvents2.default.MEDIA_SEGMENT, this._onMediaSegment.bind(this));\r\n            ctl.on(_transmuxingEvents2.default.LOADING_COMPLETE, this._onLoadingComplete.bind(this));\r\n            ctl.on(_transmuxingEvents2.default.RECOVERED_EARLY_EOF, this._onRecoveredEarlyEof.bind(this));\r\n            ctl.on(_transmuxingEvents2.default.MEDIA_INFO, this._onMediaInfo.bind(this));\r\n            ctl.on(_transmuxingEvents2.default.STATISTICS_INFO, this._onStatisticsInfo.bind(this));\r\n            ctl.on(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, this._onRecommendSeekpoint.bind(this));\r\n        }\r\n    }\r\n\r\n    _createClass(Transmuxer, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            if (this._worker) {\r\n                if (!this._workerDestroying) {\r\n                    this._workerDestroying = true;\r\n                    this._worker.postMessage({ cmd: 'destroy' });\r\n                    _loggingControl2.default.removeListener(this.e.onLoggingConfigChanged);\r\n                    this.e = null;\r\n                }\r\n            } else {\r\n                this._controller.destroy();\r\n                this._controller = null;\r\n            }\r\n            this._emitter.removeAllListeners();\r\n            this._emitter = null;\r\n        }\r\n    }, {\r\n        key: 'on',\r\n        value: function on(event, listener) {\r\n            this._emitter.addListener(event, listener);\r\n        }\r\n    }, {\r\n        key: 'off',\r\n        value: function off(event, listener) {\r\n            this._emitter.removeListener(event, listener);\r\n        }\r\n    }, {\r\n        key: 'hasWorker',\r\n        value: function hasWorker() {\r\n            return this._worker != null;\r\n        }\r\n    }, {\r\n        key: 'open',\r\n        value: function open() {\r\n            if (this._worker) {\r\n                this._worker.postMessage({ cmd: 'start' });\r\n            } else {\r\n                this._controller.start();\r\n            }\r\n        }\r\n    }, {\r\n        key: 'close',\r\n        value: function close() {\r\n            if (this._worker) {\r\n                this._worker.postMessage({ cmd: 'stop' });\r\n            } else {\r\n                this._controller.stop();\r\n            }\r\n        }\r\n    }, {\r\n        key: 'seek',\r\n        value: function seek(milliseconds) {\r\n            if (this._worker) {\r\n                this._worker.postMessage({ cmd: 'seek', param: milliseconds });\r\n            } else {\r\n                this._controller.seek(milliseconds);\r\n            }\r\n        }\r\n    }, {\r\n        key: 'pause',\r\n        value: function pause() {\r\n            if (this._worker) {\r\n                this._worker.postMessage({ cmd: 'pause' });\r\n            } else {\r\n                this._controller.pause();\r\n            }\r\n        }\r\n    }, {\r\n        key: 'resume',\r\n        value: function resume() {\r\n            if (this._worker) {\r\n                this._worker.postMessage({ cmd: 'resume' });\r\n            } else {\r\n                this._controller.resume();\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onInitSegment',\r\n        value: function _onInitSegment(type, initSegment) {\r\n            var _this = this;\r\n\r\n            // do async invoke\r\n            Promise.resolve().then(function () {\r\n                _this._emitter.emit(_transmuxingEvents2.default.INIT_SEGMENT, type, initSegment);\r\n            });\r\n        }\r\n    }, {\r\n        key: '_onMediaSegment',\r\n        value: function _onMediaSegment(type, mediaSegment) {\r\n            var _this2 = this;\r\n\r\n            Promise.resolve().then(function () {\r\n                _this2._emitter.emit(_transmuxingEvents2.default.MEDIA_SEGMENT, type, mediaSegment);\r\n            });\r\n        }\r\n    }, {\r\n        key: '_onLoadingComplete',\r\n        value: function _onLoadingComplete() {\r\n            var _this3 = this;\r\n\r\n            Promise.resolve().then(function () {\r\n                _this3._emitter.emit(_transmuxingEvents2.default.LOADING_COMPLETE);\r\n            });\r\n        }\r\n    }, {\r\n        key: '_onRecoveredEarlyEof',\r\n        value: function _onRecoveredEarlyEof() {\r\n            var _this4 = this;\r\n\r\n            Promise.resolve().then(function () {\r\n                _this4._emitter.emit(_transmuxingEvents2.default.RECOVERED_EARLY_EOF);\r\n            });\r\n        }\r\n    }, {\r\n        key: '_onMediaInfo',\r\n        value: function _onMediaInfo(mediaInfo) {\r\n            var _this5 = this;\r\n\r\n            Promise.resolve().then(function () {\r\n                _this5._emitter.emit(_transmuxingEvents2.default.MEDIA_INFO, mediaInfo);\r\n            });\r\n        }\r\n    }, {\r\n        key: '_onStatisticsInfo',\r\n        value: function _onStatisticsInfo(statisticsInfo) {\r\n            var _this6 = this;\r\n\r\n            Promise.resolve().then(function () {\r\n                _this6._emitter.emit(_transmuxingEvents2.default.STATISTICS_INFO, statisticsInfo);\r\n            });\r\n        }\r\n    }, {\r\n        key: '_onIOError',\r\n        value: function _onIOError(type, info) {\r\n            var _this7 = this;\r\n\r\n            Promise.resolve().then(function () {\r\n                _this7._emitter.emit(_transmuxingEvents2.default.IO_ERROR, type, info);\r\n            });\r\n        }\r\n    }, {\r\n        key: '_onDemuxError',\r\n        value: function _onDemuxError(type, info) {\r\n            var _this8 = this;\r\n\r\n            Promise.resolve().then(function () {\r\n                _this8._emitter.emit(_transmuxingEvents2.default.DEMUX_ERROR, type, info);\r\n            });\r\n        }\r\n    }, {\r\n        key: '_onRecommendSeekpoint',\r\n        value: function _onRecommendSeekpoint(milliseconds) {\r\n            var _this9 = this;\r\n\r\n            Promise.resolve().then(function () {\r\n                _this9._emitter.emit(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, milliseconds);\r\n            });\r\n        }\r\n    }, {\r\n        key: '_onLoggingConfigChanged',\r\n        value: function _onLoggingConfigChanged(config) {\r\n            if (this._worker) {\r\n                this._worker.postMessage({ cmd: 'logging_config', param: config });\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onWorkerMessage',\r\n        value: function _onWorkerMessage(e) {\r\n            var message = e.data;\r\n            var data = message.data;\r\n\r\n            if (message.msg === 'destroyed' || this._workerDestroying) {\r\n                this._workerDestroying = false;\r\n                this._worker.terminate();\r\n                this._worker = null;\r\n                return;\r\n            }\r\n\r\n            switch (message.msg) {\r\n                case _transmuxingEvents2.default.INIT_SEGMENT:\r\n                case _transmuxingEvents2.default.MEDIA_SEGMENT:\r\n                    this._emitter.emit(message.msg, data.type, data.data);\r\n                    break;\r\n                case _transmuxingEvents2.default.LOADING_COMPLETE:\r\n                case _transmuxingEvents2.default.RECOVERED_EARLY_EOF:\r\n                    this._emitter.emit(message.msg);\r\n                    break;\r\n                case _transmuxingEvents2.default.MEDIA_INFO:\r\n                    Object.setPrototypeOf(data, _mediaInfo2.default.prototype);\r\n                    this._emitter.emit(message.msg, data);\r\n                    break;\r\n                case _transmuxingEvents2.default.STATISTICS_INFO:\r\n                    this._emitter.emit(message.msg, data);\r\n                    break;\r\n                case _transmuxingEvents2.default.IO_ERROR:\r\n                case _transmuxingEvents2.default.DEMUX_ERROR:\r\n                    this._emitter.emit(message.msg, data.type, data.info);\r\n                    break;\r\n                case _transmuxingEvents2.default.RECOMMEND_SEEKPOINT:\r\n                    this._emitter.emit(message.msg, data);\r\n                    break;\r\n                case 'logcat_callback':\r\n                    _logger2.default.emitter.emit('log', data.type, data.logcat);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    }]);\r\n\r\n    return Transmuxer;\r\n}();\r\n\r\nexports.default = Transmuxer;\r\n\r\n},{\"../utils/logger.js\":41,\"../utils/logging-control.js\":42,\"./media-info.js\":7,\"./transmuxing-controller.js\":12,\"./transmuxing-events.js\":13,\"./transmuxing-worker.js\":14,\"events\":2,\"webworkify\":4}],12:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _events = _dereq_('events');\r\n\r\nvar _events2 = _interopRequireDefault(_events);\r\n\r\nvar _logger = _dereq_('../utils/logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nvar _browser = _dereq_('../utils/browser.js');\r\n\r\nvar _browser2 = _interopRequireDefault(_browser);\r\n\r\nvar _mediaInfo = _dereq_('./media-info.js');\r\n\r\nvar _mediaInfo2 = _interopRequireDefault(_mediaInfo);\r\n\r\nvar _flvDemuxer = _dereq_('../demux/flv-demuxer.js');\r\n\r\nvar _flvDemuxer2 = _interopRequireDefault(_flvDemuxer);\r\n\r\nvar _mp4Remuxer = _dereq_('../remux/mp4-remuxer.js');\r\n\r\nvar _mp4Remuxer2 = _interopRequireDefault(_mp4Remuxer);\r\n\r\nvar _demuxErrors = _dereq_('../demux/demux-errors.js');\r\n\r\nvar _demuxErrors2 = _interopRequireDefault(_demuxErrors);\r\n\r\nvar _ioController = _dereq_('../io/io-controller.js');\r\n\r\nvar _ioController2 = _interopRequireDefault(_ioController);\r\n\r\nvar _transmuxingEvents = _dereq_('./transmuxing-events.js');\r\n\r\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\r\n\r\nvar _loader = _dereq_('../io/loader.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n// Transmuxing (IO, Demuxing, Remuxing) controller, with multipart support\r\nvar TransmuxingController = function () {\r\n    function TransmuxingController(mediaDataSource, config) {\r\n        _classCallCheck(this, TransmuxingController);\r\n\r\n        this.TAG = 'TransmuxingController';\r\n        this._emitter = new _events2.default();\r\n\r\n        this._config = config;\r\n\r\n        // treat single part media as multipart media, which has only one segment\r\n        if (!mediaDataSource.segments) {\r\n            mediaDataSource.segments = [{\r\n                duration: mediaDataSource.duration,\r\n                filesize: mediaDataSource.filesize,\r\n                url: mediaDataSource.url\r\n            }];\r\n        }\r\n\r\n        // fill in default IO params if not exists\r\n        if (typeof mediaDataSource.cors !== 'boolean') {\r\n            mediaDataSource.cors = true;\r\n        }\r\n        if (typeof mediaDataSource.withCredentials !== 'boolean') {\r\n            mediaDataSource.withCredentials = false;\r\n        }\r\n\r\n        this._mediaDataSource = mediaDataSource;\r\n        this._currentSegmentIndex = 0;\r\n        var totalDuration = 0;\r\n\r\n        this._mediaDataSource.segments.forEach(function (segment) {\r\n            // timestampBase for each segment, and calculate total duration\r\n            segment.timestampBase = totalDuration;\r\n            totalDuration += segment.duration;\r\n            // params needed by IOController\r\n            segment.cors = mediaDataSource.cors;\r\n            segment.withCredentials = mediaDataSource.withCredentials;\r\n            // referrer policy control, if exist\r\n            if (config.referrerPolicy) {\r\n                segment.referrerPolicy = config.referrerPolicy;\r\n            }\r\n        });\r\n\r\n        if (!isNaN(totalDuration) && this._mediaDataSource.duration !== totalDuration) {\r\n            this._mediaDataSource.duration = totalDuration;\r\n        }\r\n\r\n        this._mediaInfo = null;\r\n        this._demuxer = null;\r\n        this._remuxer = null;\r\n        this._ioctl = null;\r\n\r\n        this._pendingSeekTime = null;\r\n        this._pendingResolveSeekPoint = null;\r\n\r\n        this._statisticsReporter = null;\r\n    }\r\n\r\n    _createClass(TransmuxingController, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            this._mediaInfo = null;\r\n            this._mediaDataSource = null;\r\n\r\n            if (this._statisticsReporter) {\r\n                this._disableStatisticsReporter();\r\n            }\r\n            if (this._ioctl) {\r\n                this._ioctl.destroy();\r\n                this._ioctl = null;\r\n            }\r\n            if (this._demuxer) {\r\n                this._demuxer.destroy();\r\n                this._demuxer = null;\r\n            }\r\n            if (this._remuxer) {\r\n                this._remuxer.destroy();\r\n                this._remuxer = null;\r\n            }\r\n\r\n            this._emitter.removeAllListeners();\r\n            this._emitter = null;\r\n        }\r\n    }, {\r\n        key: 'on',\r\n        value: function on(event, listener) {\r\n            this._emitter.addListener(event, listener);\r\n        }\r\n    }, {\r\n        key: 'off',\r\n        value: function off(event, listener) {\r\n            this._emitter.removeListener(event, listener);\r\n        }\r\n    }, {\r\n        key: 'start',\r\n        value: function start() {\r\n            this._loadSegment(0);\r\n            this._enableStatisticsReporter();\r\n        }\r\n    }, {\r\n        key: '_loadSegment',\r\n        value: function _loadSegment(segmentIndex, optionalFrom) {\r\n            this._currentSegmentIndex = segmentIndex;\r\n            var dataSource = this._mediaDataSource.segments[segmentIndex];\r\n\r\n            var ioctl = this._ioctl = new _ioController2.default(dataSource, this._config, segmentIndex);\r\n            ioctl.onError = this._onIOException.bind(this);\r\n            ioctl.onSeeked = this._onIOSeeked.bind(this);\r\n            ioctl.onComplete = this._onIOComplete.bind(this);\r\n            ioctl.onRedirect = this._onIORedirect.bind(this);\r\n            ioctl.onRecoveredEarlyEof = this._onIORecoveredEarlyEof.bind(this);\r\n\r\n            if (optionalFrom) {\r\n                this._demuxer.bindDataSource(this._ioctl);\r\n            } else {\r\n                ioctl.onDataArrival = this._onInitChunkArrival.bind(this);\r\n            }\r\n\r\n            ioctl.open(optionalFrom);\r\n        }\r\n    }, {\r\n        key: 'stop',\r\n        value: function stop() {\r\n            this._internalAbort();\r\n            this._disableStatisticsReporter();\r\n        }\r\n    }, {\r\n        key: '_internalAbort',\r\n        value: function _internalAbort() {\r\n            if (this._ioctl) {\r\n                this._ioctl.destroy();\r\n                this._ioctl = null;\r\n            }\r\n        }\r\n    }, {\r\n        key: 'pause',\r\n        value: function pause() {\r\n            // take a rest\r\n            if (this._ioctl && this._ioctl.isWorking()) {\r\n                this._ioctl.pause();\r\n                this._disableStatisticsReporter();\r\n            }\r\n        }\r\n    }, {\r\n        key: 'resume',\r\n        value: function resume() {\r\n            if (this._ioctl && this._ioctl.isPaused()) {\r\n                this._ioctl.resume();\r\n                this._enableStatisticsReporter();\r\n            }\r\n        }\r\n    }, {\r\n        key: 'seek',\r\n        value: function seek(milliseconds) {\r\n            if (this._mediaInfo == null || !this._mediaInfo.isSeekable()) {\r\n                return;\r\n            }\r\n\r\n            var targetSegmentIndex = this._searchSegmentIndexContains(milliseconds);\r\n\r\n            if (targetSegmentIndex === this._currentSegmentIndex) {\r\n                // intra-segment seeking\r\n                var segmentInfo = this._mediaInfo.segments[targetSegmentIndex];\r\n\r\n                if (segmentInfo == undefined) {\r\n                    // current segment loading started, but mediainfo hasn't received yet\r\n                    // wait for the metadata loaded, then seek to expected position\r\n                    this._pendingSeekTime = milliseconds;\r\n                } else {\r\n                    var keyframe = segmentInfo.getNearestKeyframe(milliseconds);\r\n                    this._remuxer.seek(keyframe.milliseconds);\r\n                    this._ioctl.seek(keyframe.fileposition);\r\n                    // Will be resolved in _onRemuxerMediaSegmentArrival()\r\n                    this._pendingResolveSeekPoint = keyframe.milliseconds;\r\n                }\r\n            } else {\r\n                // cross-segment seeking\r\n                var targetSegmentInfo = this._mediaInfo.segments[targetSegmentIndex];\r\n\r\n                if (targetSegmentInfo == undefined) {\r\n                    // target segment hasn't been loaded. We need metadata then seek to expected time\r\n                    this._pendingSeekTime = milliseconds;\r\n                    this._internalAbort();\r\n                    this._remuxer.seek();\r\n                    this._remuxer.insertDiscontinuity();\r\n                    this._loadSegment(targetSegmentIndex);\r\n                    // Here we wait for the metadata loaded, then seek to expected position\r\n                } else {\r\n                    // We have target segment's metadata, direct seek to target position\r\n                    var _keyframe = targetSegmentInfo.getNearestKeyframe(milliseconds);\r\n                    this._internalAbort();\r\n                    this._remuxer.seek(milliseconds);\r\n                    this._remuxer.insertDiscontinuity();\r\n                    this._demuxer.resetMediaInfo();\r\n                    this._demuxer.timestampBase = this._mediaDataSource.segments[targetSegmentIndex].timestampBase;\r\n                    this._loadSegment(targetSegmentIndex, _keyframe.fileposition);\r\n                    this._pendingResolveSeekPoint = _keyframe.milliseconds;\r\n                    this._reportSegmentMediaInfo(targetSegmentIndex);\r\n                }\r\n            }\r\n\r\n            this._enableStatisticsReporter();\r\n        }\r\n    }, {\r\n        key: '_searchSegmentIndexContains',\r\n        value: function _searchSegmentIndexContains(milliseconds) {\r\n            var segments = this._mediaDataSource.segments;\r\n            var idx = segments.length - 1;\r\n\r\n            for (var i = 0; i < segments.length; i++) {\r\n                if (milliseconds < segments[i].timestampBase) {\r\n                    idx = i - 1;\r\n                    break;\r\n                }\r\n            }\r\n            return idx;\r\n        }\r\n    }, {\r\n        key: '_onInitChunkArrival',\r\n        value: function _onInitChunkArrival(data, byteStart) {\r\n            var _this = this;\r\n\r\n            var probeData = null;\r\n            var consumed = 0;\r\n\r\n            if (byteStart > 0) {\r\n                // IOController seeked immediately after opened, byteStart > 0 callback may received\r\n                this._demuxer.bindDataSource(this._ioctl);\r\n                this._demuxer.timestampBase = this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase;\r\n\r\n                consumed = this._demuxer.parseChunks(data, byteStart);\r\n            } else if ((probeData = _flvDemuxer2.default.probe(data)).match) {\r\n                // Always create new FLVDemuxer\r\n                this._demuxer = new _flvDemuxer2.default(probeData, this._config);\r\n\r\n                if (!this._remuxer) {\r\n                    this._remuxer = new _mp4Remuxer2.default(this._config);\r\n                }\r\n\r\n                var mds = this._mediaDataSource;\r\n                if (mds.duration != undefined && !isNaN(mds.duration)) {\r\n                    this._demuxer.overridedDuration = mds.duration;\r\n                }\r\n                if (typeof mds.hasAudio === 'boolean') {\r\n                    this._demuxer.overridedHasAudio = mds.hasAudio;\r\n                }\r\n                if (typeof mds.hasVideo === 'boolean') {\r\n                    this._demuxer.overridedHasVideo = mds.hasVideo;\r\n                }\r\n\r\n                this._demuxer.timestampBase = mds.segments[this._currentSegmentIndex].timestampBase;\r\n\r\n                this._demuxer.onError = this._onDemuxException.bind(this);\r\n                this._demuxer.onMediaInfo = this._onMediaInfo.bind(this);\r\n\r\n                this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl));\r\n\r\n                this._remuxer.onInitSegment = this._onRemuxerInitSegmentArrival.bind(this);\r\n                this._remuxer.onMediaSegment = this._onRemuxerMediaSegmentArrival.bind(this);\r\n\r\n                consumed = this._demuxer.parseChunks(data, byteStart);\r\n            } else {\r\n                probeData = null;\r\n                _logger2.default.e(this.TAG, 'Non-FLV, Unsupported media type!');\r\n                Promise.resolve().then(function () {\r\n                    _this._internalAbort();\r\n                });\r\n                this._emitter.emit(_transmuxingEvents2.default.DEMUX_ERROR, _demuxErrors2.default.FORMAT_UNSUPPORTED, 'Non-FLV, Unsupported media type');\r\n\r\n                consumed = 0;\r\n            }\r\n\r\n            return consumed;\r\n        }\r\n    }, {\r\n        key: '_onMediaInfo',\r\n        value: function _onMediaInfo(mediaInfo) {\r\n            var _this2 = this;\r\n\r\n            if (this._mediaInfo == null) {\r\n                // Store first segment's mediainfo as global mediaInfo\r\n                this._mediaInfo = Object.assign({}, mediaInfo);\r\n                this._mediaInfo.keyframesIndex = null;\r\n                this._mediaInfo.segments = [];\r\n                this._mediaInfo.segmentCount = this._mediaDataSource.segments.length;\r\n                Object.setPrototypeOf(this._mediaInfo, _mediaInfo2.default.prototype);\r\n            }\r\n\r\n            var segmentInfo = Object.assign({}, mediaInfo);\r\n            Object.setPrototypeOf(segmentInfo, _mediaInfo2.default.prototype);\r\n            this._mediaInfo.segments[this._currentSegmentIndex] = segmentInfo;\r\n\r\n            // notify mediaInfo update\r\n            this._reportSegmentMediaInfo(this._currentSegmentIndex);\r\n\r\n            if (this._pendingSeekTime != null) {\r\n                Promise.resolve().then(function () {\r\n                    var target = _this2._pendingSeekTime;\r\n                    _this2._pendingSeekTime = null;\r\n                    _this2.seek(target);\r\n                });\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onIOSeeked',\r\n        value: function _onIOSeeked() {\r\n            this._remuxer.insertDiscontinuity();\r\n        }\r\n    }, {\r\n        key: '_onIOComplete',\r\n        value: function _onIOComplete(extraData) {\r\n            var segmentIndex = extraData;\r\n            var nextSegmentIndex = segmentIndex + 1;\r\n\r\n            if (nextSegmentIndex < this._mediaDataSource.segments.length) {\r\n                this._internalAbort();\r\n                this._loadSegment(nextSegmentIndex);\r\n            } else {\r\n                this._emitter.emit(_transmuxingEvents2.default.LOADING_COMPLETE);\r\n                this._disableStatisticsReporter();\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onIORedirect',\r\n        value: function _onIORedirect(redirectedURL) {\r\n            var segmentIndex = this._ioctl.extraData;\r\n            this._mediaDataSource.segments[segmentIndex].redirectedURL = redirectedURL;\r\n        }\r\n    }, {\r\n        key: '_onIORecoveredEarlyEof',\r\n        value: function _onIORecoveredEarlyEof() {\r\n            this._emitter.emit(_transmuxingEvents2.default.RECOVERED_EARLY_EOF);\r\n        }\r\n    }, {\r\n        key: '_onIOException',\r\n        value: function _onIOException(type, info) {\r\n            _logger2.default.e(this.TAG, 'IOException: type = ' + type + ', code = ' + info.code + ', msg = ' + info.msg);\r\n            this._emitter.emit(_transmuxingEvents2.default.IO_ERROR, type, info);\r\n            this._disableStatisticsReporter();\r\n        }\r\n    }, {\r\n        key: '_onDemuxException',\r\n        value: function _onDemuxException(type, info) {\r\n            _logger2.default.e(this.TAG, 'DemuxException: type = ' + type + ', info = ' + info);\r\n            this._emitter.emit(_transmuxingEvents2.default.DEMUX_ERROR, type, info);\r\n        }\r\n    }, {\r\n        key: '_onRemuxerInitSegmentArrival',\r\n        value: function _onRemuxerInitSegmentArrival(type, initSegment) {\r\n            this._emitter.emit(_transmuxingEvents2.default.INIT_SEGMENT, type, initSegment);\r\n        }\r\n    }, {\r\n        key: '_onRemuxerMediaSegmentArrival',\r\n        value: function _onRemuxerMediaSegmentArrival(type, mediaSegment) {\r\n            if (this._pendingSeekTime != null) {\r\n                // Media segments after new-segment cross-seeking should be dropped.\r\n                return;\r\n            }\r\n            this._emitter.emit(_transmuxingEvents2.default.MEDIA_SEGMENT, type, mediaSegment);\r\n\r\n            // Resolve pending seekPoint\r\n            if (this._pendingResolveSeekPoint != null && type === 'video') {\r\n                var syncPoints = mediaSegment.info.syncPoints;\r\n                var seekpoint = this._pendingResolveSeekPoint;\r\n                this._pendingResolveSeekPoint = null;\r\n\r\n                // Safari: Pass PTS for recommend_seekpoint\r\n                if (_browser2.default.safari && syncPoints.length > 0 && syncPoints[0].originalDts === seekpoint) {\r\n                    seekpoint = syncPoints[0].pts;\r\n                }\r\n                // else: use original DTS (keyframe.milliseconds)\r\n\r\n                this._emitter.emit(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, seekpoint);\r\n            }\r\n        }\r\n    }, {\r\n        key: '_enableStatisticsReporter',\r\n        value: function _enableStatisticsReporter() {\r\n            if (this._statisticsReporter == null) {\r\n                this._statisticsReporter = self.setInterval(this._reportStatisticsInfo.bind(this), this._config.statisticsInfoReportInterval);\r\n            }\r\n        }\r\n    }, {\r\n        key: '_disableStatisticsReporter',\r\n        value: function _disableStatisticsReporter() {\r\n            if (this._statisticsReporter) {\r\n                self.clearInterval(this._statisticsReporter);\r\n                this._statisticsReporter = null;\r\n            }\r\n        }\r\n    }, {\r\n        key: '_reportSegmentMediaInfo',\r\n        value: function _reportSegmentMediaInfo(segmentIndex) {\r\n            var segmentInfo = this._mediaInfo.segments[segmentIndex];\r\n            var exportInfo = Object.assign({}, segmentInfo);\r\n\r\n            exportInfo.duration = this._mediaInfo.duration;\r\n            exportInfo.segmentCount = this._mediaInfo.segmentCount;\r\n            delete exportInfo.segments;\r\n            delete exportInfo.keyframesIndex;\r\n\r\n            this._emitter.emit(_transmuxingEvents2.default.MEDIA_INFO, exportInfo);\r\n        }\r\n    }, {\r\n        key: '_reportStatisticsInfo',\r\n        value: function _reportStatisticsInfo() {\r\n            var info = {};\r\n\r\n            info.url = this._ioctl.currentURL;\r\n            info.hasRedirect = this._ioctl.hasRedirect;\r\n            if (info.hasRedirect) {\r\n                info.redirectedURL = this._ioctl.currentRedirectedURL;\r\n            }\r\n\r\n            info.speed = this._ioctl.currentSpeed;\r\n            info.loaderType = this._ioctl.loaderType;\r\n            info.currentSegmentIndex = this._currentSegmentIndex;\r\n            info.totalSegmentCount = this._mediaDataSource.segments.length;\r\n\r\n            this._emitter.emit(_transmuxingEvents2.default.STATISTICS_INFO, info);\r\n        }\r\n    }]);\r\n\r\n    return TransmuxingController;\r\n}();\r\n\r\nexports.default = TransmuxingController;\r\n\r\n},{\"../demux/demux-errors.js\":16,\"../demux/flv-demuxer.js\":18,\"../io/io-controller.js\":23,\"../io/loader.js\":24,\"../remux/mp4-remuxer.js\":38,\"../utils/browser.js\":39,\"../utils/logger.js\":41,\"./media-info.js\":7,\"./transmuxing-events.js\":13,\"events\":2}],13:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n  value: true\r\n});\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nvar TransmuxingEvents = {\r\n  IO_ERROR: 'io_error',\r\n  DEMUX_ERROR: 'demux_error',\r\n  INIT_SEGMENT: 'init_segment',\r\n  MEDIA_SEGMENT: 'media_segment',\r\n  LOADING_COMPLETE: 'loading_complete',\r\n  RECOVERED_EARLY_EOF: 'recovered_early_eof',\r\n  MEDIA_INFO: 'media_info',\r\n  STATISTICS_INFO: 'statistics_info',\r\n  RECOMMEND_SEEKPOINT: 'recommend_seekpoint'\r\n};\r\n\r\nexports.default = TransmuxingEvents;\r\n\r\n},{}],14:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _logger = _dereq_('../utils/logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nvar _loggingControl = _dereq_('../utils/logging-control.js');\r\n\r\nvar _loggingControl2 = _interopRequireDefault(_loggingControl);\r\n\r\nvar _polyfill = _dereq_('../utils/polyfill.js');\r\n\r\nvar _polyfill2 = _interopRequireDefault(_polyfill);\r\n\r\nvar _transmuxingController = _dereq_('./transmuxing-controller.js');\r\n\r\nvar _transmuxingController2 = _interopRequireDefault(_transmuxingController);\r\n\r\nvar _transmuxingEvents = _dereq_('./transmuxing-events.js');\r\n\r\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\n/* post message to worker:\r\n   data: {\r\n       cmd: string\r\n       param: any\r\n   }\r\n\r\n   receive message from worker:\r\n   data: {\r\n       msg: string,\r\n       data: any\r\n   }\r\n */\r\n\r\nvar TransmuxingWorker = function TransmuxingWorker(self) {\r\n\r\n    var TAG = 'TransmuxingWorker';\r\n    var controller = null;\r\n    var logcatListener = onLogcatCallback.bind(this);\r\n\r\n    _polyfill2.default.install();\r\n\r\n    self.addEventListener('message', function (e) {\r\n        switch (e.data.cmd) {\r\n            case 'init':\r\n                controller = new _transmuxingController2.default(e.data.param[0], e.data.param[1]);\r\n                controller.on(_transmuxingEvents2.default.IO_ERROR, onIOError.bind(this));\r\n                controller.on(_transmuxingEvents2.default.DEMUX_ERROR, onDemuxError.bind(this));\r\n                controller.on(_transmuxingEvents2.default.INIT_SEGMENT, onInitSegment.bind(this));\r\n                controller.on(_transmuxingEvents2.default.MEDIA_SEGMENT, onMediaSegment.bind(this));\r\n                controller.on(_transmuxingEvents2.default.LOADING_COMPLETE, onLoadingComplete.bind(this));\r\n                controller.on(_transmuxingEvents2.default.RECOVERED_EARLY_EOF, onRecoveredEarlyEof.bind(this));\r\n                controller.on(_transmuxingEvents2.default.MEDIA_INFO, onMediaInfo.bind(this));\r\n                controller.on(_transmuxingEvents2.default.STATISTICS_INFO, onStatisticsInfo.bind(this));\r\n                controller.on(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, onRecommendSeekpoint.bind(this));\r\n                break;\r\n            case 'destroy':\r\n                if (controller) {\r\n                    controller.destroy();\r\n                    controller = null;\r\n                }\r\n                self.postMessage({ msg: 'destroyed' });\r\n                break;\r\n            case 'start':\r\n                controller.start();\r\n                break;\r\n            case 'stop':\r\n                controller.stop();\r\n                break;\r\n            case 'seek':\r\n                controller.seek(e.data.param);\r\n                break;\r\n            case 'pause':\r\n                controller.pause();\r\n                break;\r\n            case 'resume':\r\n                controller.resume();\r\n                break;\r\n            case 'logging_config':\r\n                {\r\n                    var config = e.data.param;\r\n                    _loggingControl2.default.applyConfig(config);\r\n\r\n                    if (config.enableCallback === true) {\r\n                        _loggingControl2.default.addLogListener(logcatListener);\r\n                    } else {\r\n                        _loggingControl2.default.removeLogListener(logcatListener);\r\n                    }\r\n                    break;\r\n                }\r\n        }\r\n    });\r\n\r\n    function onInitSegment(type, initSegment) {\r\n        var obj = {\r\n            msg: _transmuxingEvents2.default.INIT_SEGMENT,\r\n            data: {\r\n                type: type,\r\n                data: initSegment\r\n            }\r\n        };\r\n        self.postMessage(obj, [initSegment.data]); // data: ArrayBuffer\r\n    }\r\n\r\n    function onMediaSegment(type, mediaSegment) {\r\n        var obj = {\r\n            msg: _transmuxingEvents2.default.MEDIA_SEGMENT,\r\n            data: {\r\n                type: type,\r\n                data: mediaSegment\r\n            }\r\n        };\r\n        self.postMessage(obj, [mediaSegment.data]); // data: ArrayBuffer\r\n    }\r\n\r\n    function onLoadingComplete() {\r\n        var obj = {\r\n            msg: _transmuxingEvents2.default.LOADING_COMPLETE\r\n        };\r\n        self.postMessage(obj);\r\n    }\r\n\r\n    function onRecoveredEarlyEof() {\r\n        var obj = {\r\n            msg: _transmuxingEvents2.default.RECOVERED_EARLY_EOF\r\n        };\r\n        self.postMessage(obj);\r\n    }\r\n\r\n    function onMediaInfo(mediaInfo) {\r\n        var obj = {\r\n            msg: _transmuxingEvents2.default.MEDIA_INFO,\r\n            data: mediaInfo\r\n        };\r\n        self.postMessage(obj);\r\n    }\r\n\r\n    function onStatisticsInfo(statInfo) {\r\n        var obj = {\r\n            msg: _transmuxingEvents2.default.STATISTICS_INFO,\r\n            data: statInfo\r\n        };\r\n        self.postMessage(obj);\r\n    }\r\n\r\n    function onIOError(type, info) {\r\n        self.postMessage({\r\n            msg: _transmuxingEvents2.default.IO_ERROR,\r\n            data: {\r\n                type: type,\r\n                info: info\r\n            }\r\n        });\r\n    }\r\n\r\n    function onDemuxError(type, info) {\r\n        self.postMessage({\r\n            msg: _transmuxingEvents2.default.DEMUX_ERROR,\r\n            data: {\r\n                type: type,\r\n                info: info\r\n            }\r\n        });\r\n    }\r\n\r\n    function onRecommendSeekpoint(milliseconds) {\r\n        self.postMessage({\r\n            msg: _transmuxingEvents2.default.RECOMMEND_SEEKPOINT,\r\n            data: milliseconds\r\n        });\r\n    }\r\n\r\n    function onLogcatCallback(type, str) {\r\n        self.postMessage({\r\n            msg: 'logcat_callback',\r\n            data: {\r\n                type: type,\r\n                logcat: str\r\n            }\r\n        });\r\n    }\r\n}; /*\r\n    * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n    *\r\n    * @author zheng qian <xqq@xqq.im>\r\n    *\r\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n    * you may not use this file except in compliance with the License.\r\n    * You may obtain a copy of the License at\r\n    *\r\n    *     http://www.apache.org/licenses/LICENSE-2.0\r\n    *\r\n    * Unless required by applicable law or agreed to in writing, software\r\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n    * See the License for the specific language governing permissions and\r\n    * limitations under the License.\r\n    */\r\n\r\nexports.default = TransmuxingWorker;\r\n\r\n},{\"../utils/logger.js\":41,\"../utils/logging-control.js\":42,\"../utils/polyfill.js\":43,\"./transmuxing-controller.js\":12,\"./transmuxing-events.js\":13}],15:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _logger = _dereq_('../utils/logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nvar _utf8Conv = _dereq_('../utils/utf8-conv.js');\r\n\r\nvar _utf8Conv2 = _interopRequireDefault(_utf8Conv);\r\n\r\nvar _exception = _dereq_('../utils/exception.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nvar le = function () {\r\n    var buf = new ArrayBuffer(2);\r\n    new DataView(buf).setInt16(0, 256, true); // little-endian write\r\n    return new Int16Array(buf)[0] === 256; // platform-spec read, if equal then LE\r\n}();\r\n\r\nvar AMF = function () {\r\n    function AMF() {\r\n        _classCallCheck(this, AMF);\r\n    }\r\n\r\n    _createClass(AMF, null, [{\r\n        key: 'parseScriptData',\r\n        value: function parseScriptData(arrayBuffer, dataOffset, dataSize) {\r\n            var data = {};\r\n\r\n            try {\r\n                var name = AMF.parseValue(arrayBuffer, dataOffset, dataSize);\r\n                var value = AMF.parseValue(arrayBuffer, dataOffset + name.size, dataSize - name.size);\r\n\r\n                data[name.data] = value.data;\r\n            } catch (e) {\r\n                _logger2.default.e('AMF', e.toString());\r\n            }\r\n\r\n            return data;\r\n        }\r\n    }, {\r\n        key: 'parseObject',\r\n        value: function parseObject(arrayBuffer, dataOffset, dataSize) {\r\n            if (dataSize < 3) {\r\n                throw new _exception.IllegalStateException('Data not enough when parse ScriptDataObject');\r\n            }\r\n            var name = AMF.parseString(arrayBuffer, dataOffset, dataSize);\r\n            var value = AMF.parseValue(arrayBuffer, dataOffset + name.size, dataSize - name.size);\r\n            var isObjectEnd = value.objectEnd;\r\n\r\n            return {\r\n                data: {\r\n                    name: name.data,\r\n                    value: value.data\r\n                },\r\n                size: name.size + value.size,\r\n                objectEnd: isObjectEnd\r\n            };\r\n        }\r\n    }, {\r\n        key: 'parseVariable',\r\n        value: function parseVariable(arrayBuffer, dataOffset, dataSize) {\r\n            return AMF.parseObject(arrayBuffer, dataOffset, dataSize);\r\n        }\r\n    }, {\r\n        key: 'parseString',\r\n        value: function parseString(arrayBuffer, dataOffset, dataSize) {\r\n            if (dataSize < 2) {\r\n                throw new _exception.IllegalStateException('Data not enough when parse String');\r\n            }\r\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\r\n            var length = v.getUint16(0, !le);\r\n\r\n            var str = void 0;\r\n            if (length > 0) {\r\n                str = (0, _utf8Conv2.default)(new Uint8Array(arrayBuffer, dataOffset + 2, length));\r\n            } else {\r\n                str = '';\r\n            }\r\n\r\n            return {\r\n                data: str,\r\n                size: 2 + length\r\n            };\r\n        }\r\n    }, {\r\n        key: 'parseLongString',\r\n        value: function parseLongString(arrayBuffer, dataOffset, dataSize) {\r\n            if (dataSize < 4) {\r\n                throw new _exception.IllegalStateException('Data not enough when parse LongString');\r\n            }\r\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\r\n            var length = v.getUint32(0, !le);\r\n\r\n            var str = void 0;\r\n            if (length > 0) {\r\n                str = (0, _utf8Conv2.default)(new Uint8Array(arrayBuffer, dataOffset + 4, length));\r\n            } else {\r\n                str = '';\r\n            }\r\n\r\n            return {\r\n                data: str,\r\n                size: 4 + length\r\n            };\r\n        }\r\n    }, {\r\n        key: 'parseDate',\r\n        value: function parseDate(arrayBuffer, dataOffset, dataSize) {\r\n            if (dataSize < 10) {\r\n                throw new _exception.IllegalStateException('Data size invalid when parse Date');\r\n            }\r\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\r\n            var timestamp = v.getFloat64(0, !le);\r\n            var localTimeOffset = v.getInt16(8, !le);\r\n            timestamp += localTimeOffset * 60 * 1000; // get UTC time\r\n\r\n            return {\r\n                data: new Date(timestamp),\r\n                size: 8 + 2\r\n            };\r\n        }\r\n    }, {\r\n        key: 'parseValue',\r\n        value: function parseValue(arrayBuffer, dataOffset, dataSize) {\r\n            if (dataSize < 1) {\r\n                throw new _exception.IllegalStateException('Data not enough when parse Value');\r\n            }\r\n\r\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\r\n\r\n            var offset = 1;\r\n            var type = v.getUint8(0);\r\n            var value = void 0;\r\n            var objectEnd = false;\r\n\r\n            try {\r\n                switch (type) {\r\n                    case 0:\r\n                        // Number(Double) type\r\n                        value = v.getFloat64(1, !le);\r\n                        offset += 8;\r\n                        break;\r\n                    case 1:\r\n                        {\r\n                            // Boolean type\r\n                            var b = v.getUint8(1);\r\n                            value = b ? true : false;\r\n                            offset += 1;\r\n                            break;\r\n                        }\r\n                    case 2:\r\n                        {\r\n                            // String type\r\n                            var amfstr = AMF.parseString(arrayBuffer, dataOffset + 1, dataSize - 1);\r\n                            value = amfstr.data;\r\n                            offset += amfstr.size;\r\n                            break;\r\n                        }\r\n                    case 3:\r\n                        {\r\n                            // Object(s) type\r\n                            value = {};\r\n                            var terminal = 0; // workaround for malformed Objects which has missing ScriptDataObjectEnd\r\n                            if ((v.getUint32(dataSize - 4, !le) & 0x00FFFFFF) === 9) {\r\n                                terminal = 3;\r\n                            }\r\n                            while (offset < dataSize - 4) {\r\n                                // 4 === type(UI8) + ScriptDataObjectEnd(UI24)\r\n                                var amfobj = AMF.parseObject(arrayBuffer, dataOffset + offset, dataSize - offset - terminal);\r\n                                if (amfobj.objectEnd) break;\r\n                                value[amfobj.data.name] = amfobj.data.value;\r\n                                offset += amfobj.size;\r\n                            }\r\n                            if (offset <= dataSize - 3) {\r\n                                var marker = v.getUint32(offset - 1, !le) & 0x00FFFFFF;\r\n                                if (marker === 9) {\r\n                                    offset += 3;\r\n                                }\r\n                            }\r\n                            break;\r\n                        }\r\n                    case 8:\r\n                        {\r\n                            // ECMA array type (Mixed array)\r\n                            value = {};\r\n                            offset += 4; // ECMAArrayLength(UI32)\r\n                            var _terminal = 0; // workaround for malformed MixedArrays which has missing ScriptDataObjectEnd\r\n                            if ((v.getUint32(dataSize - 4, !le) & 0x00FFFFFF) === 9) {\r\n                                _terminal = 3;\r\n                            }\r\n                            while (offset < dataSize - 8) {\r\n                                // 8 === type(UI8) + ECMAArrayLength(UI32) + ScriptDataVariableEnd(UI24)\r\n                                var amfvar = AMF.parseVariable(arrayBuffer, dataOffset + offset, dataSize - offset - _terminal);\r\n                                if (amfvar.objectEnd) break;\r\n                                value[amfvar.data.name] = amfvar.data.value;\r\n                                offset += amfvar.size;\r\n                            }\r\n                            if (offset <= dataSize - 3) {\r\n                                var _marker = v.getUint32(offset - 1, !le) & 0x00FFFFFF;\r\n                                if (_marker === 9) {\r\n                                    offset += 3;\r\n                                }\r\n                            }\r\n                            break;\r\n                        }\r\n                    case 9:\r\n                        // ScriptDataObjectEnd\r\n                        value = undefined;\r\n                        offset = 1;\r\n                        objectEnd = true;\r\n                        break;\r\n                    case 10:\r\n                        {\r\n                            // Strict array type\r\n                            // ScriptDataValue[n]. NOTE: according to video_file_format_spec_v10_1.pdf\r\n                            value = [];\r\n                            var strictArrayLength = v.getUint32(1, !le);\r\n                            offset += 4;\r\n                            for (var i = 0; i < strictArrayLength; i++) {\r\n                                var val = AMF.parseValue(arrayBuffer, dataOffset + offset, dataSize - offset);\r\n                                value.push(val.data);\r\n                                offset += val.size;\r\n                            }\r\n                            break;\r\n                        }\r\n                    case 11:\r\n                        {\r\n                            // Date type\r\n                            var date = AMF.parseDate(arrayBuffer, dataOffset + 1, dataSize - 1);\r\n                            value = date.data;\r\n                            offset += date.size;\r\n                            break;\r\n                        }\r\n                    case 12:\r\n                        {\r\n                            // Long string type\r\n                            var amfLongStr = AMF.parseString(arrayBuffer, dataOffset + 1, dataSize - 1);\r\n                            value = amfLongStr.data;\r\n                            offset += amfLongStr.size;\r\n                            break;\r\n                        }\r\n                    default:\r\n                        // ignore and skip\r\n                        offset = dataSize;\r\n                        _logger2.default.w('AMF', 'Unsupported AMF value type ' + type);\r\n                }\r\n            } catch (e) {\r\n                _logger2.default.e('AMF', e.toString());\r\n            }\r\n\r\n            return {\r\n                data: value,\r\n                size: offset,\r\n                objectEnd: objectEnd\r\n            };\r\n        }\r\n    }]);\r\n\r\n    return AMF;\r\n}();\r\n\r\nexports.default = AMF;\r\n\r\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"../utils/utf8-conv.js\":44}],16:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n  value: true\r\n});\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nvar DemuxErrors = {\r\n  OK: 'OK',\r\n  FORMAT_ERROR: 'FormatError',\r\n  FORMAT_UNSUPPORTED: 'FormatUnsupported',\r\n  CODEC_UNSUPPORTED: 'CodecUnsupported'\r\n};\r\n\r\nexports.default = DemuxErrors;\r\n\r\n},{}],17:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _exception = _dereq_('../utils/exception.js');\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n// Exponential-Golomb buffer decoder\r\nvar ExpGolomb = function () {\r\n    function ExpGolomb(uint8array) {\r\n        _classCallCheck(this, ExpGolomb);\r\n\r\n        this.TAG = 'ExpGolomb';\r\n\r\n        this._buffer = uint8array;\r\n        this._buffer_index = 0;\r\n        this._total_bytes = uint8array.byteLength;\r\n        this._total_bits = uint8array.byteLength * 8;\r\n        this._current_word = 0;\r\n        this._current_word_bits_left = 0;\r\n    }\r\n\r\n    _createClass(ExpGolomb, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            this._buffer = null;\r\n        }\r\n    }, {\r\n        key: '_fillCurrentWord',\r\n        value: function _fillCurrentWord() {\r\n            var buffer_bytes_left = this._total_bytes - this._buffer_index;\r\n            if (buffer_bytes_left <= 0) throw new _exception.IllegalStateException('ExpGolomb: _fillCurrentWord() but no bytes available');\r\n\r\n            var bytes_read = Math.min(4, buffer_bytes_left);\r\n            var word = new Uint8Array(4);\r\n            word.set(this._buffer.subarray(this._buffer_index, this._buffer_index + bytes_read));\r\n            this._current_word = new DataView(word.buffer).getUint32(0, false);\r\n\r\n            this._buffer_index += bytes_read;\r\n            this._current_word_bits_left = bytes_read * 8;\r\n        }\r\n    }, {\r\n        key: 'readBits',\r\n        value: function readBits(bits) {\r\n            if (bits > 32) throw new _exception.InvalidArgumentException('ExpGolomb: readBits() bits exceeded max 32bits!');\r\n\r\n            if (bits <= this._current_word_bits_left) {\r\n                var _result = this._current_word >>> 32 - bits;\r\n                this._current_word <<= bits;\r\n                this._current_word_bits_left -= bits;\r\n                return _result;\r\n            }\r\n\r\n            var result = this._current_word_bits_left ? this._current_word : 0;\r\n            result = result >>> 32 - this._current_word_bits_left;\r\n            var bits_need_left = bits - this._current_word_bits_left;\r\n\r\n            this._fillCurrentWord();\r\n            var bits_read_next = Math.min(bits_need_left, this._current_word_bits_left);\r\n\r\n            var result2 = this._current_word >>> 32 - bits_read_next;\r\n            this._current_word <<= bits_read_next;\r\n            this._current_word_bits_left -= bits_read_next;\r\n\r\n            result = result << bits_read_next | result2;\r\n            return result;\r\n        }\r\n    }, {\r\n        key: 'readBool',\r\n        value: function readBool() {\r\n            return this.readBits(1) === 1;\r\n        }\r\n    }, {\r\n        key: 'readByte',\r\n        value: function readByte() {\r\n            return this.readBits(8);\r\n        }\r\n    }, {\r\n        key: '_skipLeadingZero',\r\n        value: function _skipLeadingZero() {\r\n            var zero_count = void 0;\r\n            for (zero_count = 0; zero_count < this._current_word_bits_left; zero_count++) {\r\n                if (0 !== (this._current_word & 0x80000000 >>> zero_count)) {\r\n                    this._current_word <<= zero_count;\r\n                    this._current_word_bits_left -= zero_count;\r\n                    return zero_count;\r\n                }\r\n            }\r\n            this._fillCurrentWord();\r\n            return zero_count + this._skipLeadingZero();\r\n        }\r\n    }, {\r\n        key: 'readUEG',\r\n        value: function readUEG() {\r\n            // unsigned exponential golomb\r\n            var leading_zeros = this._skipLeadingZero();\r\n            return this.readBits(leading_zeros + 1) - 1;\r\n        }\r\n    }, {\r\n        key: 'readSEG',\r\n        value: function readSEG() {\r\n            // signed exponential golomb\r\n            var value = this.readUEG();\r\n            if (value & 0x01) {\r\n                return value + 1 >>> 1;\r\n            } else {\r\n                return -1 * (value >>> 1);\r\n            }\r\n        }\r\n    }]);\r\n\r\n    return ExpGolomb;\r\n}();\r\n\r\nexports.default = ExpGolomb;\r\n\r\n},{\"../utils/exception.js\":40}],18:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _logger = _dereq_('../utils/logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nvar _amfParser = _dereq_('./amf-parser.js');\r\n\r\nvar _amfParser2 = _interopRequireDefault(_amfParser);\r\n\r\nvar _spsParser = _dereq_('./sps-parser.js');\r\n\r\nvar _spsParser2 = _interopRequireDefault(_spsParser);\r\n\r\nvar _demuxErrors = _dereq_('./demux-errors.js');\r\n\r\nvar _demuxErrors2 = _interopRequireDefault(_demuxErrors);\r\n\r\nvar _mediaInfo = _dereq_('../core/media-info.js');\r\n\r\nvar _mediaInfo2 = _interopRequireDefault(_mediaInfo);\r\n\r\nvar _exception = _dereq_('../utils/exception.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction Swap16(src) {\r\n    return src >>> 8 & 0xFF | (src & 0xFF) << 8;\r\n}\r\n\r\nfunction Swap32(src) {\r\n    return (src & 0xFF000000) >>> 24 | (src & 0x00FF0000) >>> 8 | (src & 0x0000FF00) << 8 | (src & 0x000000FF) << 24;\r\n}\r\n\r\nfunction ReadBig32(array, index) {\r\n    return array[index] << 24 | array[index + 1] << 16 | array[index + 2] << 8 | array[index + 3];\r\n}\r\n\r\nvar FLVDemuxer = function () {\r\n    function FLVDemuxer(probeData, config) {\r\n        _classCallCheck(this, FLVDemuxer);\r\n\r\n        this.TAG = 'FLVDemuxer';\r\n\r\n        this._config = config;\r\n\r\n        this._onError = null;\r\n        this._onMediaInfo = null;\r\n        this._onTrackMetadata = null;\r\n        this._onDataAvailable = null;\r\n\r\n        this._dataOffset = probeData.dataOffset;\r\n        this._firstParse = true;\r\n        this._dispatch = false;\r\n\r\n        this._hasAudio = probeData.hasAudioTrack;\r\n        this._hasVideo = probeData.hasVideoTrack;\r\n\r\n        this._hasAudioFlagOverrided = false;\r\n        this._hasVideoFlagOverrided = false;\r\n\r\n        this._audioInitialMetadataDispatched = false;\r\n        this._videoInitialMetadataDispatched = false;\r\n\r\n        this._mediaInfo = new _mediaInfo2.default();\r\n        this._mediaInfo.hasAudio = this._hasAudio;\r\n        this._mediaInfo.hasVideo = this._hasVideo;\r\n        this._metadata = null;\r\n        this._audioMetadata = null;\r\n        this._videoMetadata = null;\r\n\r\n        this._naluLengthSize = 4;\r\n        this._timestampBase = 0; // int32, in milliseconds\r\n        this._timescale = 1000;\r\n        this._duration = 0; // int32, in milliseconds\r\n        this._durationOverrided = false;\r\n        this._referenceFrameRate = {\r\n            fixed: true,\r\n            fps: 23.976,\r\n            fps_num: 23976,\r\n            fps_den: 1000\r\n        };\r\n\r\n        this._flvSoundRateTable = [5500, 11025, 22050, 44100, 48000];\r\n\r\n        this._mpegSamplingRates = [96000, 88200, 64000, 48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000, 7350];\r\n\r\n        this._mpegAudioV10SampleRateTable = [44100, 48000, 32000, 0];\r\n        this._mpegAudioV20SampleRateTable = [22050, 24000, 16000, 0];\r\n        this._mpegAudioV25SampleRateTable = [11025, 12000, 8000, 0];\r\n\r\n        this._mpegAudioL1BitRateTable = [0, 32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416, 448, -1];\r\n        this._mpegAudioL2BitRateTable = [0, 32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384, -1];\r\n        this._mpegAudioL3BitRateTable = [0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, -1];\r\n\r\n        this._videoTrack = { type: 'video', id: 1, sequenceNumber: 0, samples: [], length: 0 };\r\n        this._audioTrack = { type: 'audio', id: 2, sequenceNumber: 0, samples: [], length: 0 };\r\n\r\n        this._littleEndian = function () {\r\n            var buf = new ArrayBuffer(2);\r\n            new DataView(buf).setInt16(0, 256, true); // little-endian write\r\n            return new Int16Array(buf)[0] === 256; // platform-spec read, if equal then LE\r\n        }();\r\n    }\r\n\r\n    _createClass(FLVDemuxer, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            this._mediaInfo = null;\r\n            this._metadata = null;\r\n            this._audioMetadata = null;\r\n            this._videoMetadata = null;\r\n            this._videoTrack = null;\r\n            this._audioTrack = null;\r\n\r\n            this._onError = null;\r\n            this._onMediaInfo = null;\r\n            this._onTrackMetadata = null;\r\n            this._onDataAvailable = null;\r\n        }\r\n    }, {\r\n        key: 'bindDataSource',\r\n        value: function bindDataSource(loader) {\r\n            loader.onDataArrival = this.parseChunks.bind(this);\r\n            return this;\r\n        }\r\n\r\n        // prototype: function(type: string, metadata: any): void\r\n\r\n    }, {\r\n        key: 'resetMediaInfo',\r\n        value: function resetMediaInfo() {\r\n            this._mediaInfo = new _mediaInfo2.default();\r\n        }\r\n    }, {\r\n        key: '_isInitialMetadataDispatched',\r\n        value: function _isInitialMetadataDispatched() {\r\n            if (this._hasAudio && this._hasVideo) {\r\n                // both audio & video\r\n                return this._audioInitialMetadataDispatched && this._videoInitialMetadataDispatched;\r\n            }\r\n            if (this._hasAudio && !this._hasVideo) {\r\n                // audio only\r\n                return this._audioInitialMetadataDispatched;\r\n            }\r\n            if (!this._hasAudio && this._hasVideo) {\r\n                // video only\r\n                return this._videoInitialMetadataDispatched;\r\n            }\r\n            return false;\r\n        }\r\n\r\n        // function parseChunks(chunk: ArrayBuffer, byteStart: number): number;\r\n\r\n    }, {\r\n        key: 'parseChunks',\r\n        value: function parseChunks(chunk, byteStart) {\r\n            if (!this._onError || !this._onMediaInfo || !this._onTrackMetadata || !this._onDataAvailable) {\r\n                throw new _exception.IllegalStateException('Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified');\r\n            }\r\n\r\n            var offset = 0;\r\n            var le = this._littleEndian;\r\n\r\n            if (byteStart === 0) {\r\n                // buffer with FLV header\r\n                if (chunk.byteLength > 13) {\r\n                    var probeData = FLVDemuxer.probe(chunk);\r\n                    offset = probeData.dataOffset;\r\n                } else {\r\n                    return 0;\r\n                }\r\n            }\r\n\r\n            if (this._firstParse) {\r\n                // handle PreviousTagSize0 before Tag1\r\n                this._firstParse = false;\r\n                if (byteStart + offset !== this._dataOffset) {\r\n                    _logger2.default.w(this.TAG, 'First time parsing but chunk byteStart invalid!');\r\n                }\r\n\r\n                var v = new DataView(chunk, offset);\r\n                var prevTagSize0 = v.getUint32(0, !le);\r\n                if (prevTagSize0 !== 0) {\r\n                    _logger2.default.w(this.TAG, 'PrevTagSize0 !== 0 !!!');\r\n                }\r\n                offset += 4;\r\n            }\r\n\r\n            while (offset < chunk.byteLength) {\r\n                this._dispatch = true;\r\n\r\n                var _v = new DataView(chunk, offset);\r\n\r\n                if (offset + 11 + 4 > chunk.byteLength) {\r\n                    // data not enough for parsing an flv tag\r\n                    break;\r\n                }\r\n\r\n                var tagType = _v.getUint8(0);\r\n                var dataSize = _v.getUint32(0, !le) & 0x00FFFFFF;\r\n\r\n                if (offset + 11 + dataSize + 4 > chunk.byteLength) {\r\n                    // data not enough for parsing actual data body\r\n                    break;\r\n                }\r\n\r\n                if (tagType !== 8 && tagType !== 9 && tagType !== 18) {\r\n                    _logger2.default.w(this.TAG, 'Unsupported tag type ' + tagType + ', skipped');\r\n                    // consume the whole tag (skip it)\r\n                    offset += 11 + dataSize + 4;\r\n                    continue;\r\n                }\r\n\r\n                var ts2 = _v.getUint8(4);\r\n                var ts1 = _v.getUint8(5);\r\n                var ts0 = _v.getUint8(6);\r\n                var ts3 = _v.getUint8(7);\r\n\r\n                var timestamp = ts0 | ts1 << 8 | ts2 << 16 | ts3 << 24;\r\n\r\n                var streamId = _v.getUint32(7, !le) & 0x00FFFFFF;\r\n                if (streamId !== 0) {\r\n                    _logger2.default.w(this.TAG, 'Meet tag which has StreamID != 0!');\r\n                }\r\n\r\n                var dataOffset = offset + 11;\r\n\r\n                switch (tagType) {\r\n                    case 8:\r\n                        // Audio\r\n                        this._parseAudioData(chunk, dataOffset, dataSize, timestamp);\r\n                        break;\r\n                    case 9:\r\n                        // Video\r\n                        this._parseVideoData(chunk, dataOffset, dataSize, timestamp, byteStart + offset);\r\n                        break;\r\n                    case 18:\r\n                        // ScriptDataObject\r\n                        this._parseScriptData(chunk, dataOffset, dataSize);\r\n                        break;\r\n                }\r\n\r\n                var prevTagSize = _v.getUint32(11 + dataSize, !le);\r\n                if (prevTagSize !== 11 + dataSize) {\r\n                    _logger2.default.w(this.TAG, 'Invalid PrevTagSize ' + prevTagSize);\r\n                }\r\n\r\n                offset += 11 + dataSize + 4; // tagBody + dataSize + prevTagSize\r\n            }\r\n\r\n            // dispatch parsed frames to consumer (typically, the remuxer)\r\n            if (this._isInitialMetadataDispatched()) {\r\n                if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\r\n                    this._onDataAvailable(this._audioTrack, this._videoTrack);\r\n                }\r\n            }\r\n\r\n            return offset; // consumed bytes, just equals latest offset index\r\n        }\r\n    }, {\r\n        key: '_parseScriptData',\r\n        value: function _parseScriptData(arrayBuffer, dataOffset, dataSize) {\r\n            var scriptData = _amfParser2.default.parseScriptData(arrayBuffer, dataOffset, dataSize);\r\n\r\n            if (scriptData.hasOwnProperty('onMetaData')) {\r\n                if (scriptData.onMetaData == null || _typeof(scriptData.onMetaData) !== 'object') {\r\n                    _logger2.default.w(this.TAG, 'Invalid onMetaData structure!');\r\n                    return;\r\n                }\r\n                if (this._metadata) {\r\n                    _logger2.default.w(this.TAG, 'Found another onMetaData tag!');\r\n                }\r\n                this._metadata = scriptData;\r\n                var onMetaData = this._metadata.onMetaData;\r\n\r\n                if (typeof onMetaData.hasAudio === 'boolean') {\r\n                    // hasAudio\r\n                    if (this._hasAudioFlagOverrided === false) {\r\n                        this._hasAudio = onMetaData.hasAudio;\r\n                        this._mediaInfo.hasAudio = this._hasAudio;\r\n                    }\r\n                }\r\n                if (typeof onMetaData.hasVideo === 'boolean') {\r\n                    // hasVideo\r\n                    if (this._hasVideoFlagOverrided === false) {\r\n                        this._hasVideo = onMetaData.hasVideo;\r\n                        this._mediaInfo.hasVideo = this._hasVideo;\r\n                    }\r\n                }\r\n                if (typeof onMetaData.audiodatarate === 'number') {\r\n                    // audiodatarate\r\n                    this._mediaInfo.audioDataRate = onMetaData.audiodatarate;\r\n                }\r\n                if (typeof onMetaData.videodatarate === 'number') {\r\n                    // videodatarate\r\n                    this._mediaInfo.videoDataRate = onMetaData.videodatarate;\r\n                }\r\n                if (typeof onMetaData.width === 'number') {\r\n                    // width\r\n                    this._mediaInfo.width = onMetaData.width;\r\n                }\r\n                if (typeof onMetaData.height === 'number') {\r\n                    // height\r\n                    this._mediaInfo.height = onMetaData.height;\r\n                }\r\n                if (typeof onMetaData.duration === 'number') {\r\n                    // duration\r\n                    if (!this._durationOverrided) {\r\n                        var duration = Math.floor(onMetaData.duration * this._timescale);\r\n                        this._duration = duration;\r\n                        this._mediaInfo.duration = duration;\r\n                    }\r\n                } else {\r\n                    this._mediaInfo.duration = 0;\r\n                }\r\n                if (typeof onMetaData.framerate === 'number') {\r\n                    // framerate\r\n                    var fps_num = Math.floor(onMetaData.framerate * 1000);\r\n                    if (fps_num > 0) {\r\n                        var fps = fps_num / 1000;\r\n                        this._referenceFrameRate.fixed = true;\r\n                        this._referenceFrameRate.fps = fps;\r\n                        this._referenceFrameRate.fps_num = fps_num;\r\n                        this._referenceFrameRate.fps_den = 1000;\r\n                        this._mediaInfo.fps = fps;\r\n                    }\r\n                }\r\n                if (_typeof(onMetaData.keyframes) === 'object') {\r\n                    // keyframes\r\n                    this._mediaInfo.hasKeyframesIndex = true;\r\n                    var keyframes = onMetaData.keyframes;\r\n                    this._mediaInfo.keyframesIndex = this._parseKeyframesIndex(keyframes);\r\n                    onMetaData.keyframes = null; // keyframes has been extracted, remove it\r\n                } else {\r\n                    this._mediaInfo.hasKeyframesIndex = false;\r\n                }\r\n                this._dispatch = false;\r\n                this._mediaInfo.metadata = onMetaData;\r\n                _logger2.default.v(this.TAG, 'Parsed onMetaData');\r\n                if (this._mediaInfo.isComplete()) {\r\n                    this._onMediaInfo(this._mediaInfo);\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_parseKeyframesIndex',\r\n        value: function _parseKeyframesIndex(keyframes) {\r\n            var times = [];\r\n            var filepositions = [];\r\n\r\n            // ignore first keyframe which is actually AVC Sequence Header (AVCDecoderConfigurationRecord)\r\n            for (var i = 1; i < keyframes.times.length; i++) {\r\n                var time = this._timestampBase + Math.floor(keyframes.times[i] * 1000);\r\n                times.push(time);\r\n                filepositions.push(keyframes.filepositions[i]);\r\n            }\r\n\r\n            return {\r\n                times: times,\r\n                filepositions: filepositions\r\n            };\r\n        }\r\n    }, {\r\n        key: '_parseAudioData',\r\n        value: function _parseAudioData(arrayBuffer, dataOffset, dataSize, tagTimestamp) {\r\n            if (dataSize <= 1) {\r\n                _logger2.default.w(this.TAG, 'Flv: Invalid audio packet, missing SoundData payload!');\r\n                return;\r\n            }\r\n\r\n            if (this._hasAudioFlagOverrided === true && this._hasAudio === false) {\r\n                // If hasAudio: false indicated explicitly in MediaDataSource,\r\n                // Ignore all the audio packets\r\n                return;\r\n            }\r\n\r\n            var le = this._littleEndian;\r\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\r\n\r\n            var soundSpec = v.getUint8(0);\r\n\r\n            var soundFormat = soundSpec >>> 4;\r\n            if (soundFormat !== 2 && soundFormat !== 10) {\r\n                // MP3 or AAC\r\n                this._onError(_demuxErrors2.default.CODEC_UNSUPPORTED, 'Flv: Unsupported audio codec idx: ' + soundFormat);\r\n                return;\r\n            }\r\n\r\n            var soundRate = 0;\r\n            var soundRateIndex = (soundSpec & 12) >>> 2;\r\n            if (soundRateIndex >= 0 && soundRateIndex <= 4) {\r\n                soundRate = this._flvSoundRateTable[soundRateIndex];\r\n            } else {\r\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid audio sample rate idx: ' + soundRateIndex);\r\n                return;\r\n            }\r\n\r\n            var soundSize = (soundSpec & 2) >>> 1; // unused\r\n            var soundType = soundSpec & 1;\r\n\r\n            var meta = this._audioMetadata;\r\n            var track = this._audioTrack;\r\n\r\n            if (!meta) {\r\n                if (this._hasAudio === false && this._hasAudioFlagOverrided === false) {\r\n                    this._hasAudio = true;\r\n                    this._mediaInfo.hasAudio = true;\r\n                }\r\n\r\n                // initial metadata\r\n                meta = this._audioMetadata = {};\r\n                meta.type = 'audio';\r\n                meta.id = track.id;\r\n                meta.timescale = this._timescale;\r\n                meta.duration = this._duration;\r\n                meta.audioSampleRate = soundRate;\r\n                meta.channelCount = soundType === 0 ? 1 : 2;\r\n            }\r\n\r\n            if (soundFormat === 10) {\r\n                // AAC\r\n                var aacData = this._parseAACAudioData(arrayBuffer, dataOffset + 1, dataSize - 1);\r\n                if (aacData == undefined) {\r\n                    return;\r\n                }\r\n\r\n                if (aacData.packetType === 0) {\r\n                    // AAC sequence header (AudioSpecificConfig)\r\n                    if (meta.config) {\r\n                        _logger2.default.w(this.TAG, 'Found another AudioSpecificConfig!');\r\n                    }\r\n                    var misc = aacData.data;\r\n                    meta.audioSampleRate = misc.samplingRate;\r\n                    meta.channelCount = misc.channelCount;\r\n                    meta.codec = misc.codec;\r\n                    meta.originalCodec = misc.originalCodec;\r\n                    meta.config = misc.config;\r\n                    // The decode result of an aac sample is 1024 PCM samples\r\n                    meta.refSampleDuration = 1024 / meta.audioSampleRate * meta.timescale;\r\n                    _logger2.default.v(this.TAG, 'Parsed AudioSpecificConfig');\r\n\r\n                    if (this._isInitialMetadataDispatched()) {\r\n                        // Non-initial metadata, force dispatch (or flush) parsed frames to remuxer\r\n                        if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\r\n                            this._onDataAvailable(this._audioTrack, this._videoTrack);\r\n                        }\r\n                    } else {\r\n                        this._audioInitialMetadataDispatched = true;\r\n                    }\r\n                    // then notify new metadata\r\n                    this._dispatch = false;\r\n                    this._onTrackMetadata('audio', meta);\r\n\r\n                    var mi = this._mediaInfo;\r\n                    mi.audioCodec = meta.originalCodec;\r\n                    mi.audioSampleRate = meta.audioSampleRate;\r\n                    mi.audioChannelCount = meta.channelCount;\r\n                    if (mi.hasVideo) {\r\n                        if (mi.videoCodec != null) {\r\n                            mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + ',' + mi.audioCodec + '\"';\r\n                        }\r\n                    } else {\r\n                        mi.mimeType = 'video/x-flv; codecs=\"' + mi.audioCodec + '\"';\r\n                    }\r\n                    if (mi.isComplete()) {\r\n                        this._onMediaInfo(mi);\r\n                    }\r\n                } else if (aacData.packetType === 1) {\r\n                    // AAC raw frame data\r\n                    var dts = this._timestampBase + tagTimestamp;\r\n                    var aacSample = { unit: aacData.data, dts: dts, pts: dts };\r\n                    track.samples.push(aacSample);\r\n                    track.length += aacData.data.length;\r\n                } else {\r\n                    _logger2.default.e(this.TAG, 'Flv: Unsupported AAC data type ' + aacData.packetType);\r\n                }\r\n            } else if (soundFormat === 2) {\r\n                // MP3\r\n                if (!meta.codec) {\r\n                    // We need metadata for mp3 audio track, extract info from frame header\r\n                    var _misc = this._parseMP3AudioData(arrayBuffer, dataOffset + 1, dataSize - 1, true);\r\n                    if (_misc == undefined) {\r\n                        return;\r\n                    }\r\n                    meta.audioSampleRate = _misc.samplingRate;\r\n                    meta.channelCount = _misc.channelCount;\r\n                    meta.codec = _misc.codec;\r\n                    meta.originalCodec = _misc.originalCodec;\r\n                    // The decode result of an mp3 sample is 1152 PCM samples\r\n                    meta.refSampleDuration = 1152 / meta.audioSampleRate * meta.timescale;\r\n                    _logger2.default.v(this.TAG, 'Parsed MPEG Audio Frame Header');\r\n\r\n                    this._audioInitialMetadataDispatched = true;\r\n                    this._onTrackMetadata('audio', meta);\r\n\r\n                    var _mi = this._mediaInfo;\r\n                    _mi.audioCodec = meta.codec;\r\n                    _mi.audioSampleRate = meta.audioSampleRate;\r\n                    _mi.audioChannelCount = meta.channelCount;\r\n                    _mi.audioDataRate = _misc.bitRate;\r\n                    if (_mi.hasVideo) {\r\n                        if (_mi.videoCodec != null) {\r\n                            _mi.mimeType = 'video/x-flv; codecs=\"' + _mi.videoCodec + ',' + _mi.audioCodec + '\"';\r\n                        }\r\n                    } else {\r\n                        _mi.mimeType = 'video/x-flv; codecs=\"' + _mi.audioCodec + '\"';\r\n                    }\r\n                    if (_mi.isComplete()) {\r\n                        this._onMediaInfo(_mi);\r\n                    }\r\n                }\r\n\r\n                // This packet is always a valid audio packet, extract it\r\n                var data = this._parseMP3AudioData(arrayBuffer, dataOffset + 1, dataSize - 1, false);\r\n                if (data == undefined) {\r\n                    return;\r\n                }\r\n                var _dts = this._timestampBase + tagTimestamp;\r\n                var mp3Sample = { unit: data, dts: _dts, pts: _dts };\r\n                track.samples.push(mp3Sample);\r\n                track.length += data.length;\r\n            }\r\n        }\r\n    }, {\r\n        key: '_parseAACAudioData',\r\n        value: function _parseAACAudioData(arrayBuffer, dataOffset, dataSize) {\r\n            if (dataSize <= 1) {\r\n                _logger2.default.w(this.TAG, 'Flv: Invalid AAC packet, missing AACPacketType or/and Data!');\r\n                return;\r\n            }\r\n\r\n            var result = {};\r\n            var array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\r\n\r\n            result.packetType = array[0];\r\n\r\n            if (array[0] === 0) {\r\n                result.data = this._parseAACAudioSpecificConfig(arrayBuffer, dataOffset + 1, dataSize - 1);\r\n            } else {\r\n                result.data = array.subarray(1);\r\n            }\r\n\r\n            return result;\r\n        }\r\n    }, {\r\n        key: '_parseAACAudioSpecificConfig',\r\n        value: function _parseAACAudioSpecificConfig(arrayBuffer, dataOffset, dataSize) {\r\n            var array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\r\n            var config = null;\r\n\r\n            /* Audio Object Type:\r\n               0: Null\r\n               1: AAC Main\r\n               2: AAC LC\r\n               3: AAC SSR (Scalable Sample Rate)\r\n               4: AAC LTP (Long Term Prediction)\r\n               5: HE-AAC / SBR (Spectral Band Replication)\r\n               6: AAC Scalable\r\n            */\r\n\r\n            var audioObjectType = 0;\r\n            var originalAudioObjectType = 0;\r\n            var audioExtensionObjectType = null;\r\n            var samplingIndex = 0;\r\n            var extensionSamplingIndex = null;\r\n\r\n            // 5 bits\r\n            audioObjectType = originalAudioObjectType = array[0] >>> 3;\r\n            // 4 bits\r\n            samplingIndex = (array[0] & 0x07) << 1 | array[1] >>> 7;\r\n            if (samplingIndex < 0 || samplingIndex >= this._mpegSamplingRates.length) {\r\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: AAC invalid sampling frequency index!');\r\n                return;\r\n            }\r\n\r\n            var samplingFrequence = this._mpegSamplingRates[samplingIndex];\r\n\r\n            // 4 bits\r\n            var channelConfig = (array[1] & 0x78) >>> 3;\r\n            if (channelConfig < 0 || channelConfig >= 8) {\r\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: AAC invalid channel configuration');\r\n                return;\r\n            }\r\n\r\n            if (audioObjectType === 5) {\r\n                // HE-AAC?\r\n                // 4 bits\r\n                extensionSamplingIndex = (array[1] & 0x07) << 1 | array[2] >>> 7;\r\n                // 5 bits\r\n                audioExtensionObjectType = (array[2] & 0x7C) >>> 2;\r\n            }\r\n\r\n            // workarounds for various browsers\r\n            var userAgent = self.navigator.userAgent.toLowerCase();\r\n\r\n            if (userAgent.indexOf('firefox') !== -1) {\r\n                // firefox: use SBR (HE-AAC) if freq less than 24kHz\r\n                if (samplingIndex >= 6) {\r\n                    audioObjectType = 5;\r\n                    config = new Array(4);\r\n                    extensionSamplingIndex = samplingIndex - 3;\r\n                } else {\r\n                    // use LC-AAC\r\n                    audioObjectType = 2;\r\n                    config = new Array(2);\r\n                    extensionSamplingIndex = samplingIndex;\r\n                }\r\n            } else if (userAgent.indexOf('android') !== -1) {\r\n                // android: always use LC-AAC\r\n                audioObjectType = 2;\r\n                config = new Array(2);\r\n                extensionSamplingIndex = samplingIndex;\r\n            } else {\r\n                // for other browsers, e.g. chrome...\r\n                // Always use HE-AAC to make it easier to switch aac codec profile\r\n                audioObjectType = 5;\r\n                extensionSamplingIndex = samplingIndex;\r\n                config = new Array(4);\r\n\r\n                if (samplingIndex >= 6) {\r\n                    extensionSamplingIndex = samplingIndex - 3;\r\n                } else if (channelConfig === 1) {\r\n                    // Mono channel\r\n                    audioObjectType = 2;\r\n                    config = new Array(2);\r\n                    extensionSamplingIndex = samplingIndex;\r\n                }\r\n            }\r\n\r\n            config[0] = audioObjectType << 3;\r\n            config[0] |= (samplingIndex & 0x0F) >>> 1;\r\n            config[1] = (samplingIndex & 0x0F) << 7;\r\n            config[1] |= (channelConfig & 0x0F) << 3;\r\n            if (audioObjectType === 5) {\r\n                config[1] |= (extensionSamplingIndex & 0x0F) >>> 1;\r\n                config[2] = (extensionSamplingIndex & 0x01) << 7;\r\n                // extended audio object type: force to 2 (LC-AAC)\r\n                config[2] |= 2 << 2;\r\n                config[3] = 0;\r\n            }\r\n\r\n            return {\r\n                config: config,\r\n                samplingRate: samplingFrequence,\r\n                channelCount: channelConfig,\r\n                codec: 'mp4a.40.' + audioObjectType,\r\n                originalCodec: 'mp4a.40.' + originalAudioObjectType\r\n            };\r\n        }\r\n    }, {\r\n        key: '_parseMP3AudioData',\r\n        value: function _parseMP3AudioData(arrayBuffer, dataOffset, dataSize, requestHeader) {\r\n            if (dataSize < 4) {\r\n                _logger2.default.w(this.TAG, 'Flv: Invalid MP3 packet, header missing!');\r\n                return;\r\n            }\r\n\r\n            var le = this._littleEndian;\r\n            var array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\r\n            var result = null;\r\n\r\n            if (requestHeader) {\r\n                if (array[0] !== 0xFF) {\r\n                    return;\r\n                }\r\n                var ver = array[1] >>> 3 & 0x03;\r\n                var layer = (array[1] & 0x06) >> 1;\r\n\r\n                var bitrate_index = (array[2] & 0xF0) >>> 4;\r\n                var sampling_freq_index = (array[2] & 0x0C) >>> 2;\r\n\r\n                var channel_mode = array[3] >>> 6 & 0x03;\r\n                var channel_count = channel_mode !== 3 ? 2 : 1;\r\n\r\n                var sample_rate = 0;\r\n                var bit_rate = 0;\r\n                var object_type = 34; // Layer-3, listed in MPEG-4 Audio Object Types\r\n\r\n                var codec = 'mp3';\r\n\r\n                switch (ver) {\r\n                    case 0:\r\n                        // MPEG 2.5\r\n                        sample_rate = this._mpegAudioV25SampleRateTable[sampling_freq_index];\r\n                        break;\r\n                    case 2:\r\n                        // MPEG 2\r\n                        sample_rate = this._mpegAudioV20SampleRateTable[sampling_freq_index];\r\n                        break;\r\n                    case 3:\r\n                        // MPEG 1\r\n                        sample_rate = this._mpegAudioV10SampleRateTable[sampling_freq_index];\r\n                        break;\r\n                }\r\n\r\n                switch (layer) {\r\n                    case 1:\r\n                        // Layer 3\r\n                        object_type = 34;\r\n                        if (bitrate_index < this._mpegAudioL3BitRateTable.length) {\r\n                            bit_rate = this._mpegAudioL3BitRateTable[bitrate_index];\r\n                        }\r\n                        break;\r\n                    case 2:\r\n                        // Layer 2\r\n                        object_type = 33;\r\n                        if (bitrate_index < this._mpegAudioL2BitRateTable.length) {\r\n                            bit_rate = this._mpegAudioL2BitRateTable[bitrate_index];\r\n                        }\r\n                        break;\r\n                    case 3:\r\n                        // Layer 1\r\n                        object_type = 32;\r\n                        if (bitrate_index < this._mpegAudioL1BitRateTable.length) {\r\n                            bit_rate = this._mpegAudioL1BitRateTable[bitrate_index];\r\n                        }\r\n                        break;\r\n                }\r\n\r\n                result = {\r\n                    bitRate: bit_rate,\r\n                    samplingRate: sample_rate,\r\n                    channelCount: channel_count,\r\n                    codec: codec,\r\n                    originalCodec: codec\r\n                };\r\n            } else {\r\n                result = array;\r\n            }\r\n\r\n            return result;\r\n        }\r\n    }, {\r\n        key: '_parseVideoData',\r\n        value: function _parseVideoData(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition) {\r\n            if (dataSize <= 1) {\r\n                _logger2.default.w(this.TAG, 'Flv: Invalid video packet, missing VideoData payload!');\r\n                return;\r\n            }\r\n\r\n            if (this._hasVideoFlagOverrided === true && this._hasVideo === false) {\r\n                // If hasVideo: false indicated explicitly in MediaDataSource,\r\n                // Ignore all the video packets\r\n                return;\r\n            }\r\n\r\n            var spec = new Uint8Array(arrayBuffer, dataOffset, dataSize)[0];\r\n\r\n            var frameType = (spec & 240) >>> 4;\r\n            var codecId = spec & 15;\r\n\r\n            if (codecId !== 7) {\r\n                this._onError(_demuxErrors2.default.CODEC_UNSUPPORTED, 'Flv: Unsupported codec in video frame: ' + codecId);\r\n                return;\r\n            }\r\n\r\n            this._parseAVCVideoPacket(arrayBuffer, dataOffset + 1, dataSize - 1, tagTimestamp, tagPosition, frameType);\r\n        }\r\n    }, {\r\n        key: '_parseAVCVideoPacket',\r\n        value: function _parseAVCVideoPacket(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition, frameType) {\r\n            if (dataSize < 4) {\r\n                _logger2.default.w(this.TAG, 'Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime');\r\n                return;\r\n            }\r\n\r\n            var le = this._littleEndian;\r\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\r\n\r\n            var packetType = v.getUint8(0);\r\n            var cts = v.getUint32(0, !le) & 0x00FFFFFF;\r\n\r\n            if (packetType === 0) {\r\n                // AVCDecoderConfigurationRecord\r\n                this._parseAVCDecoderConfigurationRecord(arrayBuffer, dataOffset + 4, dataSize - 4);\r\n            } else if (packetType === 1) {\r\n                // One or more Nalus\r\n                this._parseAVCVideoData(arrayBuffer, dataOffset + 4, dataSize - 4, tagTimestamp, tagPosition, frameType, cts);\r\n            } else if (packetType === 2) {\r\n                // empty, AVC end of sequence\r\n            } else {\r\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid video packet type ' + packetType);\r\n                return;\r\n            }\r\n        }\r\n    }, {\r\n        key: '_parseAVCDecoderConfigurationRecord',\r\n        value: function _parseAVCDecoderConfigurationRecord(arrayBuffer, dataOffset, dataSize) {\r\n          //debugger;\r\n            if (dataSize < 7) {\r\n                _logger2.default.w(this.TAG, 'Flv: Invalid AVCDecoderConfigurationRecord, lack of data!');\r\n                return;\r\n            }\r\n\r\n            var meta = this._videoMetadata;\r\n            var track = this._videoTrack;\r\n            var le = this._littleEndian;\r\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\r\n            console.log(new Uint8Array(arrayBuffer, dataOffset).toString());\r\n            if (!meta) {\r\n                if (this._hasVideo === false && this._hasVideoFlagOverrided === false) {\r\n                    this._hasVideo = true;\r\n                    this._mediaInfo.hasVideo = true;\r\n                }\r\n\r\n                meta = this._videoMetadata = {};\r\n                meta.type = 'video';\r\n                meta.id = track.id;\r\n                meta.timescale = this._timescale;\r\n                meta.duration = this._duration;\r\n            } else {\r\n                if (typeof meta.avcc !== 'undefined') {\r\n                    _logger2.default.w(this.TAG, 'Found another AVCDecoderConfigurationRecord!');\r\n                }\r\n            }\r\n\r\n            var version = v.getUint8(0); // configurationVersion\r\n            var avcProfile = v.getUint8(1); // avcProfileIndication\r\n            var profileCompatibility = v.getUint8(2); // profile_compatibility\r\n            var avcLevel = v.getUint8(3); // AVCLevelIndication\r\n\r\n            if (version !== 1 || avcProfile === 0) {\r\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord');\r\n                return;\r\n            }\r\n\r\n            this._naluLengthSize = (v.getUint8(4) & 3) + 1; // lengthSizeMinusOne\r\n            if (this._naluLengthSize !== 3 && this._naluLengthSize !== 4) {\r\n                // holy shit!!!\r\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Strange NaluLengthSizeMinusOne: ' + (this._naluLengthSize - 1));\r\n                return;\r\n            }\r\n\r\n            var spsCount = v.getUint8(5) & 31; // numOfSequenceParameterSets\r\n            if (spsCount === 0) {\r\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord: No SPS');\r\n                return;\r\n            } else if (spsCount > 1) {\r\n                _logger2.default.w(this.TAG, 'Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ' + spsCount);\r\n            }\r\n\r\n            var offset = 6;\r\n\r\n            for (var i = 0; i < spsCount; i++) {\r\n                var len = v.getUint16(offset, !le); // sequenceParameterSetLength\r\n                offset += 2;\r\n\r\n                if (len === 0) {\r\n                    continue;\r\n                }\r\n\r\n                // Notice: Nalu without startcode header (00 00 00 01)\r\n                var sps = new Uint8Array(arrayBuffer, dataOffset + offset, len);\r\n                offset += len;\r\n\r\n                var config = _spsParser2.default.parseSPS(sps);\r\n                if (i !== 0) {\r\n                    // ignore other sps's config\r\n                    continue;\r\n                }\r\n\r\n                meta.codecWidth = config.codec_size.width;\r\n                meta.codecHeight = config.codec_size.height;\r\n                meta.presentWidth = config.present_size.width;\r\n                meta.presentHeight = config.present_size.height;\r\n\r\n                meta.profile = config.profile_string;\r\n                meta.level = config.level_string;\r\n                meta.bitDepth = config.bit_depth;\r\n                meta.chromaFormat = config.chroma_format;\r\n                meta.sarRatio = config.sar_ratio;\r\n                meta.frameRate = config.frame_rate;\r\n\r\n                if (config.frame_rate.fixed === false || config.frame_rate.fps_num === 0 || config.frame_rate.fps_den === 0) {\r\n                    meta.frameRate = this._referenceFrameRate;\r\n                }\r\n\r\n                var fps_den = meta.frameRate.fps_den;\r\n                var fps_num = meta.frameRate.fps_num;\r\n                meta.refSampleDuration = meta.timescale * (fps_den / fps_num);\r\n\r\n                var codecArray = sps.subarray(1, 4);\r\n                var codecString = 'avc1.';\r\n                for (var j = 0; j < 3; j++) {\r\n                    var h = codecArray[j].toString(16);\r\n                    if (h.length < 2) {\r\n                        h = '0' + h;\r\n                    }\r\n                    codecString += h;\r\n                }\r\n                meta.codec = codecString;\r\n\r\n                var mi = this._mediaInfo;\r\n                mi.width = meta.codecWidth;\r\n                mi.height = meta.codecHeight;\r\n                mi.fps = meta.frameRate.fps;\r\n                mi.profile = meta.profile;\r\n                mi.level = meta.level;\r\n                mi.chromaFormat = config.chroma_format_string;\r\n                mi.sarNum = meta.sarRatio.width;\r\n                mi.sarDen = meta.sarRatio.height;\r\n                mi.videoCodec = codecString;\r\n\r\n                if (mi.hasAudio) {\r\n                    if (mi.audioCodec != null) {\r\n                        mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + ',' + mi.audioCodec + '\"';\r\n                    }\r\n                } else {\r\n                    mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + '\"';\r\n                }\r\n                if (mi.isComplete()) {\r\n                    this._onMediaInfo(mi);\r\n                }\r\n            }\r\n\r\n            var ppsCount = v.getUint8(offset); // numOfPictureParameterSets\r\n            if (ppsCount === 0) {\r\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord: No PPS');\r\n                return;\r\n            } else if (ppsCount > 1) {\r\n                _logger2.default.w(this.TAG, 'Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ' + ppsCount);\r\n            }\r\n\r\n            offset++;\r\n\r\n            for (var _i = 0; _i < ppsCount; _i++) {\r\n                var _len = v.getUint16(offset, !le); // pictureParameterSetLength\r\n                offset += 2;\r\n\r\n                if (_len === 0) {\r\n                    continue;\r\n                }\r\n\r\n                // pps is useless for extracting video information\r\n                offset += _len;\r\n            }\r\n\r\n            meta.avcc = new Uint8Array(dataSize);\r\n            meta.avcc.set(new Uint8Array(arrayBuffer, dataOffset, dataSize), 0);\r\n            _logger2.default.v(this.TAG, 'Parsed AVCDecoderConfigurationRecord');\r\n\r\n            if (this._isInitialMetadataDispatched()) {\r\n                // flush parsed frames\r\n                if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\r\n                    this._onDataAvailable(this._audioTrack, this._videoTrack);\r\n                }\r\n            } else {\r\n                this._videoInitialMetadataDispatched = true;\r\n            }\r\n            // notify new metadata\r\n            this._dispatch = false;\r\n            this._onTrackMetadata('video', meta);\r\n        }\r\n    }, {\r\n        key: '_parseAVCVideoData',\r\n        value: function _parseAVCVideoData(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition, frameType, cts) {\r\n            var le = this._littleEndian;\r\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\r\n\r\n            var units = [],\r\n                length = 0;\r\n\r\n            var offset = 0;\r\n            var lengthSize = this._naluLengthSize;\r\n            var dts = this._timestampBase + tagTimestamp;\r\n            console.log(''+dts);\r\n            var keyframe = frameType === 1; // from FLV Frame Type constants\r\n\r\n            while (offset < dataSize) {\r\n                if (offset + 4 >= dataSize) {\r\n                    _logger2.default.w(this.TAG, 'Malformed Nalu near timestamp ' + dts + ', offset = ' + offset + ', dataSize = ' + dataSize);\r\n                    break; // data not enough for next Nalu\r\n                }\r\n                // Nalu with length-header (AVC1)\r\n                var naluSize = v.getUint32(offset, !le); // Big-Endian read\r\n                if (lengthSize === 3) {\r\n                    naluSize >>>= 8;\r\n                }\r\n                if (naluSize > dataSize - lengthSize) {\r\n                    _logger2.default.w(this.TAG, 'Malformed Nalus near timestamp ' + dts + ', NaluSize > DataSize!');\r\n                    return;\r\n                }\r\n\r\n                var unitType = v.getUint8(offset + lengthSize) & 0x1F;\r\n\r\n                if (unitType === 5) {\r\n                    // IDR\r\n                    keyframe = true;\r\n                }\r\n\r\n                var data = new Uint8Array(arrayBuffer, dataOffset + offset, lengthSize + naluSize);\r\n                var unit = { type: unitType, data: data };\r\n                units.push(unit);\r\n                length += data.byteLength;\r\n\r\n                offset += lengthSize + naluSize;\r\n            }\r\n\r\n            if (units.length) {\r\n                var track = this._videoTrack;\r\n                var avcSample = {\r\n                    units: units,\r\n                    length: length,\r\n                    isKeyframe: keyframe,\r\n                    dts: dts,\r\n                    cts: cts,\r\n                    pts: dts + cts\r\n                };\r\n                if (keyframe) {\r\n                    avcSample.fileposition = tagPosition;\r\n                }\r\n                track.samples.push(avcSample);\r\n                track.length += length;\r\n            }\r\n        }\r\n    }, {\r\n        key: 'onTrackMetadata',\r\n        get: function get() {\r\n            return this._onTrackMetadata;\r\n        },\r\n        set: function set(callback) {\r\n            this._onTrackMetadata = callback;\r\n        }\r\n\r\n        // prototype: function(mediaInfo: MediaInfo): void\r\n\r\n    }, {\r\n        key: 'onMediaInfo',\r\n        get: function get() {\r\n            return this._onMediaInfo;\r\n        },\r\n        set: function set(callback) {\r\n            this._onMediaInfo = callback;\r\n        }\r\n\r\n        // prototype: function(type: number, info: string): void\r\n\r\n    }, {\r\n        key: 'onError',\r\n        get: function get() {\r\n            return this._onError;\r\n        },\r\n        set: function set(callback) {\r\n            this._onError = callback;\r\n        }\r\n\r\n        // prototype: function(videoTrack: any, audioTrack: any): void\r\n\r\n    }, {\r\n        key: 'onDataAvailable',\r\n        get: function get() {\r\n            return this._onDataAvailable;\r\n        },\r\n        set: function set(callback) {\r\n            this._onDataAvailable = callback;\r\n        }\r\n\r\n        // timestamp base for output samples, must be in milliseconds\r\n\r\n    }, {\r\n        key: 'timestampBase',\r\n        get: function get() {\r\n            return this._timestampBase;\r\n        },\r\n        set: function set(base) {\r\n            this._timestampBase = base;\r\n        }\r\n    }, {\r\n        key: 'overridedDuration',\r\n        get: function get() {\r\n            return this._duration;\r\n        }\r\n\r\n        // Force-override media duration. Must be in milliseconds, int32\r\n        ,\r\n        set: function set(duration) {\r\n            this._durationOverrided = true;\r\n            this._duration = duration;\r\n            this._mediaInfo.duration = duration;\r\n        }\r\n\r\n        // Force-override audio track present flag, boolean\r\n\r\n    }, {\r\n        key: 'overridedHasAudio',\r\n        set: function set(hasAudio) {\r\n            this._hasAudioFlagOverrided = true;\r\n            this._hasAudio = hasAudio;\r\n            this._mediaInfo.hasAudio = hasAudio;\r\n        }\r\n\r\n        // Force-override video track present flag, boolean\r\n\r\n    }, {\r\n        key: 'overridedHasVideo',\r\n        set: function set(hasVideo) {\r\n            this._hasVideoFlagOverrided = true;\r\n            this._hasVideo = hasVideo;\r\n            this._mediaInfo.hasVideo = hasVideo;\r\n        }\r\n    }], [{\r\n        key: 'probe',\r\n        value: function probe(buffer) {\r\n            var data = new Uint8Array(buffer);\r\n            var mismatch = { match: false };\r\n\r\n            if (data[0] !== 0x46 || data[1] !== 0x4C || data[2] !== 0x56 || data[3] !== 0x01) {\r\n                return mismatch;\r\n            }\r\n\r\n            var hasAudio = (data[4] & 4) >>> 2 !== 0;\r\n            var hasVideo = (data[4] & 1) !== 0;\r\n\r\n            var offset = ReadBig32(data, 5);\r\n\r\n            if (offset < 9) {\r\n                return mismatch;\r\n            }\r\n\r\n            return {\r\n                match: true,\r\n                consumed: offset,\r\n                dataOffset: offset,\r\n                hasAudioTrack: hasAudio,\r\n                hasVideoTrack: hasVideo\r\n            };\r\n        }\r\n    }]);\r\n\r\n    return FLVDemuxer;\r\n}();\r\n\r\nexports.default = FLVDemuxer;\r\n\r\n},{\"../core/media-info.js\":7,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./amf-parser.js\":15,\"./demux-errors.js\":16,\"./sps-parser.js\":19}],19:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _expGolomb = _dereq_('./exp-golomb.js');\r\n\r\nvar _expGolomb2 = _interopRequireDefault(_expGolomb);\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nvar SPSParser = function () {\r\n    function SPSParser() {\r\n        _classCallCheck(this, SPSParser);\r\n    }\r\n\r\n    _createClass(SPSParser, null, [{\r\n        key: '_ebsp2rbsp',\r\n        value: function _ebsp2rbsp(uint8array) {\r\n            var src = uint8array;\r\n            var src_length = src.byteLength;\r\n            var dst = new Uint8Array(src_length);\r\n            var dst_idx = 0;\r\n\r\n            for (var i = 0; i < src_length; i++) {\r\n                if (i >= 2) {\r\n                    // Unescape: Skip 0x03 after 00 00\r\n                    if (src[i] === 0x03 && src[i - 1] === 0x00 && src[i - 2] === 0x00) {\r\n                        continue;\r\n                    }\r\n                }\r\n                dst[dst_idx] = src[i];\r\n                dst_idx++;\r\n            }\r\n\r\n            return new Uint8Array(dst.buffer, 0, dst_idx);\r\n        }\r\n    }, {\r\n        key: 'parseSPS',\r\n        value: function parseSPS(uint8array) {\r\n            var rbsp = SPSParser._ebsp2rbsp(uint8array);\r\n            var gb = new _expGolomb2.default(rbsp);\r\n\r\n            gb.readByte();\r\n            var profile_idc = gb.readByte(); // profile_idc\r\n            gb.readByte(); // constraint_set_flags[5] + reserved_zero[3]\r\n            var level_idc = gb.readByte(); // level_idc\r\n            gb.readUEG(); // seq_parameter_set_id\r\n\r\n            var profile_string = SPSParser.getProfileString(profile_idc);\r\n            var level_string = SPSParser.getLevelString(level_idc);\r\n            var chroma_format_idc = 1;\r\n            var chroma_format = 420;\r\n            var chroma_format_table = [0, 420, 422, 444];\r\n            var bit_depth = 8;\r\n\r\n            if (profile_idc === 100 || profile_idc === 110 || profile_idc === 122 || profile_idc === 244 || profile_idc === 44 || profile_idc === 83 || profile_idc === 86 || profile_idc === 118 || profile_idc === 128 || profile_idc === 138 || profile_idc === 144) {\r\n\r\n                chroma_format_idc = gb.readUEG();\r\n                if (chroma_format_idc === 3) {\r\n                    gb.readBits(1); // separate_colour_plane_flag\r\n                }\r\n                if (chroma_format_idc <= 3) {\r\n                    chroma_format = chroma_format_table[chroma_format_idc];\r\n                }\r\n\r\n                bit_depth = gb.readUEG() + 8; // bit_depth_luma_minus8\r\n                gb.readUEG(); // bit_depth_chroma_minus8\r\n                gb.readBits(1); // qpprime_y_zero_transform_bypass_flag\r\n                if (gb.readBool()) {\r\n                    // seq_scaling_matrix_present_flag\r\n                    var scaling_list_count = chroma_format_idc !== 3 ? 8 : 12;\r\n                    for (var i = 0; i < scaling_list_count; i++) {\r\n                        if (gb.readBool()) {\r\n                            // seq_scaling_list_present_flag\r\n                            if (i < 6) {\r\n                                SPSParser._skipScalingList(gb, 16);\r\n                            } else {\r\n                                SPSParser._skipScalingList(gb, 64);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            gb.readUEG(); // log2_max_frame_num_minus4\r\n            var pic_order_cnt_type = gb.readUEG();\r\n            if (pic_order_cnt_type === 0) {\r\n                gb.readUEG(); // log2_max_pic_order_cnt_lsb_minus_4\r\n            } else if (pic_order_cnt_type === 1) {\r\n                gb.readBits(1); // delta_pic_order_always_zero_flag\r\n                gb.readSEG(); // offset_for_non_ref_pic\r\n                gb.readSEG(); // offset_for_top_to_bottom_field\r\n                var num_ref_frames_in_pic_order_cnt_cycle = gb.readUEG();\r\n                for (var _i = 0; _i < num_ref_frames_in_pic_order_cnt_cycle; _i++) {\r\n                    gb.readSEG(); // offset_for_ref_frame\r\n                }\r\n            }\r\n            gb.readUEG(); // max_num_ref_frames\r\n            gb.readBits(1); // gaps_in_frame_num_value_allowed_flag\r\n\r\n            var pic_width_in_mbs_minus1 = gb.readUEG();\r\n            var pic_height_in_map_units_minus1 = gb.readUEG();\r\n\r\n            var frame_mbs_only_flag = gb.readBits(1);\r\n            if (frame_mbs_only_flag === 0) {\r\n                gb.readBits(1); // mb_adaptive_frame_field_flag\r\n            }\r\n            gb.readBits(1); // direct_8x8_inference_flag\r\n\r\n            var frame_crop_left_offset = 0;\r\n            var frame_crop_right_offset = 0;\r\n            var frame_crop_top_offset = 0;\r\n            var frame_crop_bottom_offset = 0;\r\n\r\n            var frame_cropping_flag = gb.readBool();\r\n            if (frame_cropping_flag) {\r\n                frame_crop_left_offset = gb.readUEG();\r\n                frame_crop_right_offset = gb.readUEG();\r\n                frame_crop_top_offset = gb.readUEG();\r\n                frame_crop_bottom_offset = gb.readUEG();\r\n            }\r\n\r\n            var sar_width = 1,\r\n                sar_height = 1;\r\n            var fps = 0,\r\n                fps_fixed = true,\r\n                fps_num = 0,\r\n                fps_den = 0;\r\n\r\n            var vui_parameters_present_flag = gb.readBool();\r\n            if (vui_parameters_present_flag) {\r\n                if (gb.readBool()) {\r\n                    // aspect_ratio_info_present_flag\r\n                    var aspect_ratio_idc = gb.readByte();\r\n                    var sar_w_table = [1, 12, 10, 16, 40, 24, 20, 32, 80, 18, 15, 64, 160, 4, 3, 2];\r\n                    var sar_h_table = [1, 11, 11, 11, 33, 11, 11, 11, 33, 11, 11, 33, 99, 3, 2, 1];\r\n\r\n                    if (aspect_ratio_idc > 0 && aspect_ratio_idc < 16) {\r\n                        sar_width = sar_w_table[aspect_ratio_idc - 1];\r\n                        sar_height = sar_h_table[aspect_ratio_idc - 1];\r\n                    } else if (aspect_ratio_idc === 255) {\r\n                        sar_width = gb.readByte() << 8 | gb.readByte();\r\n                        sar_height = gb.readByte() << 8 | gb.readByte();\r\n                    }\r\n                }\r\n\r\n                if (gb.readBool()) {\r\n                    // overscan_info_present_flag\r\n                    gb.readBool(); // overscan_appropriate_flag\r\n                }\r\n                if (gb.readBool()) {\r\n                    // video_signal_type_present_flag\r\n                    gb.readBits(4); // video_format & video_full_range_flag\r\n                    if (gb.readBool()) {\r\n                        // colour_description_present_flag\r\n                        gb.readBits(24); // colour_primaries & transfer_characteristics & matrix_coefficients\r\n                    }\r\n                }\r\n                if (gb.readBool()) {\r\n                    // chroma_loc_info_present_flag\r\n                    gb.readUEG(); // chroma_sample_loc_type_top_field\r\n                    gb.readUEG(); // chroma_sample_loc_type_bottom_field\r\n                }\r\n                if (gb.readBool()) {\r\n                    // timing_info_present_flag\r\n                    var num_units_in_tick = gb.readBits(32);\r\n                    var time_scale = gb.readBits(32);\r\n                    fps_fixed = gb.readBool(); // fixed_frame_rate_flag\r\n\r\n                    fps_num = time_scale;\r\n                    fps_den = num_units_in_tick * 2;\r\n                    fps = fps_num / fps_den;\r\n                }\r\n            }\r\n\r\n            var sarScale = 1;\r\n            if (sar_width !== 1 || sar_height !== 1) {\r\n                sarScale = sar_width / sar_height;\r\n            }\r\n\r\n            var crop_unit_x = 0,\r\n                crop_unit_y = 0;\r\n            if (chroma_format_idc === 0) {\r\n                crop_unit_x = 1;\r\n                crop_unit_y = 2 - frame_mbs_only_flag;\r\n            } else {\r\n                var sub_wc = chroma_format_idc === 3 ? 1 : 2;\r\n                var sub_hc = chroma_format_idc === 1 ? 2 : 1;\r\n                crop_unit_x = sub_wc;\r\n                crop_unit_y = sub_hc * (2 - frame_mbs_only_flag);\r\n            }\r\n\r\n            var codec_width = (pic_width_in_mbs_minus1 + 1) * 16;\r\n            var codec_height = (2 - frame_mbs_only_flag) * ((pic_height_in_map_units_minus1 + 1) * 16);\r\n\r\n            codec_width -= (frame_crop_left_offset + frame_crop_right_offset) * crop_unit_x;\r\n            codec_height -= (frame_crop_top_offset + frame_crop_bottom_offset) * crop_unit_y;\r\n\r\n            var present_width = Math.ceil(codec_width * sarScale);\r\n\r\n            gb.destroy();\r\n            gb = null;\r\n\r\n            return {\r\n                profile_string: profile_string, // baseline, high, high10, ...\r\n                level_string: level_string, // 3, 3.1, 4, 4.1, 5, 5.1, ...\r\n                bit_depth: bit_depth, // 8bit, 10bit, ...\r\n                chroma_format: chroma_format, // 4:2:0, 4:2:2, ...\r\n                chroma_format_string: SPSParser.getChromaFormatString(chroma_format),\r\n\r\n                frame_rate: {\r\n                    fixed: fps_fixed,\r\n                    fps: fps,\r\n                    fps_den: fps_den,\r\n                    fps_num: fps_num\r\n                },\r\n\r\n                sar_ratio: {\r\n                    width: sar_width,\r\n                    height: sar_height\r\n                },\r\n\r\n                codec_size: {\r\n                    width: codec_width,\r\n                    height: codec_height\r\n                },\r\n\r\n                present_size: {\r\n                    width: present_width,\r\n                    height: codec_height\r\n                }\r\n            };\r\n        }\r\n    }, {\r\n        key: '_skipScalingList',\r\n        value: function _skipScalingList(gb, count) {\r\n            var last_scale = 8,\r\n                next_scale = 8;\r\n            var delta_scale = 0;\r\n            for (var i = 0; i < count; i++) {\r\n                if (next_scale !== 0) {\r\n                    delta_scale = gb.readSEG();\r\n                    next_scale = (last_scale + delta_scale + 256) % 256;\r\n                }\r\n                last_scale = next_scale === 0 ? last_scale : next_scale;\r\n            }\r\n        }\r\n    }, {\r\n        key: 'getProfileString',\r\n        value: function getProfileString(profile_idc) {\r\n            switch (profile_idc) {\r\n                case 66:\r\n                    return 'Baseline';\r\n                case 77:\r\n                    return 'Main';\r\n                case 88:\r\n                    return 'Extended';\r\n                case 100:\r\n                    return 'High';\r\n                case 110:\r\n                    return 'High10';\r\n                case 122:\r\n                    return 'High422';\r\n                case 244:\r\n                    return 'High444';\r\n                default:\r\n                    return 'Unknown';\r\n            }\r\n        }\r\n    }, {\r\n        key: 'getLevelString',\r\n        value: function getLevelString(level_idc) {\r\n            return (level_idc / 10).toFixed(1);\r\n        }\r\n    }, {\r\n        key: 'getChromaFormatString',\r\n        value: function getChromaFormatString(chroma) {\r\n            switch (chroma) {\r\n                case 420:\r\n                    return '4:2:0';\r\n                case 422:\r\n                    return '4:2:2';\r\n                case 444:\r\n                    return '4:4:4';\r\n                default:\r\n                    return 'Unknown';\r\n            }\r\n        }\r\n    }]);\r\n\r\n    return SPSParser;\r\n}();\r\n\r\nexports.default = SPSParser;\r\n\r\n},{\"./exp-golomb.js\":17}],20:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; /*\r\n                                                                                                                                                                                                                                                                               * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                               * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                               * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                               * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                               * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                               * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                               * limitations under the License.\r\n                                                                                                                                                                                                                                                                               */\r\n\r\nvar _polyfill = _dereq_('./utils/polyfill.js');\r\n\r\nvar _polyfill2 = _interopRequireDefault(_polyfill);\r\n\r\nvar _features = _dereq_('./core/features.js');\r\n\r\nvar _features2 = _interopRequireDefault(_features);\r\n\r\nvar _flvPlayer = _dereq_('./player/flv-player.js');\r\n\r\nvar _flvPlayer2 = _interopRequireDefault(_flvPlayer);\r\n\r\nvar _nativePlayer = _dereq_('./player/native-player.js');\r\n\r\nvar _nativePlayer2 = _interopRequireDefault(_nativePlayer);\r\n\r\nvar _playerEvents = _dereq_('./player/player-events.js');\r\n\r\nvar _playerEvents2 = _interopRequireDefault(_playerEvents);\r\n\r\nvar _playerErrors = _dereq_('./player/player-errors.js');\r\n\r\nvar _loggingControl = _dereq_('./utils/logging-control.js');\r\n\r\nvar _loggingControl2 = _interopRequireDefault(_loggingControl);\r\n\r\nvar _exception = _dereq_('./utils/exception.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\n// here are all the interfaces\r\n\r\n// install polyfills\r\n_polyfill2.default.install();\r\n\r\n// factory method\r\nfunction createPlayer(mediaDataSource, optionalConfig) {\r\n    var mds = mediaDataSource;\r\n    if (mds == null || (typeof mds === 'undefined' ? 'undefined' : _typeof(mds)) !== 'object') {\r\n        throw new _exception.InvalidArgumentException('MediaDataSource must be an javascript object!');\r\n    }\r\n\r\n    if (!mds.hasOwnProperty('type')) {\r\n        throw new _exception.InvalidArgumentException('MediaDataSource must has type field to indicate video file type!');\r\n    }\r\n\r\n    switch (mds.type) {\r\n        case 'flv':\r\n            return new _flvPlayer2.default(mds, optionalConfig);\r\n        default:\r\n            return new _nativePlayer2.default(mds, optionalConfig);\r\n    }\r\n}\r\n\r\n// feature detection\r\nfunction isSupported() {\r\n    return _features2.default.supportMSEH264Playback();\r\n}\r\n\r\nfunction getFeatureList() {\r\n    return _features2.default.getFeatureList();\r\n}\r\n\r\n// interfaces\r\nvar flvjs = {};\r\n\r\nflvjs.createPlayer = createPlayer;\r\nflvjs.isSupported = isSupported;\r\nflvjs.getFeatureList = getFeatureList;\r\n\r\nflvjs.Events = _playerEvents2.default;\r\nflvjs.ErrorTypes = _playerErrors.ErrorTypes;\r\nflvjs.ErrorDetails = _playerErrors.ErrorDetails;\r\n\r\nflvjs.FlvPlayer = _flvPlayer2.default;\r\nflvjs.NativePlayer = _nativePlayer2.default;\r\nflvjs.LoggingControl = _loggingControl2.default;\r\n\r\nObject.defineProperty(flvjs, 'version', {\r\n    enumerable: true,\r\n    get: function get() {\r\n        // replaced by browserify-versionify transform\r\n        return '1.3.2';\r\n    }\r\n});\r\n\r\nexports.default = flvjs;\r\n\r\n},{\"./core/features.js\":6,\"./player/flv-player.js\":32,\"./player/native-player.js\":33,\"./player/player-errors.js\":34,\"./player/player-events.js\":35,\"./utils/exception.js\":40,\"./utils/logging-control.js\":42,\"./utils/polyfill.js\":43}],21:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\n// entry/index file\r\n\r\n// make it compatible with browserify's umd wrapper\r\nmodule.exports = _dereq_('./flv.js').default;\r\n\r\n},{\"./flv.js\":20}],22:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\r\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nvar _logger = _dereq_('../utils/logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nvar _browser = _dereq_('../utils/browser.js');\r\n\r\nvar _browser2 = _interopRequireDefault(_browser);\r\n\r\nvar _loader = _dereq_('./loader.js');\r\n\r\nvar _exception = _dereq_('../utils/exception.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\r\n\r\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\r\n\r\n/* fetch + stream IO loader. Currently working on chrome 43+.\r\n * fetch provides a better alternative http API to XMLHttpRequest\r\n *\r\n * fetch spec   https://fetch.spec.whatwg.org/\r\n * stream spec  https://streams.spec.whatwg.org/\r\n */\r\nvar FetchStreamLoader = function (_BaseLoader) {\r\n    _inherits(FetchStreamLoader, _BaseLoader);\r\n\r\n    _createClass(FetchStreamLoader, null, [{\r\n        key: 'isSupported',\r\n        value: function isSupported() {\r\n            try {\r\n                // fetch + stream is broken on Microsoft Edge. Disable before build 15048.\r\n                // see https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8196907/\r\n                // Fixed in Jan 10, 2017. Build 15048+ removed from blacklist.\r\n                var isWorkWellEdge = _browser2.default.msedge && _browser2.default.version.minor >= 15048;\r\n                var browserNotBlacklisted = _browser2.default.msedge ? isWorkWellEdge : true;\r\n                return self.fetch && self.ReadableStream && browserNotBlacklisted;\r\n            } catch (e) {\r\n                return false;\r\n            }\r\n        }\r\n    }]);\r\n\r\n    function FetchStreamLoader(seekHandler, config) {\r\n        _classCallCheck(this, FetchStreamLoader);\r\n\r\n        var _this = _possibleConstructorReturn(this, (FetchStreamLoader.__proto__ || Object.getPrototypeOf(FetchStreamLoader)).call(this, 'fetch-stream-loader'));\r\n\r\n        _this.TAG = 'FetchStreamLoader';\r\n\r\n        _this._seekHandler = seekHandler;\r\n        _this._config = config;\r\n        _this._needStash = true;\r\n\r\n        _this._requestAbort = false;\r\n        _this._contentLength = null;\r\n        _this._receivedLength = 0;\r\n        return _this;\r\n    }\r\n\r\n    _createClass(FetchStreamLoader, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            if (this.isWorking()) {\r\n                this.abort();\r\n            }\r\n            _get(FetchStreamLoader.prototype.__proto__ || Object.getPrototypeOf(FetchStreamLoader.prototype), 'destroy', this).call(this);\r\n        }\r\n    }, {\r\n        key: 'open',\r\n        value: function open(dataSource, range) {\r\n            var _this2 = this;\r\n\r\n            this._dataSource = dataSource;\r\n            this._range = range;\r\n\r\n            var sourceURL = dataSource.url;\r\n            if (this._config.reuseRedirectedURL && dataSource.redirectedURL != undefined) {\r\n                sourceURL = dataSource.redirectedURL;\r\n            }\r\n\r\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\r\n\r\n            var headers = new self.Headers();\r\n\r\n            if (_typeof(seekConfig.headers) === 'object') {\r\n                var configHeaders = seekConfig.headers;\r\n                for (var key in configHeaders) {\r\n                    if (configHeaders.hasOwnProperty(key)) {\r\n                        headers.append(key, configHeaders[key]);\r\n                    }\r\n                }\r\n            }\r\n\r\n            var params = {\r\n                method: 'GET',\r\n                headers: headers,\r\n                mode: 'cors',\r\n                cache: 'default',\r\n                // The default policy of Fetch API in the whatwg standard\r\n                // Safari incorrectly indicates 'no-referrer' as default policy, fuck it\r\n                referrerPolicy: 'no-referrer-when-downgrade'\r\n            };\r\n\r\n            // cors is enabled by default\r\n            if (dataSource.cors === false) {\r\n                // no-cors means 'disregard cors policy', which can only be used in ServiceWorker\r\n                params.mode = 'same-origin';\r\n            }\r\n\r\n            // withCredentials is disabled by default\r\n            if (dataSource.withCredentials) {\r\n                params.credentials = 'include';\r\n            }\r\n\r\n            // referrerPolicy from config\r\n            if (dataSource.referrerPolicy) {\r\n                params.referrerPolicy = dataSource.referrerPolicy;\r\n            }\r\n\r\n            this._status = _loader.LoaderStatus.kConnecting;\r\n            self.fetch(seekConfig.url, params).then(function (res) {\r\n                if (_this2._requestAbort) {\r\n                    _this2._requestAbort = false;\r\n                    _this2._status = _loader.LoaderStatus.kIdle;\r\n                    return;\r\n                }\r\n                if (res.ok && res.status >= 200 && res.status <= 299) {\r\n                    if (res.url !== seekConfig.url) {\r\n                        if (_this2._onURLRedirect) {\r\n                            var redirectedURL = _this2._seekHandler.removeURLParameters(res.url);\r\n                            _this2._onURLRedirect(redirectedURL);\r\n                        }\r\n                    }\r\n\r\n                    var lengthHeader = res.headers.get('Content-Length');\r\n                    if (lengthHeader != null) {\r\n                        _this2._contentLength = parseInt(lengthHeader);\r\n                        if (_this2._contentLength !== 0) {\r\n                            if (_this2._onContentLengthKnown) {\r\n                                _this2._onContentLengthKnown(_this2._contentLength);\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    return _this2._pump.call(_this2, res.body.getReader());\r\n                } else {\r\n                    _this2._status = _loader.LoaderStatus.kError;\r\n                    if (_this2._onError) {\r\n                        _this2._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: res.status, msg: res.statusText });\r\n                    } else {\r\n                        throw new _exception.RuntimeException('FetchStreamLoader: Http code invalid, ' + res.status + ' ' + res.statusText);\r\n                    }\r\n                }\r\n            }).catch(function (e) {\r\n                _this2._status = _loader.LoaderStatus.kError;\r\n                if (_this2._onError) {\r\n                    _this2._onError(_loader.LoaderErrors.EXCEPTION, { code: -1, msg: e.message });\r\n                } else {\r\n                    throw e;\r\n                }\r\n            });\r\n        }\r\n    }, {\r\n        key: 'abort',\r\n        value: function abort() {\r\n            this._requestAbort = true;\r\n        }\r\n    }, {\r\n        key: '_pump',\r\n        value: function _pump(reader) {\r\n            var _this3 = this;\r\n\r\n            // ReadableStreamReader\r\n            return reader.read().then(function (result) {\r\n                if (result.done) {\r\n                    _this3._status = _loader.LoaderStatus.kComplete;\r\n                    if (_this3._onComplete) {\r\n                        _this3._onComplete(_this3._range.from, _this3._range.from + _this3._receivedLength - 1);\r\n                    }\r\n                } else {\r\n                    if (_this3._requestAbort === true) {\r\n                        _this3._requestAbort = false;\r\n                        _this3._status = _loader.LoaderStatus.kComplete;\r\n                        return reader.cancel();\r\n                    }\r\n\r\n                    _this3._status = _loader.LoaderStatus.kBuffering;\r\n\r\n                    var chunk = result.value.buffer;\r\n                    var byteStart = _this3._range.from + _this3._receivedLength;\r\n                    _this3._receivedLength += chunk.byteLength;\r\n\r\n                    if (_this3._onDataArrival) {\r\n                        _this3._onDataArrival(chunk, byteStart, _this3._receivedLength);\r\n                    }\r\n\r\n                    return _this3._pump(reader);\r\n                }\r\n            }).catch(function (e) {\r\n                if (e.code === 11 && _browser2.default.msedge) {\r\n                    // InvalidStateError on Microsoft Edge\r\n                    // Workaround: Edge may throw InvalidStateError after ReadableStreamReader.cancel() call\r\n                    // Ignore the unknown exception.\r\n                    // Related issue: https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/11265202/\r\n                    return;\r\n                }\r\n\r\n                _this3._status = _loader.LoaderStatus.kError;\r\n                var type = 0;\r\n                var info = null;\r\n\r\n                if ((e.code === 19 || e.message === 'network error') && ( // NETWORK_ERR\r\n                _this3._contentLength === null || _this3._contentLength !== null && _this3._receivedLength < _this3._contentLength)) {\r\n                    type = _loader.LoaderErrors.EARLY_EOF;\r\n                    info = { code: e.code, msg: 'Fetch stream meet Early-EOF' };\r\n                } else {\r\n                    type = _loader.LoaderErrors.EXCEPTION;\r\n                    info = { code: e.code, msg: e.message };\r\n                }\r\n\r\n                if (_this3._onError) {\r\n                    _this3._onError(type, info);\r\n                } else {\r\n                    throw new _exception.RuntimeException(info.msg);\r\n                }\r\n            });\r\n        }\r\n    }]);\r\n\r\n    return FetchStreamLoader;\r\n}(_loader.BaseLoader);\r\n\r\nexports.default = FetchStreamLoader;\r\n\r\n},{\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],23:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _logger = _dereq_('../utils/logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nvar _speedSampler = _dereq_('./speed-sampler.js');\r\n\r\nvar _speedSampler2 = _interopRequireDefault(_speedSampler);\r\n\r\nvar _loader = _dereq_('./loader.js');\r\n\r\nvar _fetchStreamLoader = _dereq_('./fetch-stream-loader.js');\r\n\r\nvar _fetchStreamLoader2 = _interopRequireDefault(_fetchStreamLoader);\r\n\r\nvar _xhrMozChunkedLoader = _dereq_('./xhr-moz-chunked-loader.js');\r\n\r\nvar _xhrMozChunkedLoader2 = _interopRequireDefault(_xhrMozChunkedLoader);\r\n\r\nvar _xhrMsstreamLoader = _dereq_('./xhr-msstream-loader.js');\r\n\r\nvar _xhrMsstreamLoader2 = _interopRequireDefault(_xhrMsstreamLoader);\r\n\r\nvar _xhrRangeLoader = _dereq_('./xhr-range-loader.js');\r\n\r\nvar _xhrRangeLoader2 = _interopRequireDefault(_xhrRangeLoader);\r\n\r\nvar _websocketLoader = _dereq_('./websocket-loader.js');\r\n\r\nvar _websocketLoader2 = _interopRequireDefault(_websocketLoader);\r\n\r\nvar _rangeSeekHandler = _dereq_('./range-seek-handler.js');\r\n\r\nvar _rangeSeekHandler2 = _interopRequireDefault(_rangeSeekHandler);\r\n\r\nvar _paramSeekHandler = _dereq_('./param-seek-handler.js');\r\n\r\nvar _paramSeekHandler2 = _interopRequireDefault(_paramSeekHandler);\r\n\r\nvar _exception = _dereq_('../utils/exception.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n/**\r\n * DataSource: {\r\n *     url: string,\r\n *     filesize: number,\r\n *     cors: boolean,\r\n *     withCredentials: boolean\r\n * }\r\n * \r\n */\r\n\r\n// Manage IO Loaders\r\nvar IOController = function () {\r\n    function IOController(dataSource, config, extraData) {\r\n        _classCallCheck(this, IOController);\r\n\r\n        this.TAG = 'IOController';\r\n\r\n        this._config = config;\r\n        this._extraData = extraData;\r\n\r\n        this._stashInitialSize = 1024 * 384; // default initial size: 384KB\r\n        if (config.stashInitialSize != undefined && config.stashInitialSize > 0) {\r\n            // apply from config\r\n            this._stashInitialSize = config.stashInitialSize;\r\n        }\r\n\r\n        this._stashUsed = 0;\r\n        this._stashSize = this._stashInitialSize;\r\n        this._bufferSize = 1024 * 1024 * 3; // initial size: 3MB\r\n        this._stashBuffer = new ArrayBuffer(this._bufferSize);\r\n        this._stashByteStart = 0;\r\n        this._enableStash = true;\r\n        if (config.enableStashBuffer === false) {\r\n            this._enableStash = false;\r\n        }\r\n\r\n        this._loader = null;\r\n        this._loaderClass = null;\r\n        this._seekHandler = null;\r\n\r\n        this._dataSource = dataSource;\r\n        this._isWebSocketURL = /wss?:\\/\\/(.+?)/.test(dataSource.url);\r\n        this._refTotalLength = dataSource.filesize ? dataSource.filesize : null;\r\n        this._totalLength = this._refTotalLength;\r\n        this._fullRequestFlag = false;\r\n        this._currentRange = null;\r\n        this._redirectedURL = null;\r\n\r\n        this._speedNormalized = 0;\r\n        this._speedSampler = new _speedSampler2.default();\r\n        this._speedNormalizeList = [64, 128, 256, 384, 512, 768, 1024, 1536, 2048, 3072, 4096];\r\n\r\n        this._isEarlyEofReconnecting = false;\r\n\r\n        this._paused = false;\r\n        this._resumeFrom = 0;\r\n\r\n        this._onDataArrival = null;\r\n        this._onSeeked = null;\r\n        this._onError = null;\r\n        this._onComplete = null;\r\n        this._onRedirect = null;\r\n        this._onRecoveredEarlyEof = null;\r\n\r\n        this._selectSeekHandler();\r\n        this._selectLoader();\r\n        this._createLoader();\r\n    }\r\n\r\n    _createClass(IOController, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            if (this._loader.isWorking()) {\r\n                this._loader.abort();\r\n            }\r\n            this._loader.destroy();\r\n            this._loader = null;\r\n            this._loaderClass = null;\r\n            this._dataSource = null;\r\n            this._stashBuffer = null;\r\n            this._stashUsed = this._stashSize = this._bufferSize = this._stashByteStart = 0;\r\n            this._currentRange = null;\r\n            this._speedSampler = null;\r\n\r\n            this._isEarlyEofReconnecting = false;\r\n\r\n            this._onDataArrival = null;\r\n            this._onSeeked = null;\r\n            this._onError = null;\r\n            this._onComplete = null;\r\n            this._onRedirect = null;\r\n            this._onRecoveredEarlyEof = null;\r\n\r\n            this._extraData = null;\r\n        }\r\n    }, {\r\n        key: 'isWorking',\r\n        value: function isWorking() {\r\n            return this._loader && this._loader.isWorking() && !this._paused;\r\n        }\r\n    }, {\r\n        key: 'isPaused',\r\n        value: function isPaused() {\r\n            return this._paused;\r\n        }\r\n    }, {\r\n        key: '_selectSeekHandler',\r\n        value: function _selectSeekHandler() {\r\n            var config = this._config;\r\n\r\n            if (config.seekType === 'range') {\r\n                this._seekHandler = new _rangeSeekHandler2.default(this._config.rangeLoadZeroStart);\r\n            } else if (config.seekType === 'param') {\r\n                var paramStart = config.seekParamStart || 'bstart';\r\n                var paramEnd = config.seekParamEnd || 'bend';\r\n\r\n                this._seekHandler = new _paramSeekHandler2.default(paramStart, paramEnd);\r\n            } else if (config.seekType === 'custom') {\r\n                if (typeof config.customSeekHandler !== 'function') {\r\n                    throw new _exception.InvalidArgumentException('Custom seekType specified in config but invalid customSeekHandler!');\r\n                }\r\n                this._seekHandler = new config.customSeekHandler();\r\n            } else {\r\n                throw new _exception.InvalidArgumentException('Invalid seekType in config: ' + config.seekType);\r\n            }\r\n        }\r\n    }, {\r\n        key: '_selectLoader',\r\n        value: function _selectLoader() {\r\n            if (this._isWebSocketURL) {\r\n                this._loaderClass = _websocketLoader2.default;\r\n            } else if (_fetchStreamLoader2.default.isSupported()) {\r\n                this._loaderClass = _fetchStreamLoader2.default;\r\n            } else if (_xhrMozChunkedLoader2.default.isSupported()) {\r\n                this._loaderClass = _xhrMozChunkedLoader2.default;\r\n            } else if (_xhrRangeLoader2.default.isSupported()) {\r\n                this._loaderClass = _xhrRangeLoader2.default;\r\n            } else {\r\n                throw new _exception.RuntimeException('Your browser doesn\\'t support xhr with arraybuffer responseType!');\r\n            }\r\n        }\r\n    }, {\r\n        key: '_createLoader',\r\n        value: function _createLoader() {\r\n            this._loader = new this._loaderClass(this._seekHandler, this._config);\r\n            if (this._loader.needStashBuffer === false) {\r\n                this._enableStash = false;\r\n            }\r\n            this._loader.onContentLengthKnown = this._onContentLengthKnown.bind(this);\r\n            this._loader.onURLRedirect = this._onURLRedirect.bind(this);\r\n            this._loader.onDataArrival = this._onLoaderChunkArrival.bind(this);\r\n            this._loader.onComplete = this._onLoaderComplete.bind(this);\r\n            this._loader.onError = this._onLoaderError.bind(this);\r\n        }\r\n    }, {\r\n        key: 'open',\r\n        value: function open(optionalFrom) {\r\n            this._currentRange = { from: 0, to: -1 };\r\n            if (optionalFrom) {\r\n                this._currentRange.from = optionalFrom;\r\n            }\r\n\r\n            this._speedSampler.reset();\r\n            if (!optionalFrom) {\r\n                this._fullRequestFlag = true;\r\n            }\r\n\r\n            this._loader.open(this._dataSource, Object.assign({}, this._currentRange));\r\n        }\r\n    }, {\r\n        key: 'abort',\r\n        value: function abort() {\r\n            this._loader.abort();\r\n\r\n            if (this._paused) {\r\n                this._paused = false;\r\n                this._resumeFrom = 0;\r\n            }\r\n        }\r\n    }, {\r\n        key: 'pause',\r\n        value: function pause() {\r\n            if (this.isWorking()) {\r\n                this._loader.abort();\r\n\r\n                if (this._stashUsed !== 0) {\r\n                    this._resumeFrom = this._stashByteStart;\r\n                    this._currentRange.to = this._stashByteStart - 1;\r\n                } else {\r\n                    this._resumeFrom = this._currentRange.to + 1;\r\n                }\r\n                this._stashUsed = 0;\r\n                this._stashByteStart = 0;\r\n                this._paused = true;\r\n            }\r\n        }\r\n    }, {\r\n        key: 'resume',\r\n        value: function resume() {\r\n            if (this._paused) {\r\n                this._paused = false;\r\n                var bytes = this._resumeFrom;\r\n                this._resumeFrom = 0;\r\n                this._internalSeek(bytes, true);\r\n            }\r\n        }\r\n    }, {\r\n        key: 'seek',\r\n        value: function seek(bytes) {\r\n            this._paused = false;\r\n            this._stashUsed = 0;\r\n            this._stashByteStart = 0;\r\n            this._internalSeek(bytes, true);\r\n        }\r\n\r\n        /**\r\n         * When seeking request is from media seeking, unconsumed stash data should be dropped\r\n         * However, stash data shouldn't be dropped if seeking requested from http reconnection\r\n         *\r\n         * @dropUnconsumed: Ignore and discard all unconsumed data in stash buffer\r\n         */\r\n\r\n    }, {\r\n        key: '_internalSeek',\r\n        value: function _internalSeek(bytes, dropUnconsumed) {\r\n            if (this._loader.isWorking()) {\r\n                this._loader.abort();\r\n            }\r\n\r\n            // dispatch & flush stash buffer before seek\r\n            this._flushStashBuffer(dropUnconsumed);\r\n\r\n            this._loader.destroy();\r\n            this._loader = null;\r\n\r\n            var requestRange = { from: bytes, to: -1 };\r\n            this._currentRange = { from: requestRange.from, to: -1 };\r\n\r\n            this._speedSampler.reset();\r\n            this._stashSize = this._stashInitialSize;\r\n            this._createLoader();\r\n            this._loader.open(this._dataSource, requestRange);\r\n\r\n            if (this._onSeeked) {\r\n                this._onSeeked();\r\n            }\r\n        }\r\n    }, {\r\n        key: 'updateUrl',\r\n        value: function updateUrl(url) {\r\n            if (!url || typeof url !== 'string' || url.length === 0) {\r\n                throw new _exception.InvalidArgumentException('Url must be a non-empty string!');\r\n            }\r\n\r\n            this._dataSource.url = url;\r\n\r\n            // TODO: replace with new url\r\n        }\r\n    }, {\r\n        key: '_expandBuffer',\r\n        value: function _expandBuffer(expectedBytes) {\r\n            var bufferNewSize = this._stashSize;\r\n            while (bufferNewSize + 1024 * 1024 * 1 < expectedBytes) {\r\n                bufferNewSize *= 2;\r\n            }\r\n\r\n            bufferNewSize += 1024 * 1024 * 1; // bufferSize = stashSize + 1MB\r\n            if (bufferNewSize === this._bufferSize) {\r\n                return;\r\n            }\r\n\r\n            var newBuffer = new ArrayBuffer(bufferNewSize);\r\n\r\n            if (this._stashUsed > 0) {\r\n                // copy existing data into new buffer\r\n                var stashOldArray = new Uint8Array(this._stashBuffer, 0, this._stashUsed);\r\n                var stashNewArray = new Uint8Array(newBuffer, 0, bufferNewSize);\r\n                stashNewArray.set(stashOldArray, 0);\r\n            }\r\n\r\n            this._stashBuffer = newBuffer;\r\n            this._bufferSize = bufferNewSize;\r\n        }\r\n    }, {\r\n        key: '_normalizeSpeed',\r\n        value: function _normalizeSpeed(input) {\r\n            var list = this._speedNormalizeList;\r\n            var last = list.length - 1;\r\n            var mid = 0;\r\n            var lbound = 0;\r\n            var ubound = last;\r\n\r\n            if (input < list[0]) {\r\n                return list[0];\r\n            }\r\n\r\n            // binary search\r\n            while (lbound <= ubound) {\r\n                mid = lbound + Math.floor((ubound - lbound) / 2);\r\n                if (mid === last || input >= list[mid] && input < list[mid + 1]) {\r\n                    return list[mid];\r\n                } else if (list[mid] < input) {\r\n                    lbound = mid + 1;\r\n                } else {\r\n                    ubound = mid - 1;\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_adjustStashSize',\r\n        value: function _adjustStashSize(normalized) {\r\n            var stashSizeKB = 0;\r\n\r\n            if (this._config.isLive) {\r\n                // live stream: always use single normalized speed for size of stashSizeKB\r\n                stashSizeKB = normalized;\r\n            } else {\r\n                if (normalized < 512) {\r\n                    stashSizeKB = normalized;\r\n                } else if (normalized >= 512 && normalized <= 1024) {\r\n                    stashSizeKB = Math.floor(normalized * 1.5);\r\n                } else {\r\n                    stashSizeKB = normalized * 2;\r\n                }\r\n            }\r\n\r\n            if (stashSizeKB > 8192) {\r\n                stashSizeKB = 8192;\r\n            }\r\n\r\n            var bufferSize = stashSizeKB * 1024 + 1024 * 1024 * 1; // stashSize + 1MB\r\n            if (this._bufferSize < bufferSize) {\r\n                this._expandBuffer(bufferSize);\r\n            }\r\n            this._stashSize = stashSizeKB * 1024;\r\n        }\r\n    }, {\r\n        key: '_dispatchChunks',\r\n        value: function _dispatchChunks(chunks, byteStart) {\r\n            this._currentRange.to = byteStart + chunks.byteLength - 1;\r\n            return this._onDataArrival(chunks, byteStart);\r\n        }\r\n    }, {\r\n        key: '_onURLRedirect',\r\n        value: function _onURLRedirect(redirectedURL) {\r\n            this._redirectedURL = redirectedURL;\r\n            if (this._onRedirect) {\r\n                this._onRedirect(redirectedURL);\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onContentLengthKnown',\r\n        value: function _onContentLengthKnown(contentLength) {\r\n            if (contentLength && this._fullRequestFlag) {\r\n                this._totalLength = contentLength;\r\n                this._fullRequestFlag = false;\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onLoaderChunkArrival',\r\n        value: function _onLoaderChunkArrival(chunk, byteStart, receivedLength) {\r\n            if (!this._onDataArrival) {\r\n                throw new _exception.IllegalStateException('IOController: No existing consumer (onDataArrival) callback!');\r\n            }\r\n            if (this._paused) {\r\n                return;\r\n            }\r\n            if (this._isEarlyEofReconnecting) {\r\n                // Auto-reconnect for EarlyEof succeed, notify to upper-layer by callback\r\n                this._isEarlyEofReconnecting = false;\r\n                if (this._onRecoveredEarlyEof) {\r\n                    this._onRecoveredEarlyEof();\r\n                }\r\n            }\r\n\r\n            this._speedSampler.addBytes(chunk.byteLength);\r\n\r\n            // adjust stash buffer size according to network speed dynamically\r\n            var KBps = this._speedSampler.lastSecondKBps;\r\n            if (KBps !== 0) {\r\n                var normalized = this._normalizeSpeed(KBps);\r\n                if (this._speedNormalized !== normalized) {\r\n                    this._speedNormalized = normalized;\r\n                    this._adjustStashSize(normalized);\r\n                }\r\n            }\r\n\r\n            if (!this._enableStash) {\r\n                // disable stash\r\n                if (this._stashUsed === 0) {\r\n                    // dispatch chunk directly to consumer;\r\n                    // check ret value (consumed bytes) and stash unconsumed to stashBuffer\r\n                    var consumed = this._dispatchChunks(chunk, byteStart);\r\n                    if (consumed < chunk.byteLength) {\r\n                        // unconsumed data remain.\r\n                        var remain = chunk.byteLength - consumed;\r\n                        if (remain > this._bufferSize) {\r\n                            this._expandBuffer(remain);\r\n                        }\r\n                        var stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\r\n                        stashArray.set(new Uint8Array(chunk, consumed), 0);\r\n                        this._stashUsed += remain;\r\n                        this._stashByteStart = byteStart + consumed;\r\n                    }\r\n                } else {\r\n                    // else: Merge chunk into stashBuffer, and dispatch stashBuffer to consumer.\r\n                    if (this._stashUsed + chunk.byteLength > this._bufferSize) {\r\n                        this._expandBuffer(this._stashUsed + chunk.byteLength);\r\n                    }\r\n                    var _stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\r\n                    _stashArray.set(new Uint8Array(chunk), this._stashUsed);\r\n                    this._stashUsed += chunk.byteLength;\r\n                    var _consumed = this._dispatchChunks(this._stashBuffer.slice(0, this._stashUsed), this._stashByteStart);\r\n                    if (_consumed < this._stashUsed && _consumed > 0) {\r\n                        // unconsumed data remain\r\n                        var remainArray = new Uint8Array(this._stashBuffer, _consumed);\r\n                        _stashArray.set(remainArray, 0);\r\n                    }\r\n                    this._stashUsed -= _consumed;\r\n                    this._stashByteStart += _consumed;\r\n                }\r\n            } else {\r\n                // enable stash\r\n                if (this._stashUsed === 0 && this._stashByteStart === 0) {\r\n                    // seeked? or init chunk?\r\n                    // This is the first chunk after seek action\r\n                    this._stashByteStart = byteStart;\r\n                }\r\n                if (this._stashUsed + chunk.byteLength <= this._stashSize) {\r\n                    // just stash\r\n                    var _stashArray2 = new Uint8Array(this._stashBuffer, 0, this._stashSize);\r\n                    _stashArray2.set(new Uint8Array(chunk), this._stashUsed);\r\n                    this._stashUsed += chunk.byteLength;\r\n                } else {\r\n                    // stashUsed + chunkSize > stashSize, size limit exceeded\r\n                    var _stashArray3 = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\r\n                    if (this._stashUsed > 0) {\r\n                        // There're stash datas in buffer\r\n                        // dispatch the whole stashBuffer, and stash remain data\r\n                        // then append chunk to stashBuffer (stash)\r\n                        var buffer = this._stashBuffer.slice(0, this._stashUsed);\r\n                        var _consumed2 = this._dispatchChunks(buffer, this._stashByteStart);\r\n                        if (_consumed2 < buffer.byteLength) {\r\n                            if (_consumed2 > 0) {\r\n                                var _remainArray = new Uint8Array(buffer, _consumed2);\r\n                                _stashArray3.set(_remainArray, 0);\r\n                                this._stashUsed = _remainArray.byteLength;\r\n                                this._stashByteStart += _consumed2;\r\n                            }\r\n                        } else {\r\n                            this._stashUsed = 0;\r\n                            this._stashByteStart += _consumed2;\r\n                        }\r\n                        if (this._stashUsed + chunk.byteLength > this._bufferSize) {\r\n                            this._expandBuffer(this._stashUsed + chunk.byteLength);\r\n                            _stashArray3 = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\r\n                        }\r\n                        _stashArray3.set(new Uint8Array(chunk), this._stashUsed);\r\n                        this._stashUsed += chunk.byteLength;\r\n                    } else {\r\n                        // stash buffer empty, but chunkSize > stashSize (oh, holy shit)\r\n                        // dispatch chunk directly and stash remain data\r\n                        var _consumed3 = this._dispatchChunks(chunk, byteStart);\r\n                        if (_consumed3 < chunk.byteLength) {\r\n                            var _remain = chunk.byteLength - _consumed3;\r\n                            if (_remain > this._bufferSize) {\r\n                                this._expandBuffer(_remain);\r\n                                _stashArray3 = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\r\n                            }\r\n                            _stashArray3.set(new Uint8Array(chunk, _consumed3), 0);\r\n                            this._stashUsed += _remain;\r\n                            this._stashByteStart = byteStart + _consumed3;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_flushStashBuffer',\r\n        value: function _flushStashBuffer(dropUnconsumed) {\r\n            if (this._stashUsed > 0) {\r\n                var buffer = this._stashBuffer.slice(0, this._stashUsed);\r\n                var consumed = this._dispatchChunks(buffer, this._stashByteStart);\r\n                var remain = buffer.byteLength - consumed;\r\n\r\n                if (consumed < buffer.byteLength) {\r\n                    if (dropUnconsumed) {\r\n                        _logger2.default.w(this.TAG, remain + ' bytes unconsumed data remain when flush buffer, dropped');\r\n                    } else {\r\n                        if (consumed > 0) {\r\n                            var stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\r\n                            var remainArray = new Uint8Array(buffer, consumed);\r\n                            stashArray.set(remainArray, 0);\r\n                            this._stashUsed = remainArray.byteLength;\r\n                            this._stashByteStart += consumed;\r\n                        }\r\n                        return 0;\r\n                    }\r\n                }\r\n                this._stashUsed = 0;\r\n                this._stashByteStart = 0;\r\n                return remain;\r\n            }\r\n            return 0;\r\n        }\r\n    }, {\r\n        key: '_onLoaderComplete',\r\n        value: function _onLoaderComplete(from, to) {\r\n            // Force-flush stash buffer, and drop unconsumed data\r\n            this._flushStashBuffer(true);\r\n\r\n            if (this._onComplete) {\r\n                this._onComplete(this._extraData);\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onLoaderError',\r\n        value: function _onLoaderError(type, data) {\r\n            _logger2.default.e(this.TAG, 'Loader error, code = ' + data.code + ', msg = ' + data.msg);\r\n\r\n            this._flushStashBuffer(false);\r\n\r\n            if (this._isEarlyEofReconnecting) {\r\n                // Auto-reconnect for EarlyEof failed, throw UnrecoverableEarlyEof error to upper-layer\r\n                this._isEarlyEofReconnecting = false;\r\n                type = _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF;\r\n            }\r\n\r\n            switch (type) {\r\n                case _loader.LoaderErrors.EARLY_EOF:\r\n                    {\r\n                        if (!this._config.isLive) {\r\n                            // Do internal http reconnect if not live stream\r\n                            if (this._totalLength) {\r\n                                var nextFrom = this._currentRange.to + 1;\r\n                                if (nextFrom < this._totalLength) {\r\n                                    _logger2.default.w(this.TAG, 'Connection lost, trying reconnect...');\r\n                                    this._isEarlyEofReconnecting = true;\r\n                                    this._internalSeek(nextFrom, false);\r\n                                }\r\n                                return;\r\n                            }\r\n                            // else: We don't know totalLength, throw UnrecoverableEarlyEof\r\n                        }\r\n                        // live stream: throw UnrecoverableEarlyEof error to upper-layer\r\n                        type = _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF;\r\n                        break;\r\n                    }\r\n                case _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF:\r\n                case _loader.LoaderErrors.CONNECTING_TIMEOUT:\r\n                case _loader.LoaderErrors.HTTP_STATUS_CODE_INVALID:\r\n                case _loader.LoaderErrors.EXCEPTION:\r\n                    break;\r\n            }\r\n\r\n            if (this._onError) {\r\n                this._onError(type, data);\r\n            } else {\r\n                throw new _exception.RuntimeException('IOException: ' + data.msg);\r\n            }\r\n        }\r\n    }, {\r\n        key: 'status',\r\n        get: function get() {\r\n            return this._loader.status;\r\n        }\r\n    }, {\r\n        key: 'extraData',\r\n        get: function get() {\r\n            return this._extraData;\r\n        },\r\n        set: function set(data) {\r\n            this._extraData = data;\r\n        }\r\n\r\n        // prototype: function onDataArrival(chunks: ArrayBuffer, byteStart: number): number\r\n\r\n    }, {\r\n        key: 'onDataArrival',\r\n        get: function get() {\r\n            return this._onDataArrival;\r\n        },\r\n        set: function set(callback) {\r\n            this._onDataArrival = callback;\r\n        }\r\n    }, {\r\n        key: 'onSeeked',\r\n        get: function get() {\r\n            return this._onSeeked;\r\n        },\r\n        set: function set(callback) {\r\n            this._onSeeked = callback;\r\n        }\r\n\r\n        // prototype: function onError(type: number, info: {code: number, msg: string}): void\r\n\r\n    }, {\r\n        key: 'onError',\r\n        get: function get() {\r\n            return this._onError;\r\n        },\r\n        set: function set(callback) {\r\n            this._onError = callback;\r\n        }\r\n    }, {\r\n        key: 'onComplete',\r\n        get: function get() {\r\n            return this._onComplete;\r\n        },\r\n        set: function set(callback) {\r\n            this._onComplete = callback;\r\n        }\r\n    }, {\r\n        key: 'onRedirect',\r\n        get: function get() {\r\n            return this._onRedirect;\r\n        },\r\n        set: function set(callback) {\r\n            this._onRedirect = callback;\r\n        }\r\n    }, {\r\n        key: 'onRecoveredEarlyEof',\r\n        get: function get() {\r\n            return this._onRecoveredEarlyEof;\r\n        },\r\n        set: function set(callback) {\r\n            this._onRecoveredEarlyEof = callback;\r\n        }\r\n    }, {\r\n        key: 'currentURL',\r\n        get: function get() {\r\n            return this._dataSource.url;\r\n        }\r\n    }, {\r\n        key: 'hasRedirect',\r\n        get: function get() {\r\n            return this._redirectedURL != null || this._dataSource.redirectedURL != undefined;\r\n        }\r\n    }, {\r\n        key: 'currentRedirectedURL',\r\n        get: function get() {\r\n            return this._redirectedURL || this._dataSource.redirectedURL;\r\n        }\r\n\r\n        // in KB/s\r\n\r\n    }, {\r\n        key: 'currentSpeed',\r\n        get: function get() {\r\n            if (this._loaderClass === _xhrRangeLoader2.default) {\r\n                // SpeedSampler is inaccuracy if loader is RangeLoader\r\n                return this._loader.currentSpeed;\r\n            }\r\n            return this._speedSampler.lastSecondKBps;\r\n        }\r\n    }, {\r\n        key: 'loaderType',\r\n        get: function get() {\r\n            return this._loader.type;\r\n        }\r\n    }]);\r\n\r\n    return IOController;\r\n}();\r\n\r\nexports.default = IOController;\r\n\r\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./fetch-stream-loader.js\":22,\"./loader.js\":24,\"./param-seek-handler.js\":25,\"./range-seek-handler.js\":26,\"./speed-sampler.js\":27,\"./websocket-loader.js\":28,\"./xhr-moz-chunked-loader.js\":29,\"./xhr-msstream-loader.js\":30,\"./xhr-range-loader.js\":31}],24:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\nexports.BaseLoader = exports.LoaderErrors = exports.LoaderStatus = undefined;\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _exception = _dereq_('../utils/exception.js');\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nvar LoaderStatus = exports.LoaderStatus = {\r\n    kIdle: 0,\r\n    kConnecting: 1,\r\n    kBuffering: 2,\r\n    kError: 3,\r\n    kComplete: 4\r\n};\r\n\r\nvar LoaderErrors = exports.LoaderErrors = {\r\n    OK: 'OK',\r\n    EXCEPTION: 'Exception',\r\n    HTTP_STATUS_CODE_INVALID: 'HttpStatusCodeInvalid',\r\n    CONNECTING_TIMEOUT: 'ConnectingTimeout',\r\n    EARLY_EOF: 'EarlyEof',\r\n    UNRECOVERABLE_EARLY_EOF: 'UnrecoverableEarlyEof'\r\n};\r\n\r\n/* Loader has callbacks which have following prototypes:\r\n *     function onContentLengthKnown(contentLength: number): void\r\n *     function onURLRedirect(url: string): void\r\n *     function onDataArrival(chunk: ArrayBuffer, byteStart: number, receivedLength: number): void\r\n *     function onError(errorType: number, errorInfo: {code: number, msg: string}): void\r\n *     function onComplete(rangeFrom: number, rangeTo: number): void\r\n */\r\n\r\nvar BaseLoader = exports.BaseLoader = function () {\r\n    function BaseLoader(typeName) {\r\n        _classCallCheck(this, BaseLoader);\r\n\r\n        this._type = typeName || 'undefined';\r\n        this._status = LoaderStatus.kIdle;\r\n        this._needStash = false;\r\n        // callbacks\r\n        this._onContentLengthKnown = null;\r\n        this._onURLRedirect = null;\r\n        this._onDataArrival = null;\r\n        this._onError = null;\r\n        this._onComplete = null;\r\n    }\r\n\r\n    _createClass(BaseLoader, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            this._status = LoaderStatus.kIdle;\r\n            this._onContentLengthKnown = null;\r\n            this._onURLRedirect = null;\r\n            this._onDataArrival = null;\r\n            this._onError = null;\r\n            this._onComplete = null;\r\n        }\r\n    }, {\r\n        key: 'isWorking',\r\n        value: function isWorking() {\r\n            return this._status === LoaderStatus.kConnecting || this._status === LoaderStatus.kBuffering;\r\n        }\r\n    }, {\r\n        key: 'open',\r\n\r\n\r\n        // pure virtual\r\n        value: function open(dataSource, range) {\r\n            throw new _exception.NotImplementedException('Unimplemented abstract function!');\r\n        }\r\n    }, {\r\n        key: 'abort',\r\n        value: function abort() {\r\n            throw new _exception.NotImplementedException('Unimplemented abstract function!');\r\n        }\r\n    }, {\r\n        key: 'type',\r\n        get: function get() {\r\n            return this._type;\r\n        }\r\n    }, {\r\n        key: 'status',\r\n        get: function get() {\r\n            return this._status;\r\n        }\r\n    }, {\r\n        key: 'needStashBuffer',\r\n        get: function get() {\r\n            return this._needStash;\r\n        }\r\n    }, {\r\n        key: 'onContentLengthKnown',\r\n        get: function get() {\r\n            return this._onContentLengthKnown;\r\n        },\r\n        set: function set(callback) {\r\n            this._onContentLengthKnown = callback;\r\n        }\r\n    }, {\r\n        key: 'onURLRedirect',\r\n        get: function get() {\r\n            return this._onURLRedirect;\r\n        },\r\n        set: function set(callback) {\r\n            this._onURLRedirect = callback;\r\n        }\r\n    }, {\r\n        key: 'onDataArrival',\r\n        get: function get() {\r\n            return this._onDataArrival;\r\n        },\r\n        set: function set(callback) {\r\n            this._onDataArrival = callback;\r\n        }\r\n    }, {\r\n        key: 'onError',\r\n        get: function get() {\r\n            return this._onError;\r\n        },\r\n        set: function set(callback) {\r\n            this._onError = callback;\r\n        }\r\n    }, {\r\n        key: 'onComplete',\r\n        get: function get() {\r\n            return this._onComplete;\r\n        },\r\n        set: function set(callback) {\r\n            this._onComplete = callback;\r\n        }\r\n    }]);\r\n\r\n    return BaseLoader;\r\n}();\r\n\r\n},{\"../utils/exception.js\":40}],25:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nvar ParamSeekHandler = function () {\r\n    function ParamSeekHandler(paramStart, paramEnd) {\r\n        _classCallCheck(this, ParamSeekHandler);\r\n\r\n        this._startName = paramStart;\r\n        this._endName = paramEnd;\r\n    }\r\n\r\n    _createClass(ParamSeekHandler, [{\r\n        key: 'getConfig',\r\n        value: function getConfig(baseUrl, range) {\r\n            var url = baseUrl;\r\n\r\n            if (range.from !== 0 || range.to !== -1) {\r\n                var needAnd = true;\r\n                if (url.indexOf('?') === -1) {\r\n                    url += '?';\r\n                    needAnd = false;\r\n                }\r\n\r\n                if (needAnd) {\r\n                    url += '&';\r\n                }\r\n\r\n                url += this._startName + '=' + range.from.toString();\r\n\r\n                if (range.to !== -1) {\r\n                    url += '&' + this._endName + '=' + range.to.toString();\r\n                }\r\n            }\r\n\r\n            return {\r\n                url: url,\r\n                headers: {}\r\n            };\r\n        }\r\n    }, {\r\n        key: 'removeURLParameters',\r\n        value: function removeURLParameters(seekedURL) {\r\n            var baseURL = seekedURL.split('?')[0];\r\n            var params = undefined;\r\n\r\n            var queryIndex = seekedURL.indexOf('?');\r\n            if (queryIndex !== -1) {\r\n                params = seekedURL.substring(queryIndex + 1);\r\n            }\r\n\r\n            var resultParams = '';\r\n\r\n            if (params != undefined && params.length > 0) {\r\n                var pairs = params.split('&');\r\n\r\n                for (var i = 0; i < pairs.length; i++) {\r\n                    var pair = pairs[i].split('=');\r\n                    var requireAnd = i > 0;\r\n\r\n                    if (pair[0] !== this._startName && pair[0] !== this._endName) {\r\n                        if (requireAnd) {\r\n                            resultParams += '&';\r\n                        }\r\n                        resultParams += pairs[i];\r\n                    }\r\n                }\r\n            }\r\n\r\n            return resultParams.length === 0 ? baseURL : baseURL + '?' + resultParams;\r\n        }\r\n    }]);\r\n\r\n    return ParamSeekHandler;\r\n}();\r\n\r\nexports.default = ParamSeekHandler;\r\n\r\n},{}],26:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nvar RangeSeekHandler = function () {\r\n    function RangeSeekHandler(zeroStart) {\r\n        _classCallCheck(this, RangeSeekHandler);\r\n\r\n        this._zeroStart = zeroStart || false;\r\n    }\r\n\r\n    _createClass(RangeSeekHandler, [{\r\n        key: 'getConfig',\r\n        value: function getConfig(url, range) {\r\n            var headers = {};\r\n\r\n            if (range.from !== 0 || range.to !== -1) {\r\n                var param = void 0;\r\n                if (range.to !== -1) {\r\n                    param = 'bytes=' + range.from.toString() + '-' + range.to.toString();\r\n                } else {\r\n                    param = 'bytes=' + range.from.toString() + '-';\r\n                }\r\n                headers['Range'] = param;\r\n            } else if (this._zeroStart) {\r\n                headers['Range'] = 'bytes=0-';\r\n            }\r\n\r\n            return {\r\n                url: url,\r\n                headers: headers\r\n            };\r\n        }\r\n    }, {\r\n        key: 'removeURLParameters',\r\n        value: function removeURLParameters(seekedURL) {\r\n            return seekedURL;\r\n        }\r\n    }]);\r\n\r\n    return RangeSeekHandler;\r\n}();\r\n\r\nexports.default = RangeSeekHandler;\r\n\r\n},{}],27:[function(_dereq_,module,exports){\r\n\"use strict\";\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\n// Utility class to calculate realtime network I/O speed\r\nvar SpeedSampler = function () {\r\n    function SpeedSampler() {\r\n        _classCallCheck(this, SpeedSampler);\r\n\r\n        // milliseconds\r\n        this._firstCheckpoint = 0;\r\n        this._lastCheckpoint = 0;\r\n        this._intervalBytes = 0;\r\n        this._totalBytes = 0;\r\n        this._lastSecondBytes = 0;\r\n\r\n        // compatibility detection\r\n        if (self.performance && self.performance.now) {\r\n            this._now = self.performance.now.bind(self.performance);\r\n        } else {\r\n            this._now = Date.now;\r\n        }\r\n    }\r\n\r\n    _createClass(SpeedSampler, [{\r\n        key: \"reset\",\r\n        value: function reset() {\r\n            this._firstCheckpoint = this._lastCheckpoint = 0;\r\n            this._totalBytes = this._intervalBytes = 0;\r\n            this._lastSecondBytes = 0;\r\n        }\r\n    }, {\r\n        key: \"addBytes\",\r\n        value: function addBytes(bytes) {\r\n            if (this._firstCheckpoint === 0) {\r\n                this._firstCheckpoint = this._now();\r\n                this._lastCheckpoint = this._firstCheckpoint;\r\n                this._intervalBytes += bytes;\r\n                this._totalBytes += bytes;\r\n            } else if (this._now() - this._lastCheckpoint < 1000) {\r\n                this._intervalBytes += bytes;\r\n                this._totalBytes += bytes;\r\n            } else {\r\n                // duration >= 1000\r\n                this._lastSecondBytes = this._intervalBytes;\r\n                this._intervalBytes = bytes;\r\n                this._totalBytes += bytes;\r\n                this._lastCheckpoint = this._now();\r\n            }\r\n        }\r\n    }, {\r\n        key: \"currentKBps\",\r\n        get: function get() {\r\n            this.addBytes(0);\r\n\r\n            var durationSeconds = (this._now() - this._lastCheckpoint) / 1000;\r\n            if (durationSeconds == 0) durationSeconds = 1;\r\n            return this._intervalBytes / durationSeconds / 1024;\r\n        }\r\n    }, {\r\n        key: \"lastSecondKBps\",\r\n        get: function get() {\r\n            this.addBytes(0);\r\n\r\n            if (this._lastSecondBytes !== 0) {\r\n                return this._lastSecondBytes / 1024;\r\n            } else {\r\n                // lastSecondBytes === 0\r\n                if (this._now() - this._lastCheckpoint >= 500) {\r\n                    // if time interval since last checkpoint has exceeded 500ms\r\n                    // the speed is nearly accurate\r\n                    return this.currentKBps;\r\n                } else {\r\n                    // We don't know\r\n                    return 0;\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: \"averageKBps\",\r\n        get: function get() {\r\n            var durationSeconds = (this._now() - this._firstCheckpoint) / 1000;\r\n            return this._totalBytes / durationSeconds / 1024;\r\n        }\r\n    }]);\r\n\r\n    return SpeedSampler;\r\n}();\r\n\r\nexports.default = SpeedSampler;\r\n\r\n},{}],28:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nvar _logger = _dereq_('../utils/logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nvar _loader = _dereq_('./loader.js');\r\n\r\nvar _exception = _dereq_('../utils/exception.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\r\n\r\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\r\n\r\n// For FLV over WebSocket live stream\r\nvar WebSocketLoader = function (_BaseLoader) {\r\n    _inherits(WebSocketLoader, _BaseLoader);\r\n\r\n    _createClass(WebSocketLoader, null, [{\r\n        key: 'isSupported',\r\n        value: function isSupported() {\r\n            try {\r\n                return typeof self.WebSocket !== 'undefined';\r\n            } catch (e) {\r\n                return false;\r\n            }\r\n        }\r\n    }]);\r\n\r\n    function WebSocketLoader() {\r\n        _classCallCheck(this, WebSocketLoader);\r\n\r\n        var _this = _possibleConstructorReturn(this, (WebSocketLoader.__proto__ || Object.getPrototypeOf(WebSocketLoader)).call(this, 'websocket-loader'));\r\n\r\n        _this.TAG = 'WebSocketLoader';\r\n\r\n        _this._needStash = true;\r\n\r\n        _this._ws = null;\r\n        _this._requestAbort = false;\r\n        _this._receivedLength = 0;\r\n        return _this;\r\n    }\r\n\r\n    _createClass(WebSocketLoader, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            if (this._ws) {\r\n                this.abort();\r\n            }\r\n            _get(WebSocketLoader.prototype.__proto__ || Object.getPrototypeOf(WebSocketLoader.prototype), 'destroy', this).call(this);\r\n        }\r\n    }, {\r\n        key: 'open',\r\n        value: function open(dataSource) {\r\n            try {\r\n                var ws = this._ws = new self.WebSocket(dataSource.url);\r\n                ws.binaryType = 'arraybuffer';\r\n                ws.onopen = this._onWebSocketOpen.bind(this);\r\n                ws.onclose = this._onWebSocketClose.bind(this);\r\n                ws.onmessage = this._onWebSocketMessage.bind(this);\r\n                ws.onerror = this._onWebSocketError.bind(this);\r\n\r\n                this._status = _loader.LoaderStatus.kConnecting;\r\n            } catch (e) {\r\n                this._status = _loader.LoaderStatus.kError;\r\n\r\n                var info = { code: e.code, msg: e.message };\r\n\r\n                if (this._onError) {\r\n                    this._onError(_loader.LoaderErrors.EXCEPTION, info);\r\n                } else {\r\n                    throw new _exception.RuntimeException(info.msg);\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: 'abort',\r\n        value: function abort() {\r\n            var ws = this._ws;\r\n            if (ws && (ws.readyState === 0 || ws.readyState === 1)) {\r\n                // CONNECTING || OPEN\r\n                this._requestAbort = true;\r\n                ws.close();\r\n            }\r\n\r\n            this._ws = null;\r\n            this._status = _loader.LoaderStatus.kComplete;\r\n        }\r\n    }, {\r\n        key: '_onWebSocketOpen',\r\n        value: function _onWebSocketOpen(e) {\r\n            this._status = _loader.LoaderStatus.kBuffering;\r\n        }\r\n    }, {\r\n        key: '_onWebSocketClose',\r\n        value: function _onWebSocketClose(e) {\r\n            if (this._requestAbort === true) {\r\n                this._requestAbort = false;\r\n                return;\r\n            }\r\n\r\n            this._status = _loader.LoaderStatus.kComplete;\r\n\r\n            if (this._onComplete) {\r\n                this._onComplete(0, this._receivedLength - 1);\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onWebSocketMessage',\r\n        value: function _onWebSocketMessage(e) {\r\n            var _this2 = this;\r\n\r\n            if (e.data instanceof ArrayBuffer) {\r\n                this._dispatchArrayBuffer(e.data);\r\n            } else if (e.data instanceof Blob) {\r\n                var reader = new FileReader();\r\n                reader.onload = function () {\r\n                    _this2._dispatchArrayBuffer(reader.result);\r\n                };\r\n                reader.readAsArrayBuffer(e.data);\r\n            } else {\r\n                this._status = _loader.LoaderStatus.kError;\r\n                var info = { code: -1, msg: 'Unsupported WebSocket message type: ' + e.data.constructor.name };\r\n\r\n                if (this._onError) {\r\n                    this._onError(_loader.LoaderErrors.EXCEPTION, info);\r\n                } else {\r\n                    throw new _exception.RuntimeException(info.msg);\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_dispatchArrayBuffer',\r\n        value: function _dispatchArrayBuffer(arraybuffer) {\r\n            var chunk = arraybuffer;\r\n            var byteStart = this._receivedLength;\r\n            this._receivedLength += chunk.byteLength;\r\n\r\n            if (this._onDataArrival) {\r\n                this._onDataArrival(chunk, byteStart, this._receivedLength);\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onWebSocketError',\r\n        value: function _onWebSocketError(e) {\r\n            this._status = _loader.LoaderStatus.kError;\r\n\r\n            var info = {\r\n                code: e.code,\r\n                msg: e.message\r\n            };\r\n\r\n            if (this._onError) {\r\n                this._onError(_loader.LoaderErrors.EXCEPTION, info);\r\n            } else {\r\n                throw new _exception.RuntimeException(info.msg);\r\n            }\r\n        }\r\n    }]);\r\n\r\n    return WebSocketLoader;\r\n}(_loader.BaseLoader);\r\n\r\nexports.default = WebSocketLoader;\r\n\r\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],29:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\r\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nvar _logger = _dereq_('../utils/logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nvar _loader = _dereq_('./loader.js');\r\n\r\nvar _exception = _dereq_('../utils/exception.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\r\n\r\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\r\n\r\n// For FireFox browser which supports `xhr.responseType = 'moz-chunked-arraybuffer'`\r\nvar MozChunkedLoader = function (_BaseLoader) {\r\n    _inherits(MozChunkedLoader, _BaseLoader);\r\n\r\n    _createClass(MozChunkedLoader, null, [{\r\n        key: 'isSupported',\r\n        value: function isSupported() {\r\n            try {\r\n                var xhr = new XMLHttpRequest();\r\n                // Firefox 37- requires .open() to be called before setting responseType\r\n                xhr.open('GET', 'https://example.com', true);\r\n                xhr.responseType = 'moz-chunked-arraybuffer';\r\n                return xhr.responseType === 'moz-chunked-arraybuffer';\r\n            } catch (e) {\r\n                _logger2.default.w('MozChunkedLoader', e.message);\r\n                return false;\r\n            }\r\n        }\r\n    }]);\r\n\r\n    function MozChunkedLoader(seekHandler, config) {\r\n        _classCallCheck(this, MozChunkedLoader);\r\n\r\n        var _this = _possibleConstructorReturn(this, (MozChunkedLoader.__proto__ || Object.getPrototypeOf(MozChunkedLoader)).call(this, 'xhr-moz-chunked-loader'));\r\n\r\n        _this.TAG = 'MozChunkedLoader';\r\n\r\n        _this._seekHandler = seekHandler;\r\n        _this._config = config;\r\n        _this._needStash = true;\r\n\r\n        _this._xhr = null;\r\n        _this._requestAbort = false;\r\n        _this._contentLength = null;\r\n        _this._receivedLength = 0;\r\n        return _this;\r\n    }\r\n\r\n    _createClass(MozChunkedLoader, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            if (this.isWorking()) {\r\n                this.abort();\r\n            }\r\n            if (this._xhr) {\r\n                this._xhr.onreadystatechange = null;\r\n                this._xhr.onprogress = null;\r\n                this._xhr.onloadend = null;\r\n                this._xhr.onerror = null;\r\n                this._xhr = null;\r\n            }\r\n            _get(MozChunkedLoader.prototype.__proto__ || Object.getPrototypeOf(MozChunkedLoader.prototype), 'destroy', this).call(this);\r\n        }\r\n    }, {\r\n        key: 'open',\r\n        value: function open(dataSource, range) {\r\n            this._dataSource = dataSource;\r\n            this._range = range;\r\n\r\n            var sourceURL = dataSource.url;\r\n            if (this._config.reuseRedirectedURL && dataSource.redirectedURL != undefined) {\r\n                sourceURL = dataSource.redirectedURL;\r\n            }\r\n\r\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\r\n            this._requestURL = seekConfig.url;\r\n\r\n            var xhr = this._xhr = new XMLHttpRequest();\r\n            xhr.open('GET', seekConfig.url, true);\r\n            xhr.responseType = 'moz-chunked-arraybuffer';\r\n            xhr.onreadystatechange = this._onReadyStateChange.bind(this);\r\n            xhr.onprogress = this._onProgress.bind(this);\r\n            xhr.onloadend = this._onLoadEnd.bind(this);\r\n            xhr.onerror = this._onXhrError.bind(this);\r\n\r\n            // cors is auto detected and enabled by xhr\r\n\r\n            // withCredentials is disabled by default\r\n            if (dataSource.withCredentials && xhr['withCredentials']) {\r\n                xhr.withCredentials = true;\r\n            }\r\n\r\n            if (_typeof(seekConfig.headers) === 'object') {\r\n                var headers = seekConfig.headers;\r\n\r\n                for (var key in headers) {\r\n                    if (headers.hasOwnProperty(key)) {\r\n                        xhr.setRequestHeader(key, headers[key]);\r\n                    }\r\n                }\r\n            }\r\n\r\n            this._status = _loader.LoaderStatus.kConnecting;\r\n            xhr.send();\r\n        }\r\n    }, {\r\n        key: 'abort',\r\n        value: function abort() {\r\n            this._requestAbort = true;\r\n            if (this._xhr) {\r\n                this._xhr.abort();\r\n            }\r\n            this._status = _loader.LoaderStatus.kComplete;\r\n        }\r\n    }, {\r\n        key: '_onReadyStateChange',\r\n        value: function _onReadyStateChange(e) {\r\n            var xhr = e.target;\r\n\r\n            if (xhr.readyState === 2) {\r\n                // HEADERS_RECEIVED\r\n                if (xhr.responseURL != undefined && xhr.responseURL !== this._requestURL) {\r\n                    if (this._onURLRedirect) {\r\n                        var redirectedURL = this._seekHandler.removeURLParameters(xhr.responseURL);\r\n                        this._onURLRedirect(redirectedURL);\r\n                    }\r\n                }\r\n\r\n                if (xhr.status !== 0 && (xhr.status < 200 || xhr.status > 299)) {\r\n                    this._status = _loader.LoaderStatus.kError;\r\n                    if (this._onError) {\r\n                        this._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: xhr.status, msg: xhr.statusText });\r\n                    } else {\r\n                        throw new _exception.RuntimeException('MozChunkedLoader: Http code invalid, ' + xhr.status + ' ' + xhr.statusText);\r\n                    }\r\n                } else {\r\n                    this._status = _loader.LoaderStatus.kBuffering;\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onProgress',\r\n        value: function _onProgress(e) {\r\n            if (this._contentLength === null) {\r\n                if (e.total !== null && e.total !== 0) {\r\n                    this._contentLength = e.total;\r\n                    if (this._onContentLengthKnown) {\r\n                        this._onContentLengthKnown(this._contentLength);\r\n                    }\r\n                }\r\n            }\r\n\r\n            var chunk = e.target.response;\r\n            var byteStart = this._range.from + this._receivedLength;\r\n            this._receivedLength += chunk.byteLength;\r\n\r\n            if (this._onDataArrival) {\r\n                this._onDataArrival(chunk, byteStart, this._receivedLength);\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onLoadEnd',\r\n        value: function _onLoadEnd(e) {\r\n            if (this._requestAbort === true) {\r\n                this._requestAbort = false;\r\n                return;\r\n            } else if (this._status === _loader.LoaderStatus.kError) {\r\n                return;\r\n            }\r\n\r\n            this._status = _loader.LoaderStatus.kComplete;\r\n            if (this._onComplete) {\r\n                this._onComplete(this._range.from, this._range.from + this._receivedLength - 1);\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onXhrError',\r\n        value: function _onXhrError(e) {\r\n            this._status = _loader.LoaderStatus.kError;\r\n            var type = 0;\r\n            var info = null;\r\n\r\n            if (this._contentLength && e.loaded < this._contentLength) {\r\n                type = _loader.LoaderErrors.EARLY_EOF;\r\n                info = { code: -1, msg: 'Moz-Chunked stream meet Early-Eof' };\r\n            } else {\r\n                type = _loader.LoaderErrors.EXCEPTION;\r\n                info = { code: -1, msg: e.constructor.name + ' ' + e.type };\r\n            }\r\n\r\n            if (this._onError) {\r\n                this._onError(type, info);\r\n            } else {\r\n                throw new _exception.RuntimeException(info.msg);\r\n            }\r\n        }\r\n    }]);\r\n\r\n    return MozChunkedLoader;\r\n}(_loader.BaseLoader);\r\n\r\nexports.default = MozChunkedLoader;\r\n\r\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],30:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\r\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nvar _logger = _dereq_('../utils/logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nvar _loader = _dereq_('./loader.js');\r\n\r\nvar _exception = _dereq_('../utils/exception.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\r\n\r\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\r\n\r\n/* Notice: ms-stream may cause IE/Edge browser crash if seek too frequently!!!\r\n * The browser may crash in wininet.dll. Disable for now.\r\n *\r\n * For IE11/Edge browser by microsoft which supports `xhr.responseType = 'ms-stream'`\r\n * Notice that ms-stream API sucks. The buffer is always expanding along with downloading.\r\n *\r\n * We need to abort the xhr if buffer size exceeded limit size (e.g. 16 MiB), then do reconnect.\r\n * in order to release previous ArrayBuffer to avoid memory leak\r\n *\r\n * Otherwise, the ArrayBuffer will increase to a terrible size that equals final file size.\r\n */\r\nvar MSStreamLoader = function (_BaseLoader) {\r\n    _inherits(MSStreamLoader, _BaseLoader);\r\n\r\n    _createClass(MSStreamLoader, null, [{\r\n        key: 'isSupported',\r\n        value: function isSupported() {\r\n            try {\r\n                if (typeof self.MSStream === 'undefined' || typeof self.MSStreamReader === 'undefined') {\r\n                    return false;\r\n                }\r\n\r\n                var xhr = new XMLHttpRequest();\r\n                xhr.open('GET', 'https://example.com', true);\r\n                xhr.responseType = 'ms-stream';\r\n                return xhr.responseType === 'ms-stream';\r\n            } catch (e) {\r\n                _logger2.default.w('MSStreamLoader', e.message);\r\n                return false;\r\n            }\r\n        }\r\n    }]);\r\n\r\n    function MSStreamLoader(seekHandler, config) {\r\n        _classCallCheck(this, MSStreamLoader);\r\n\r\n        var _this = _possibleConstructorReturn(this, (MSStreamLoader.__proto__ || Object.getPrototypeOf(MSStreamLoader)).call(this, 'xhr-msstream-loader'));\r\n\r\n        _this.TAG = 'MSStreamLoader';\r\n\r\n        _this._seekHandler = seekHandler;\r\n        _this._config = config;\r\n        _this._needStash = true;\r\n\r\n        _this._xhr = null;\r\n        _this._reader = null; // MSStreamReader\r\n\r\n        _this._totalRange = null;\r\n        _this._currentRange = null;\r\n\r\n        _this._currentRequestURL = null;\r\n        _this._currentRedirectedURL = null;\r\n\r\n        _this._contentLength = null;\r\n        _this._receivedLength = 0;\r\n\r\n        _this._bufferLimit = 16 * 1024 * 1024; // 16MB\r\n        _this._lastTimeBufferSize = 0;\r\n        _this._isReconnecting = false;\r\n        return _this;\r\n    }\r\n\r\n    _createClass(MSStreamLoader, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            if (this.isWorking()) {\r\n                this.abort();\r\n            }\r\n            if (this._reader) {\r\n                this._reader.onprogress = null;\r\n                this._reader.onload = null;\r\n                this._reader.onerror = null;\r\n                this._reader = null;\r\n            }\r\n            if (this._xhr) {\r\n                this._xhr.onreadystatechange = null;\r\n                this._xhr = null;\r\n            }\r\n            _get(MSStreamLoader.prototype.__proto__ || Object.getPrototypeOf(MSStreamLoader.prototype), 'destroy', this).call(this);\r\n        }\r\n    }, {\r\n        key: 'open',\r\n        value: function open(dataSource, range) {\r\n            this._internalOpen(dataSource, range, false);\r\n        }\r\n    }, {\r\n        key: '_internalOpen',\r\n        value: function _internalOpen(dataSource, range, isSubrange) {\r\n            this._dataSource = dataSource;\r\n\r\n            if (!isSubrange) {\r\n                this._totalRange = range;\r\n            } else {\r\n                this._currentRange = range;\r\n            }\r\n\r\n            var sourceURL = dataSource.url;\r\n            if (this._config.reuseRedirectedURL) {\r\n                if (this._currentRedirectedURL != undefined) {\r\n                    sourceURL = this._currentRedirectedURL;\r\n                } else if (dataSource.redirectedURL != undefined) {\r\n                    sourceURL = dataSource.redirectedURL;\r\n                }\r\n            }\r\n\r\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\r\n            this._currentRequestURL = seekConfig.url;\r\n\r\n            var reader = this._reader = new self.MSStreamReader();\r\n            reader.onprogress = this._msrOnProgress.bind(this);\r\n            reader.onload = this._msrOnLoad.bind(this);\r\n            reader.onerror = this._msrOnError.bind(this);\r\n\r\n            var xhr = this._xhr = new XMLHttpRequest();\r\n            xhr.open('GET', seekConfig.url, true);\r\n            xhr.responseType = 'ms-stream';\r\n            xhr.onreadystatechange = this._xhrOnReadyStateChange.bind(this);\r\n            xhr.onerror = this._xhrOnError.bind(this);\r\n\r\n            if (dataSource.withCredentials) {\r\n                xhr.withCredentials = true;\r\n            }\r\n\r\n            if (_typeof(seekConfig.headers) === 'object') {\r\n                var headers = seekConfig.headers;\r\n\r\n                for (var key in headers) {\r\n                    if (headers.hasOwnProperty(key)) {\r\n                        xhr.setRequestHeader(key, headers[key]);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (this._isReconnecting) {\r\n                this._isReconnecting = false;\r\n            } else {\r\n                this._status = _loader.LoaderStatus.kConnecting;\r\n            }\r\n            xhr.send();\r\n        }\r\n    }, {\r\n        key: 'abort',\r\n        value: function abort() {\r\n            this._internalAbort();\r\n            this._status = _loader.LoaderStatus.kComplete;\r\n        }\r\n    }, {\r\n        key: '_internalAbort',\r\n        value: function _internalAbort() {\r\n            if (this._reader) {\r\n                if (this._reader.readyState === 1) {\r\n                    // LOADING\r\n                    this._reader.abort();\r\n                }\r\n                this._reader.onprogress = null;\r\n                this._reader.onload = null;\r\n                this._reader.onerror = null;\r\n                this._reader = null;\r\n            }\r\n            if (this._xhr) {\r\n                this._xhr.abort();\r\n                this._xhr.onreadystatechange = null;\r\n                this._xhr = null;\r\n            }\r\n        }\r\n    }, {\r\n        key: '_xhrOnReadyStateChange',\r\n        value: function _xhrOnReadyStateChange(e) {\r\n            var xhr = e.target;\r\n\r\n            if (xhr.readyState === 2) {\r\n                // HEADERS_RECEIVED\r\n                if (xhr.status >= 200 && xhr.status <= 299) {\r\n                    this._status = _loader.LoaderStatus.kBuffering;\r\n\r\n                    if (xhr.responseURL != undefined) {\r\n                        var redirectedURL = this._seekHandler.removeURLParameters(xhr.responseURL);\r\n                        if (xhr.responseURL !== this._currentRequestURL && redirectedURL !== this._currentRedirectedURL) {\r\n                            this._currentRedirectedURL = redirectedURL;\r\n                            if (this._onURLRedirect) {\r\n                                this._onURLRedirect(redirectedURL);\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    var lengthHeader = xhr.getResponseHeader('Content-Length');\r\n                    if (lengthHeader != null && this._contentLength == null) {\r\n                        var length = parseInt(lengthHeader);\r\n                        if (length > 0) {\r\n                            this._contentLength = length;\r\n                            if (this._onContentLengthKnown) {\r\n                                this._onContentLengthKnown(this._contentLength);\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    this._status = _loader.LoaderStatus.kError;\r\n                    if (this._onError) {\r\n                        this._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: xhr.status, msg: xhr.statusText });\r\n                    } else {\r\n                        throw new _exception.RuntimeException('MSStreamLoader: Http code invalid, ' + xhr.status + ' ' + xhr.statusText);\r\n                    }\r\n                }\r\n            } else if (xhr.readyState === 3) {\r\n                // LOADING\r\n                if (xhr.status >= 200 && xhr.status <= 299) {\r\n                    this._status = _loader.LoaderStatus.kBuffering;\r\n\r\n                    var msstream = xhr.response;\r\n                    this._reader.readAsArrayBuffer(msstream);\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_xhrOnError',\r\n        value: function _xhrOnError(e) {\r\n            this._status = _loader.LoaderStatus.kError;\r\n            var type = _loader.LoaderErrors.EXCEPTION;\r\n            var info = { code: -1, msg: e.constructor.name + ' ' + e.type };\r\n\r\n            if (this._onError) {\r\n                this._onError(type, info);\r\n            } else {\r\n                throw new _exception.RuntimeException(info.msg);\r\n            }\r\n        }\r\n    }, {\r\n        key: '_msrOnProgress',\r\n        value: function _msrOnProgress(e) {\r\n            var reader = e.target;\r\n            var bigbuffer = reader.result;\r\n            if (bigbuffer == null) {\r\n                // result may be null, workaround for buggy M$\r\n                this._doReconnectIfNeeded();\r\n                return;\r\n            }\r\n\r\n            var slice = bigbuffer.slice(this._lastTimeBufferSize);\r\n            this._lastTimeBufferSize = bigbuffer.byteLength;\r\n            var byteStart = this._totalRange.from + this._receivedLength;\r\n            this._receivedLength += slice.byteLength;\r\n\r\n            if (this._onDataArrival) {\r\n                this._onDataArrival(slice, byteStart, this._receivedLength);\r\n            }\r\n\r\n            if (bigbuffer.byteLength >= this._bufferLimit) {\r\n                _logger2.default.v(this.TAG, 'MSStream buffer exceeded max size near ' + (byteStart + slice.byteLength) + ', reconnecting...');\r\n                this._doReconnectIfNeeded();\r\n            }\r\n        }\r\n    }, {\r\n        key: '_doReconnectIfNeeded',\r\n        value: function _doReconnectIfNeeded() {\r\n            if (this._contentLength == null || this._receivedLength < this._contentLength) {\r\n                this._isReconnecting = true;\r\n                this._lastTimeBufferSize = 0;\r\n                this._internalAbort();\r\n\r\n                var range = {\r\n                    from: this._totalRange.from + this._receivedLength,\r\n                    to: -1\r\n                };\r\n                this._internalOpen(this._dataSource, range, true);\r\n            }\r\n        }\r\n    }, {\r\n        key: '_msrOnLoad',\r\n        value: function _msrOnLoad(e) {\r\n            // actually it is onComplete event\r\n            this._status = _loader.LoaderStatus.kComplete;\r\n            if (this._onComplete) {\r\n                this._onComplete(this._totalRange.from, this._totalRange.from + this._receivedLength - 1);\r\n            }\r\n        }\r\n    }, {\r\n        key: '_msrOnError',\r\n        value: function _msrOnError(e) {\r\n            this._status = _loader.LoaderStatus.kError;\r\n            var type = 0;\r\n            var info = null;\r\n\r\n            if (this._contentLength && this._receivedLength < this._contentLength) {\r\n                type = _loader.LoaderErrors.EARLY_EOF;\r\n                info = { code: -1, msg: 'MSStream meet Early-Eof' };\r\n            } else {\r\n                type = _loader.LoaderErrors.EARLY_EOF;\r\n                info = { code: -1, msg: e.constructor.name + ' ' + e.type };\r\n            }\r\n\r\n            if (this._onError) {\r\n                this._onError(type, info);\r\n            } else {\r\n                throw new _exception.RuntimeException(info.msg);\r\n            }\r\n        }\r\n    }]);\r\n\r\n    return MSStreamLoader;\r\n}(_loader.BaseLoader);\r\n\r\nexports.default = MSStreamLoader;\r\n\r\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],31:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\r\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nvar _logger = _dereq_('../utils/logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nvar _speedSampler = _dereq_('./speed-sampler.js');\r\n\r\nvar _speedSampler2 = _interopRequireDefault(_speedSampler);\r\n\r\nvar _loader = _dereq_('./loader.js');\r\n\r\nvar _exception = _dereq_('../utils/exception.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\r\n\r\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\r\n\r\n// Universal IO Loader, implemented by adding Range header in xhr's request header\r\nvar RangeLoader = function (_BaseLoader) {\r\n    _inherits(RangeLoader, _BaseLoader);\r\n\r\n    _createClass(RangeLoader, null, [{\r\n        key: 'isSupported',\r\n        value: function isSupported() {\r\n            try {\r\n                var xhr = new XMLHttpRequest();\r\n                xhr.open('GET', 'https://example.com', true);\r\n                xhr.responseType = 'arraybuffer';\r\n                return xhr.responseType === 'arraybuffer';\r\n            } catch (e) {\r\n                _logger2.default.w('RangeLoader', e.message);\r\n                return false;\r\n            }\r\n        }\r\n    }]);\r\n\r\n    function RangeLoader(seekHandler, config) {\r\n        _classCallCheck(this, RangeLoader);\r\n\r\n        var _this = _possibleConstructorReturn(this, (RangeLoader.__proto__ || Object.getPrototypeOf(RangeLoader)).call(this, 'xhr-range-loader'));\r\n\r\n        _this.TAG = 'RangeLoader';\r\n\r\n        _this._seekHandler = seekHandler;\r\n        _this._config = config;\r\n        _this._needStash = false;\r\n\r\n        _this._chunkSizeKBList = [128, 256, 384, 512, 768, 1024, 1536, 2048, 3072, 4096, 5120, 6144, 7168, 8192];\r\n        _this._currentChunkSizeKB = 384;\r\n        _this._currentSpeedNormalized = 0;\r\n        _this._zeroSpeedChunkCount = 0;\r\n\r\n        _this._xhr = null;\r\n        _this._speedSampler = new _speedSampler2.default();\r\n\r\n        _this._requestAbort = false;\r\n        _this._waitForTotalLength = false;\r\n        _this._totalLengthReceived = false;\r\n\r\n        _this._currentRequestURL = null;\r\n        _this._currentRedirectedURL = null;\r\n        _this._currentRequestRange = null;\r\n        _this._totalLength = null; // size of the entire file\r\n        _this._contentLength = null; // Content-Length of entire request range\r\n        _this._receivedLength = 0; // total received bytes\r\n        _this._lastTimeLoaded = 0; // received bytes of current request sub-range\r\n        return _this;\r\n    }\r\n\r\n    _createClass(RangeLoader, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            if (this.isWorking()) {\r\n                this.abort();\r\n            }\r\n            if (this._xhr) {\r\n                this._xhr.onreadystatechange = null;\r\n                this._xhr.onprogress = null;\r\n                this._xhr.onload = null;\r\n                this._xhr.onerror = null;\r\n                this._xhr = null;\r\n            }\r\n            _get(RangeLoader.prototype.__proto__ || Object.getPrototypeOf(RangeLoader.prototype), 'destroy', this).call(this);\r\n        }\r\n    }, {\r\n        key: 'open',\r\n        value: function open(dataSource, range) {\r\n            this._dataSource = dataSource;\r\n            this._range = range;\r\n            this._status = _loader.LoaderStatus.kConnecting;\r\n\r\n            if (!this._totalLengthReceived) {\r\n                // We need total filesize\r\n                this._waitForTotalLength = true;\r\n                this._internalOpen(this._dataSource, { from: 0, to: -1 });\r\n            } else {\r\n                // We have filesize, start loading\r\n                this._openSubRange();\r\n            }\r\n        }\r\n    }, {\r\n        key: '_openSubRange',\r\n        value: function _openSubRange() {\r\n            var chunkSize = this._currentChunkSizeKB * 1024;\r\n\r\n            var from = this._range.from + this._receivedLength;\r\n            var to = from + chunkSize;\r\n\r\n            if (this._contentLength != null) {\r\n                if (to - this._range.from >= this._contentLength) {\r\n                    to = this._range.from + this._contentLength - 1;\r\n                }\r\n            }\r\n\r\n            this._currentRequestRange = { from: from, to: to };\r\n            this._internalOpen(this._dataSource, this._currentRequestRange);\r\n        }\r\n    }, {\r\n        key: '_internalOpen',\r\n        value: function _internalOpen(dataSource, range) {\r\n            this._lastTimeLoaded = 0;\r\n\r\n            var sourceURL = dataSource.url;\r\n            if (this._config.reuseRedirectedURL) {\r\n                if (this._currentRedirectedURL != undefined) {\r\n                    sourceURL = this._currentRedirectedURL;\r\n                } else if (dataSource.redirectedURL != undefined) {\r\n                    sourceURL = dataSource.redirectedURL;\r\n                }\r\n            }\r\n\r\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\r\n            this._currentRequestURL = seekConfig.url;\r\n\r\n            var xhr = this._xhr = new XMLHttpRequest();\r\n            xhr.open('GET', seekConfig.url, true);\r\n            xhr.responseType = 'arraybuffer';\r\n            xhr.onreadystatechange = this._onReadyStateChange.bind(this);\r\n            xhr.onprogress = this._onProgress.bind(this);\r\n            xhr.onload = this._onLoad.bind(this);\r\n            xhr.onerror = this._onXhrError.bind(this);\r\n\r\n            if (dataSource.withCredentials && xhr['withCredentials']) {\r\n                xhr.withCredentials = true;\r\n            }\r\n\r\n            if (_typeof(seekConfig.headers) === 'object') {\r\n                var headers = seekConfig.headers;\r\n\r\n                for (var key in headers) {\r\n                    if (headers.hasOwnProperty(key)) {\r\n                        xhr.setRequestHeader(key, headers[key]);\r\n                    }\r\n                }\r\n            }\r\n\r\n            xhr.send();\r\n        }\r\n    }, {\r\n        key: 'abort',\r\n        value: function abort() {\r\n            this._requestAbort = true;\r\n            this._internalAbort();\r\n            this._status = _loader.LoaderStatus.kComplete;\r\n        }\r\n    }, {\r\n        key: '_internalAbort',\r\n        value: function _internalAbort() {\r\n            if (this._xhr) {\r\n                this._xhr.onreadystatechange = null;\r\n                this._xhr.onprogress = null;\r\n                this._xhr.onload = null;\r\n                this._xhr.onerror = null;\r\n                this._xhr.abort();\r\n                this._xhr = null;\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onReadyStateChange',\r\n        value: function _onReadyStateChange(e) {\r\n            var xhr = e.target;\r\n\r\n            if (xhr.readyState === 2) {\r\n                // HEADERS_RECEIVED\r\n                if (xhr.responseURL != undefined) {\r\n                    // if the browser support this property\r\n                    var redirectedURL = this._seekHandler.removeURLParameters(xhr.responseURL);\r\n                    if (xhr.responseURL !== this._currentRequestURL && redirectedURL !== this._currentRedirectedURL) {\r\n                        this._currentRedirectedURL = redirectedURL;\r\n                        if (this._onURLRedirect) {\r\n                            this._onURLRedirect(redirectedURL);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (xhr.status >= 200 && xhr.status <= 299) {\r\n                    if (this._waitForTotalLength) {\r\n                        return;\r\n                    }\r\n                    this._status = _loader.LoaderStatus.kBuffering;\r\n                } else {\r\n                    this._status = _loader.LoaderStatus.kError;\r\n                    if (this._onError) {\r\n                        this._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: xhr.status, msg: xhr.statusText });\r\n                    } else {\r\n                        throw new _exception.RuntimeException('RangeLoader: Http code invalid, ' + xhr.status + ' ' + xhr.statusText);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onProgress',\r\n        value: function _onProgress(e) {\r\n            if (this._contentLength === null) {\r\n                var openNextRange = false;\r\n\r\n                if (this._waitForTotalLength) {\r\n                    this._waitForTotalLength = false;\r\n                    this._totalLengthReceived = true;\r\n                    openNextRange = true;\r\n\r\n                    var total = e.total;\r\n                    this._internalAbort();\r\n                    if (total != null & total !== 0) {\r\n                        this._totalLength = total;\r\n                    }\r\n                }\r\n\r\n                // calculate currrent request range's contentLength\r\n                if (this._range.to === -1) {\r\n                    this._contentLength = this._totalLength - this._range.from;\r\n                } else {\r\n                    // to !== -1\r\n                    this._contentLength = this._range.to - this._range.from + 1;\r\n                }\r\n\r\n                if (openNextRange) {\r\n                    this._openSubRange();\r\n                    return;\r\n                }\r\n                if (this._onContentLengthKnown) {\r\n                    this._onContentLengthKnown(this._contentLength);\r\n                }\r\n            }\r\n\r\n            var delta = e.loaded - this._lastTimeLoaded;\r\n            this._lastTimeLoaded = e.loaded;\r\n            this._speedSampler.addBytes(delta);\r\n        }\r\n    }, {\r\n        key: '_normalizeSpeed',\r\n        value: function _normalizeSpeed(input) {\r\n            var list = this._chunkSizeKBList;\r\n            var last = list.length - 1;\r\n            var mid = 0;\r\n            var lbound = 0;\r\n            var ubound = last;\r\n\r\n            if (input < list[0]) {\r\n                return list[0];\r\n            }\r\n\r\n            while (lbound <= ubound) {\r\n                mid = lbound + Math.floor((ubound - lbound) / 2);\r\n                if (mid === last || input >= list[mid] && input < list[mid + 1]) {\r\n                    return list[mid];\r\n                } else if (list[mid] < input) {\r\n                    lbound = mid + 1;\r\n                } else {\r\n                    ubound = mid - 1;\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onLoad',\r\n        value: function _onLoad(e) {\r\n            if (this._waitForTotalLength) {\r\n                this._waitForTotalLength = false;\r\n                return;\r\n            }\r\n\r\n            this._lastTimeLoaded = 0;\r\n            var KBps = this._speedSampler.lastSecondKBps;\r\n            if (KBps === 0) {\r\n                this._zeroSpeedChunkCount++;\r\n                if (this._zeroSpeedChunkCount >= 3) {\r\n                    // Try get currentKBps after 3 chunks\r\n                    KBps = this._speedSampler.currentKBps;\r\n                }\r\n            }\r\n\r\n            if (KBps !== 0) {\r\n                var normalized = this._normalizeSpeed(KBps);\r\n                if (this._currentSpeedNormalized !== normalized) {\r\n                    this._currentSpeedNormalized = normalized;\r\n                    this._currentChunkSizeKB = normalized;\r\n                }\r\n            }\r\n\r\n            var chunk = e.target.response;\r\n            var byteStart = this._range.from + this._receivedLength;\r\n            this._receivedLength += chunk.byteLength;\r\n\r\n            var reportComplete = false;\r\n\r\n            if (this._contentLength != null && this._receivedLength < this._contentLength) {\r\n                // continue load next chunk\r\n                this._openSubRange();\r\n            } else {\r\n                reportComplete = true;\r\n            }\r\n\r\n            // dispatch received chunk\r\n            if (this._onDataArrival) {\r\n                this._onDataArrival(chunk, byteStart, this._receivedLength);\r\n            }\r\n\r\n            if (reportComplete) {\r\n                this._status = _loader.LoaderStatus.kComplete;\r\n                if (this._onComplete) {\r\n                    this._onComplete(this._range.from, this._range.from + this._receivedLength - 1);\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onXhrError',\r\n        value: function _onXhrError(e) {\r\n            this._status = _loader.LoaderStatus.kError;\r\n            var type = 0;\r\n            var info = null;\r\n\r\n            if (this._contentLength && this._receivedLength > 0 && this._receivedLength < this._contentLength) {\r\n                type = _loader.LoaderErrors.EARLY_EOF;\r\n                info = { code: -1, msg: 'RangeLoader meet Early-Eof' };\r\n            } else {\r\n                type = _loader.LoaderErrors.EXCEPTION;\r\n                info = { code: -1, msg: e.constructor.name + ' ' + e.type };\r\n            }\r\n\r\n            if (this._onError) {\r\n                this._onError(type, info);\r\n            } else {\r\n                throw new _exception.RuntimeException(info.msg);\r\n            }\r\n        }\r\n    }, {\r\n        key: 'currentSpeed',\r\n        get: function get() {\r\n            return this._speedSampler.lastSecondKBps;\r\n        }\r\n    }]);\r\n\r\n    return RangeLoader;\r\n}(_loader.BaseLoader);\r\n\r\nexports.default = RangeLoader;\r\n\r\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24,\"./speed-sampler.js\":27}],32:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _events = _dereq_('events');\r\n\r\nvar _events2 = _interopRequireDefault(_events);\r\n\r\nvar _logger = _dereq_('../utils/logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nvar _browser = _dereq_('../utils/browser.js');\r\n\r\nvar _browser2 = _interopRequireDefault(_browser);\r\n\r\nvar _playerEvents = _dereq_('./player-events.js');\r\n\r\nvar _playerEvents2 = _interopRequireDefault(_playerEvents);\r\n\r\nvar _transmuxer = _dereq_('../core/transmuxer.js');\r\n\r\nvar _transmuxer2 = _interopRequireDefault(_transmuxer);\r\n\r\nvar _transmuxingEvents = _dereq_('../core/transmuxing-events.js');\r\n\r\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\r\n\r\nvar _mseController = _dereq_('../core/mse-controller.js');\r\n\r\nvar _mseController2 = _interopRequireDefault(_mseController);\r\n\r\nvar _mseEvents = _dereq_('../core/mse-events.js');\r\n\r\nvar _mseEvents2 = _interopRequireDefault(_mseEvents);\r\n\r\nvar _playerErrors = _dereq_('./player-errors.js');\r\n\r\nvar _config = _dereq_('../config.js');\r\n\r\nvar _exception = _dereq_('../utils/exception.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nvar FlvPlayer = function () {\r\n    function FlvPlayer(mediaDataSource, config) {\r\n        _classCallCheck(this, FlvPlayer);\r\n\r\n        this.TAG = 'FlvPlayer';\r\n        this._type = 'FlvPlayer';\r\n        this._emitter = new _events2.default();\r\n\r\n        this._config = (0, _config.createDefaultConfig)();\r\n        if ((typeof config === 'undefined' ? 'undefined' : _typeof(config)) === 'object') {\r\n            Object.assign(this._config, config);\r\n        }\r\n\r\n        if (mediaDataSource.type.toLowerCase() !== 'flv') {\r\n            throw new _exception.InvalidArgumentException('FlvPlayer requires an flv MediaDataSource input!');\r\n        }\r\n\r\n        if (mediaDataSource.isLive === true) {\r\n            this._config.isLive = true;\r\n        }\r\n\r\n        this.e = {\r\n            onvLoadedMetadata: this._onvLoadedMetadata.bind(this),\r\n            onvSeeking: this._onvSeeking.bind(this),\r\n            onvCanPlay: this._onvCanPlay.bind(this),\r\n            onvStalled: this._onvStalled.bind(this),\r\n            onvProgress: this._onvProgress.bind(this)\r\n        };\r\n\r\n        if (self.performance && self.performance.now) {\r\n            this._now = self.performance.now.bind(self.performance);\r\n        } else {\r\n            this._now = Date.now;\r\n        }\r\n\r\n        this._pendingSeekTime = null; // in seconds\r\n        this._requestSetTime = false;\r\n        this._seekpointRecord = null;\r\n        this._progressChecker = null;\r\n\r\n        this._mediaDataSource = mediaDataSource;\r\n        this._mediaElement = null;\r\n        this._msectl = null;\r\n        this._transmuxer = null;\r\n\r\n        this._mseSourceOpened = false;\r\n        this._hasPendingLoad = false;\r\n        this._receivedCanPlay = false;\r\n\r\n        this._mediaInfo = null;\r\n        this._statisticsInfo = null;\r\n\r\n        var chromeNeedIDRFix = _browser2.default.chrome && (_browser2.default.version.major < 50 || _browser2.default.version.major === 50 && _browser2.default.version.build < 2661);\r\n        this._alwaysSeekKeyframe = chromeNeedIDRFix || _browser2.default.msedge || _browser2.default.msie ? true : false;\r\n\r\n        if (this._alwaysSeekKeyframe) {\r\n            this._config.accurateSeek = false;\r\n        }\r\n    }\r\n\r\n    _createClass(FlvPlayer, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            if (this._progressChecker != null) {\r\n                window.clearInterval(this._progressChecker);\r\n                this._progressChecker = null;\r\n            }\r\n            if (this._transmuxer) {\r\n                this.unload();\r\n            }\r\n            if (this._mediaElement) {\r\n                this.detachMediaElement();\r\n            }\r\n            this.e = null;\r\n            this._mediaDataSource = null;\r\n\r\n            this._emitter.removeAllListeners();\r\n            this._emitter = null;\r\n        }\r\n    }, {\r\n        key: 'on',\r\n        value: function on(event, listener) {\r\n            var _this = this;\r\n\r\n            if (event === _playerEvents2.default.MEDIA_INFO) {\r\n                if (this._mediaInfo != null) {\r\n                    Promise.resolve().then(function () {\r\n                        _this._emitter.emit(_playerEvents2.default.MEDIA_INFO, _this.mediaInfo);\r\n                    });\r\n                }\r\n            } else if (event === _playerEvents2.default.STATISTICS_INFO) {\r\n                if (this._statisticsInfo != null) {\r\n                    Promise.resolve().then(function () {\r\n                        _this._emitter.emit(_playerEvents2.default.STATISTICS_INFO, _this.statisticsInfo);\r\n                    });\r\n                }\r\n            }\r\n            this._emitter.addListener(event, listener);\r\n        }\r\n    }, {\r\n        key: 'off',\r\n        value: function off(event, listener) {\r\n            this._emitter.removeListener(event, listener);\r\n        }\r\n    }, {\r\n        key: 'attachMediaElement',\r\n        value: function attachMediaElement(mediaElement) {\r\n            var _this2 = this;\r\n\r\n            this._mediaElement = mediaElement;\r\n            mediaElement.addEventListener('loadedmetadata', this.e.onvLoadedMetadata);\r\n            mediaElement.addEventListener('seeking', this.e.onvSeeking);\r\n            mediaElement.addEventListener('canplay', this.e.onvCanPlay);\r\n            mediaElement.addEventListener('stalled', this.e.onvStalled);\r\n            mediaElement.addEventListener('progress', this.e.onvProgress);\r\n\r\n            this._msectl = new _mseController2.default(this._config);\r\n\r\n            this._msectl.on(_mseEvents2.default.UPDATE_END, this._onmseUpdateEnd.bind(this));\r\n            this._msectl.on(_mseEvents2.default.BUFFER_FULL, this._onmseBufferFull.bind(this));\r\n            this._msectl.on(_mseEvents2.default.SOURCE_OPEN, function () {\r\n                _this2._mseSourceOpened = true;\r\n                if (_this2._hasPendingLoad) {\r\n                    _this2._hasPendingLoad = false;\r\n                    _this2.load();\r\n                }\r\n            });\r\n            this._msectl.on(_mseEvents2.default.ERROR, function (info) {\r\n                _this2._emitter.emit(_playerEvents2.default.ERROR, _playerErrors.ErrorTypes.MEDIA_ERROR, _playerErrors.ErrorDetails.MEDIA_MSE_ERROR, info);\r\n            });\r\n\r\n            this._msectl.attachMediaElement(mediaElement);\r\n\r\n            if (this._pendingSeekTime != null) {\r\n                try {\r\n                    mediaElement.currentTime = this._pendingSeekTime;\r\n                    this._pendingSeekTime = null;\r\n                } catch (e) {\r\n                    // IE11 may throw InvalidStateError if readyState === 0\r\n                    // We can defer set currentTime operation after loadedmetadata\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: 'detachMediaElement',\r\n        value: function detachMediaElement() {\r\n            if (this._mediaElement) {\r\n                this._msectl.detachMediaElement();\r\n                this._mediaElement.removeEventListener('loadedmetadata', this.e.onvLoadedMetadata);\r\n                this._mediaElement.removeEventListener('seeking', this.e.onvSeeking);\r\n                this._mediaElement.removeEventListener('canplay', this.e.onvCanPlay);\r\n                this._mediaElement.removeEventListener('stalled', this.e.onvStalled);\r\n                this._mediaElement.removeEventListener('progress', this.e.onvProgress);\r\n                this._mediaElement = null;\r\n            }\r\n            if (this._msectl) {\r\n                this._msectl.destroy();\r\n                this._msectl = null;\r\n            }\r\n        }\r\n    }, {\r\n        key: 'load',\r\n        value: function load() {\r\n            var _this3 = this;\r\n\r\n            if (!this._mediaElement) {\r\n                throw new _exception.IllegalStateException('HTMLMediaElement must be attached before load()!');\r\n            }\r\n            if (this._transmuxer) {\r\n                throw new _exception.IllegalStateException('FlvPlayer.load() has been called, please call unload() first!');\r\n            }\r\n            if (this._hasPendingLoad) {\r\n                return;\r\n            }\r\n\r\n            if (this._config.deferLoadAfterSourceOpen && this._mseSourceOpened === false) {\r\n                this._hasPendingLoad = true;\r\n                return;\r\n            }\r\n\r\n            if (this._mediaElement.readyState > 0) {\r\n                this._requestSetTime = true;\r\n                // IE11 may throw InvalidStateError if readyState === 0\r\n                this._mediaElement.currentTime = 0;\r\n            }\r\n\r\n            this._transmuxer = new _transmuxer2.default(this._mediaDataSource, this._config);\r\n\r\n            this._transmuxer.on(_transmuxingEvents2.default.INIT_SEGMENT, function (type, is) {\r\n                _this3._msectl.appendInitSegment(is);\r\n            });\r\n            this._transmuxer.on(_transmuxingEvents2.default.MEDIA_SEGMENT, function (type, ms) {\r\n                _this3._msectl.appendMediaSegment(ms);\r\n\r\n                // lazyLoad check\r\n                if (_this3._config.lazyLoad && !_this3._config.isLive) {\r\n                    var currentTime = _this3._mediaElement.currentTime;\r\n                    if (ms.info.endDts >= (currentTime + _this3._config.lazyLoadMaxDuration) * 1000) {\r\n                        if (_this3._progressChecker == null) {\r\n                            _logger2.default.v(_this3.TAG, 'Maximum buffering duration exceeded, suspend transmuxing task');\r\n                            _this3._suspendTransmuxer();\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            this._transmuxer.on(_transmuxingEvents2.default.LOADING_COMPLETE, function () {\r\n                _this3._msectl.endOfStream();\r\n                _this3._emitter.emit(_playerEvents2.default.LOADING_COMPLETE);\r\n            });\r\n            this._transmuxer.on(_transmuxingEvents2.default.RECOVERED_EARLY_EOF, function () {\r\n                _this3._emitter.emit(_playerEvents2.default.RECOVERED_EARLY_EOF);\r\n            });\r\n            this._transmuxer.on(_transmuxingEvents2.default.IO_ERROR, function (detail, info) {\r\n                _this3._emitter.emit(_playerEvents2.default.ERROR, _playerErrors.ErrorTypes.NETWORK_ERROR, detail, info);\r\n            });\r\n            this._transmuxer.on(_transmuxingEvents2.default.DEMUX_ERROR, function (detail, info) {\r\n                _this3._emitter.emit(_playerEvents2.default.ERROR, _playerErrors.ErrorTypes.MEDIA_ERROR, detail, { code: -1, msg: info });\r\n            });\r\n            this._transmuxer.on(_transmuxingEvents2.default.MEDIA_INFO, function (mediaInfo) {\r\n                _this3._mediaInfo = mediaInfo;\r\n                _this3._emitter.emit(_playerEvents2.default.MEDIA_INFO, Object.assign({}, mediaInfo));\r\n            });\r\n            this._transmuxer.on(_transmuxingEvents2.default.STATISTICS_INFO, function (statInfo) {\r\n                _this3._statisticsInfo = _this3._fillStatisticsInfo(statInfo);\r\n                _this3._emitter.emit(_playerEvents2.default.STATISTICS_INFO, Object.assign({}, _this3._statisticsInfo));\r\n            });\r\n            this._transmuxer.on(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, function (milliseconds) {\r\n                if (_this3._mediaElement && !_this3._config.accurateSeek) {\r\n                    _this3._requestSetTime = true;\r\n                    _this3._mediaElement.currentTime = milliseconds / 1000;\r\n                }\r\n            });\r\n\r\n            this._transmuxer.open();\r\n        }\r\n    }, {\r\n        key: 'unload',\r\n        value: function unload() {\r\n            if (this._mediaElement) {\r\n                this._mediaElement.pause();\r\n            }\r\n            if (this._msectl) {\r\n                this._msectl.seek(0);\r\n            }\r\n            if (this._transmuxer) {\r\n                this._transmuxer.close();\r\n                this._transmuxer.destroy();\r\n                this._transmuxer = null;\r\n            }\r\n        }\r\n    }, {\r\n        key: 'play',\r\n        value: function play() {\r\n            return this._mediaElement.play();\r\n        }\r\n    }, {\r\n        key: 'pause',\r\n        value: function pause() {\r\n            this._mediaElement.pause();\r\n        }\r\n    }, {\r\n        key: '_fillStatisticsInfo',\r\n        value: function _fillStatisticsInfo(statInfo) {\r\n            statInfo.playerType = this._type;\r\n\r\n            if (!(this._mediaElement instanceof HTMLVideoElement)) {\r\n                return statInfo;\r\n            }\r\n\r\n            var hasQualityInfo = true;\r\n            var decoded = 0;\r\n            var dropped = 0;\r\n\r\n            if (this._mediaElement.getVideoPlaybackQuality) {\r\n                var quality = this._mediaElement.getVideoPlaybackQuality();\r\n                decoded = quality.totalVideoFrames;\r\n                dropped = quality.droppedVideoFrames;\r\n            } else if (this._mediaElement.webkitDecodedFrameCount != undefined) {\r\n                decoded = this._mediaElement.webkitDecodedFrameCount;\r\n                dropped = this._mediaElement.webkitDroppedFrameCount;\r\n            } else {\r\n                hasQualityInfo = false;\r\n            }\r\n\r\n            if (hasQualityInfo) {\r\n                statInfo.decodedFrames = decoded;\r\n                statInfo.droppedFrames = dropped;\r\n            }\r\n\r\n            return statInfo;\r\n        }\r\n    }, {\r\n        key: '_onmseUpdateEnd',\r\n        value: function _onmseUpdateEnd() {\r\n            if (!this._config.lazyLoad || this._config.isLive) {\r\n                return;\r\n            }\r\n\r\n            var buffered = this._mediaElement.buffered;\r\n            var currentTime = this._mediaElement.currentTime;\r\n            var currentRangeStart = 0;\r\n            var currentRangeEnd = 0;\r\n\r\n            for (var i = 0; i < buffered.length; i++) {\r\n                var start = buffered.start(i);\r\n                var end = buffered.end(i);\r\n                if (start <= currentTime && currentTime < end) {\r\n                    currentRangeStart = start;\r\n                    currentRangeEnd = end;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (currentRangeEnd >= currentTime + this._config.lazyLoadMaxDuration && this._progressChecker == null) {\r\n                _logger2.default.v(this.TAG, 'Maximum buffering duration exceeded, suspend transmuxing task');\r\n                this._suspendTransmuxer();\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onmseBufferFull',\r\n        value: function _onmseBufferFull() {\r\n            _logger2.default.v(this.TAG, 'MSE SourceBuffer is full, suspend transmuxing task');\r\n            if (this._progressChecker == null) {\r\n                this._suspendTransmuxer();\r\n            }\r\n        }\r\n    }, {\r\n        key: '_suspendTransmuxer',\r\n        value: function _suspendTransmuxer() {\r\n            if (this._transmuxer) {\r\n                this._transmuxer.pause();\r\n\r\n                if (this._progressChecker == null) {\r\n                    this._progressChecker = window.setInterval(this._checkProgressAndResume.bind(this), 1000);\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_checkProgressAndResume',\r\n        value: function _checkProgressAndResume() {\r\n            var currentTime = this._mediaElement.currentTime;\r\n            var buffered = this._mediaElement.buffered;\r\n\r\n            var needResume = false;\r\n\r\n            for (var i = 0; i < buffered.length; i++) {\r\n                var from = buffered.start(i);\r\n                var to = buffered.end(i);\r\n                if (currentTime >= from && currentTime < to) {\r\n                    if (currentTime >= to - this._config.lazyLoadRecoverDuration) {\r\n                        needResume = true;\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (needResume) {\r\n                window.clearInterval(this._progressChecker);\r\n                this._progressChecker = null;\r\n                if (needResume) {\r\n                    _logger2.default.v(this.TAG, 'Continue loading from paused position');\r\n                    this._transmuxer.resume();\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_isTimepointBuffered',\r\n        value: function _isTimepointBuffered(seconds) {\r\n            var buffered = this._mediaElement.buffered;\r\n\r\n            for (var i = 0; i < buffered.length; i++) {\r\n                var from = buffered.start(i);\r\n                var to = buffered.end(i);\r\n                if (seconds >= from && seconds < to) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n    }, {\r\n        key: '_internalSeek',\r\n        value: function _internalSeek(seconds) {\r\n            var directSeek = this._isTimepointBuffered(seconds);\r\n\r\n            var directSeekBegin = false;\r\n            var directSeekBeginTime = 0;\r\n\r\n            if (seconds < 1.0 && this._mediaElement.buffered.length > 0) {\r\n                var videoBeginTime = this._mediaElement.buffered.start(0);\r\n                if (videoBeginTime < 1.0 && seconds < videoBeginTime || _browser2.default.safari) {\r\n                    directSeekBegin = true;\r\n                    // also workaround for Safari: Seek to 0 may cause video stuck, use 0.1 to avoid\r\n                    directSeekBeginTime = _browser2.default.safari ? 0.1 : videoBeginTime;\r\n                }\r\n            }\r\n\r\n            if (directSeekBegin) {\r\n                // seek to video begin, set currentTime directly if beginPTS buffered\r\n                this._requestSetTime = true;\r\n                this._mediaElement.currentTime = directSeekBeginTime;\r\n            } else if (directSeek) {\r\n                // buffered position\r\n                if (!this._alwaysSeekKeyframe) {\r\n                    this._requestSetTime = true;\r\n                    this._mediaElement.currentTime = seconds;\r\n                } else {\r\n                    var idr = this._msectl.getNearestKeyframe(Math.floor(seconds * 1000));\r\n                    this._requestSetTime = true;\r\n                    if (idr != null) {\r\n                        this._mediaElement.currentTime = idr.dts / 1000;\r\n                    } else {\r\n                        this._mediaElement.currentTime = seconds;\r\n                    }\r\n                }\r\n                if (this._progressChecker != null) {\r\n                    this._checkProgressAndResume();\r\n                }\r\n            } else {\r\n                if (this._progressChecker != null) {\r\n                    window.clearInterval(this._progressChecker);\r\n                    this._progressChecker = null;\r\n                }\r\n                this._msectl.seek(seconds);\r\n                this._transmuxer.seek(Math.floor(seconds * 1000)); // in milliseconds\r\n                // no need to set mediaElement.currentTime if non-accurateSeek,\r\n                // just wait for the recommend_seekpoint callback\r\n                if (this._config.accurateSeek) {\r\n                    this._requestSetTime = true;\r\n                    this._mediaElement.currentTime = seconds;\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_checkAndApplyUnbufferedSeekpoint',\r\n        value: function _checkAndApplyUnbufferedSeekpoint() {\r\n            if (this._seekpointRecord) {\r\n                if (this._seekpointRecord.recordTime <= this._now() - 100) {\r\n                    var target = this._mediaElement.currentTime;\r\n                    this._seekpointRecord = null;\r\n                    if (!this._isTimepointBuffered(target)) {\r\n                        if (this._progressChecker != null) {\r\n                            window.clearTimeout(this._progressChecker);\r\n                            this._progressChecker = null;\r\n                        }\r\n                        // .currentTime is consists with .buffered timestamp\r\n                        // Chrome/Edge use DTS, while FireFox/Safari use PTS\r\n                        this._msectl.seek(target);\r\n                        this._transmuxer.seek(Math.floor(target * 1000));\r\n                        // set currentTime if accurateSeek, or wait for recommend_seekpoint callback\r\n                        if (this._config.accurateSeek) {\r\n                            this._requestSetTime = true;\r\n                            this._mediaElement.currentTime = target;\r\n                        }\r\n                    }\r\n                } else {\r\n                    window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this), 50);\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: '_checkAndResumeStuckPlayback',\r\n        value: function _checkAndResumeStuckPlayback(stalled) {\r\n            var media = this._mediaElement;\r\n            if (stalled || !this._receivedCanPlay || media.readyState < 2) {\r\n                // HAVE_CURRENT_DATA\r\n                var buffered = media.buffered;\r\n                if (buffered.length > 0 && media.currentTime < buffered.start(0)) {\r\n                    _logger2.default.w(this.TAG, 'Playback seems stuck at ' + media.currentTime + ', seek to ' + buffered.start(0));\r\n                    this._requestSetTime = true;\r\n                    this._mediaElement.currentTime = buffered.start(0);\r\n                    this._mediaElement.removeEventListener('progress', this.e.onvProgress);\r\n                }\r\n            } else {\r\n                // Playback didn't stuck, remove progress event listener\r\n                this._mediaElement.removeEventListener('progress', this.e.onvProgress);\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onvLoadedMetadata',\r\n        value: function _onvLoadedMetadata(e) {\r\n            if (this._pendingSeekTime != null) {\r\n                this._mediaElement.currentTime = this._pendingSeekTime;\r\n                this._pendingSeekTime = null;\r\n            }\r\n        }\r\n    }, {\r\n        key: '_onvSeeking',\r\n        value: function _onvSeeking(e) {\r\n            // handle seeking request from browser's progress bar\r\n            var target = this._mediaElement.currentTime;\r\n            var buffered = this._mediaElement.buffered;\r\n\r\n            if (this._requestSetTime) {\r\n                this._requestSetTime = false;\r\n                return;\r\n            }\r\n\r\n            if (target < 1.0 && buffered.length > 0) {\r\n                // seek to video begin, set currentTime directly if beginPTS buffered\r\n                var videoBeginTime = buffered.start(0);\r\n                if (videoBeginTime < 1.0 && target < videoBeginTime || _browser2.default.safari) {\r\n                    this._requestSetTime = true;\r\n                    // also workaround for Safari: Seek to 0 may cause video stuck, use 0.1 to avoid\r\n                    this._mediaElement.currentTime = _browser2.default.safari ? 0.1 : videoBeginTime;\r\n                    return;\r\n                }\r\n            }\r\n\r\n            if (this._isTimepointBuffered(target)) {\r\n                if (this._alwaysSeekKeyframe) {\r\n                    var idr = this._msectl.getNearestKeyframe(Math.floor(target * 1000));\r\n                    if (idr != null) {\r\n                        this._requestSetTime = true;\r\n                        this._mediaElement.currentTime = idr.dts / 1000;\r\n                    }\r\n                }\r\n                if (this._progressChecker != null) {\r\n                    this._checkProgressAndResume();\r\n                }\r\n                return;\r\n            }\r\n\r\n            this._seekpointRecord = {\r\n                seekPoint: target,\r\n                recordTime: this._now()\r\n            };\r\n            window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this), 50);\r\n        }\r\n    }, {\r\n        key: '_onvCanPlay',\r\n        value: function _onvCanPlay(e) {\r\n            this._receivedCanPlay = true;\r\n            this._mediaElement.removeEventListener('canplay', this.e.onvCanPlay);\r\n        }\r\n    }, {\r\n        key: '_onvStalled',\r\n        value: function _onvStalled(e) {\r\n            this._checkAndResumeStuckPlayback(true);\r\n        }\r\n    }, {\r\n        key: '_onvProgress',\r\n        value: function _onvProgress(e) {\r\n            this._checkAndResumeStuckPlayback();\r\n        }\r\n    }, {\r\n        key: 'type',\r\n        get: function get() {\r\n            return this._type;\r\n        }\r\n    }, {\r\n        key: 'buffered',\r\n        get: function get() {\r\n            return this._mediaElement.buffered;\r\n        }\r\n    }, {\r\n        key: 'duration',\r\n        get: function get() {\r\n            return this._mediaElement.duration;\r\n        }\r\n    }, {\r\n        key: 'volume',\r\n        get: function get() {\r\n            return this._mediaElement.volume;\r\n        },\r\n        set: function set(value) {\r\n            this._mediaElement.volume = value;\r\n        }\r\n    }, {\r\n        key: 'muted',\r\n        get: function get() {\r\n            return this._mediaElement.muted;\r\n        },\r\n        set: function set(muted) {\r\n            this._mediaElement.muted = muted;\r\n        }\r\n    }, {\r\n        key: 'currentTime',\r\n        get: function get() {\r\n            if (this._mediaElement) {\r\n                return this._mediaElement.currentTime;\r\n            }\r\n            return 0;\r\n        },\r\n        set: function set(seconds) {\r\n            if (this._mediaElement) {\r\n                this._internalSeek(seconds);\r\n            } else {\r\n                this._pendingSeekTime = seconds;\r\n            }\r\n        }\r\n    }, {\r\n        key: 'mediaInfo',\r\n        get: function get() {\r\n            return Object.assign({}, this._mediaInfo);\r\n        }\r\n    }, {\r\n        key: 'statisticsInfo',\r\n        get: function get() {\r\n            if (this._statisticsInfo == null) {\r\n                this._statisticsInfo = {};\r\n            }\r\n            this._statisticsInfo = this._fillStatisticsInfo(this._statisticsInfo);\r\n            return Object.assign({}, this._statisticsInfo);\r\n        }\r\n    }]);\r\n\r\n    return FlvPlayer;\r\n}();\r\n\r\nexports.default = FlvPlayer;\r\n\r\n},{\"../config.js\":5,\"../core/mse-controller.js\":9,\"../core/mse-events.js\":10,\"../core/transmuxer.js\":11,\"../core/transmuxing-events.js\":13,\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./player-errors.js\":34,\"./player-events.js\":35,\"events\":2}],33:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _events = _dereq_('events');\r\n\r\nvar _events2 = _interopRequireDefault(_events);\r\n\r\nvar _playerEvents = _dereq_('./player-events.js');\r\n\r\nvar _playerEvents2 = _interopRequireDefault(_playerEvents);\r\n\r\nvar _config = _dereq_('../config.js');\r\n\r\nvar _exception = _dereq_('../utils/exception.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n// Player wrapper for browser's native player (HTMLVideoElement) without MediaSource src. \r\nvar NativePlayer = function () {\r\n    function NativePlayer(mediaDataSource, config) {\r\n        _classCallCheck(this, NativePlayer);\r\n\r\n        this.TAG = 'NativePlayer';\r\n        this._type = 'NativePlayer';\r\n        this._emitter = new _events2.default();\r\n\r\n        this._config = (0, _config.createDefaultConfig)();\r\n        if ((typeof config === 'undefined' ? 'undefined' : _typeof(config)) === 'object') {\r\n            Object.assign(this._config, config);\r\n        }\r\n\r\n        if (mediaDataSource.type.toLowerCase() === 'flv') {\r\n            throw new _exception.InvalidArgumentException('NativePlayer does\\'t support flv MediaDataSource input!');\r\n        }\r\n        if (mediaDataSource.hasOwnProperty('segments')) {\r\n            throw new _exception.InvalidArgumentException('NativePlayer(' + mediaDataSource.type + ') doesn\\'t support multipart playback!');\r\n        }\r\n\r\n        this.e = {\r\n            onvLoadedMetadata: this._onvLoadedMetadata.bind(this)\r\n        };\r\n\r\n        this._pendingSeekTime = null;\r\n        this._statisticsReporter = null;\r\n\r\n        this._mediaDataSource = mediaDataSource;\r\n        this._mediaElement = null;\r\n    }\r\n\r\n    _createClass(NativePlayer, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            if (this._mediaElement) {\r\n                this.unload();\r\n                this.detachMediaElement();\r\n            }\r\n            this.e = null;\r\n            this._mediaDataSource = null;\r\n            this._emitter.removeAllListeners();\r\n            this._emitter = null;\r\n        }\r\n    }, {\r\n        key: 'on',\r\n        value: function on(event, listener) {\r\n            var _this = this;\r\n\r\n            if (event === _playerEvents2.default.MEDIA_INFO) {\r\n                if (this._mediaElement != null && this._mediaElement.readyState !== 0) {\r\n                    // HAVE_NOTHING\r\n                    Promise.resolve().then(function () {\r\n                        _this._emitter.emit(_playerEvents2.default.MEDIA_INFO, _this.mediaInfo);\r\n                    });\r\n                }\r\n            } else if (event === _playerEvents2.default.STATISTICS_INFO) {\r\n                if (this._mediaElement != null && this._mediaElement.readyState !== 0) {\r\n                    Promise.resolve().then(function () {\r\n                        _this._emitter.emit(_playerEvents2.default.STATISTICS_INFO, _this.statisticsInfo);\r\n                    });\r\n                }\r\n            }\r\n            this._emitter.addListener(event, listener);\r\n        }\r\n    }, {\r\n        key: 'off',\r\n        value: function off(event, listener) {\r\n            this._emitter.removeListener(event, listener);\r\n        }\r\n    }, {\r\n        key: 'attachMediaElement',\r\n        value: function attachMediaElement(mediaElement) {\r\n            this._mediaElement = mediaElement;\r\n            mediaElement.addEventListener('loadedmetadata', this.e.onvLoadedMetadata);\r\n\r\n            if (this._pendingSeekTime != null) {\r\n                try {\r\n                    mediaElement.currentTime = this._pendingSeekTime;\r\n                    this._pendingSeekTime = null;\r\n                } catch (e) {\r\n                    // IE11 may throw InvalidStateError if readyState === 0\r\n                    // Defer set currentTime operation after loadedmetadata\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: 'detachMediaElement',\r\n        value: function detachMediaElement() {\r\n            if (this._mediaElement) {\r\n                this._mediaElement.src = '';\r\n                this._mediaElement.removeAttribute('src');\r\n                this._mediaElement.removeEventListener('loadedmetadata', this.e.onvLoadedMetadata);\r\n                this._mediaElement = null;\r\n            }\r\n            if (this._statisticsReporter != null) {\r\n                window.clearInterval(this._statisticsReporter);\r\n                this._statisticsReporter = null;\r\n            }\r\n        }\r\n    }, {\r\n        key: 'load',\r\n        value: function load() {\r\n            if (!this._mediaElement) {\r\n                throw new _exception.IllegalStateException('HTMLMediaElement must be attached before load()!');\r\n            }\r\n            this._mediaElement.src = this._mediaDataSource.url;\r\n\r\n            if (this._mediaElement.readyState > 0) {\r\n                this._mediaElement.currentTime = 0;\r\n            }\r\n\r\n            this._mediaElement.preload = 'auto';\r\n            this._mediaElement.load();\r\n            this._statisticsReporter = window.setInterval(this._reportStatisticsInfo.bind(this), this._config.statisticsInfoReportInterval);\r\n        }\r\n    }, {\r\n        key: 'unload',\r\n        value: function unload() {\r\n            if (this._mediaElement) {\r\n                this._mediaElement.src = '';\r\n                this._mediaElement.removeAttribute('src');\r\n            }\r\n            if (this._statisticsReporter != null) {\r\n                window.clearInterval(this._statisticsReporter);\r\n                this._statisticsReporter = null;\r\n            }\r\n        }\r\n    }, {\r\n        key: 'play',\r\n        value: function play() {\r\n            return this._mediaElement.play();\r\n        }\r\n    }, {\r\n        key: 'pause',\r\n        value: function pause() {\r\n            this._mediaElement.pause();\r\n        }\r\n    }, {\r\n        key: '_onvLoadedMetadata',\r\n        value: function _onvLoadedMetadata(e) {\r\n            if (this._pendingSeekTime != null) {\r\n                this._mediaElement.currentTime = this._pendingSeekTime;\r\n                this._pendingSeekTime = null;\r\n            }\r\n            this._emitter.emit(_playerEvents2.default.MEDIA_INFO, this.mediaInfo);\r\n        }\r\n    }, {\r\n        key: '_reportStatisticsInfo',\r\n        value: function _reportStatisticsInfo() {\r\n            this._emitter.emit(_playerEvents2.default.STATISTICS_INFO, this.statisticsInfo);\r\n        }\r\n    }, {\r\n        key: 'type',\r\n        get: function get() {\r\n            return this._type;\r\n        }\r\n    }, {\r\n        key: 'buffered',\r\n        get: function get() {\r\n            return this._mediaElement.buffered;\r\n        }\r\n    }, {\r\n        key: 'duration',\r\n        get: function get() {\r\n            return this._mediaElement.duration;\r\n        }\r\n    }, {\r\n        key: 'volume',\r\n        get: function get() {\r\n            return this._mediaElement.volume;\r\n        },\r\n        set: function set(value) {\r\n            this._mediaElement.volume = value;\r\n        }\r\n    }, {\r\n        key: 'muted',\r\n        get: function get() {\r\n            return this._mediaElement.muted;\r\n        },\r\n        set: function set(muted) {\r\n            this._mediaElement.muted = muted;\r\n        }\r\n    }, {\r\n        key: 'currentTime',\r\n        get: function get() {\r\n            if (this._mediaElement) {\r\n                return this._mediaElement.currentTime;\r\n            }\r\n            return 0;\r\n        },\r\n        set: function set(seconds) {\r\n            if (this._mediaElement) {\r\n                this._mediaElement.currentTime = seconds;\r\n            } else {\r\n                this._pendingSeekTime = seconds;\r\n            }\r\n        }\r\n    }, {\r\n        key: 'mediaInfo',\r\n        get: function get() {\r\n            var mediaPrefix = this._mediaElement instanceof HTMLAudioElement ? 'audio/' : 'video/';\r\n            var info = {\r\n                mimeType: mediaPrefix + this._mediaDataSource.type\r\n            };\r\n            if (this._mediaElement) {\r\n                info.duration = Math.floor(this._mediaElement.duration * 1000);\r\n                if (this._mediaElement instanceof HTMLVideoElement) {\r\n                    info.width = this._mediaElement.videoWidth;\r\n                    info.height = this._mediaElement.videoHeight;\r\n                }\r\n            }\r\n            return info;\r\n        }\r\n    }, {\r\n        key: 'statisticsInfo',\r\n        get: function get() {\r\n            var info = {\r\n                playerType: this._type,\r\n                url: this._mediaDataSource.url\r\n            };\r\n\r\n            if (!(this._mediaElement instanceof HTMLVideoElement)) {\r\n                return info;\r\n            }\r\n\r\n            var hasQualityInfo = true;\r\n            var decoded = 0;\r\n            var dropped = 0;\r\n\r\n            if (this._mediaElement.getVideoPlaybackQuality) {\r\n                var quality = this._mediaElement.getVideoPlaybackQuality();\r\n                decoded = quality.totalVideoFrames;\r\n                dropped = quality.droppedVideoFrames;\r\n            } else if (this._mediaElement.webkitDecodedFrameCount != undefined) {\r\n                decoded = this._mediaElement.webkitDecodedFrameCount;\r\n                dropped = this._mediaElement.webkitDroppedFrameCount;\r\n            } else {\r\n                hasQualityInfo = false;\r\n            }\r\n\r\n            if (hasQualityInfo) {\r\n                info.decodedFrames = decoded;\r\n                info.droppedFrames = dropped;\r\n            }\r\n\r\n            return info;\r\n        }\r\n    }]);\r\n\r\n    return NativePlayer;\r\n}();\r\n\r\nexports.default = NativePlayer;\r\n\r\n},{\"../config.js\":5,\"../utils/exception.js\":40,\"./player-events.js\":35,\"events\":2}],34:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\nexports.ErrorDetails = exports.ErrorTypes = undefined;\r\n\r\nvar _loader = _dereq_('../io/loader.js');\r\n\r\nvar _demuxErrors = _dereq_('../demux/demux-errors.js');\r\n\r\nvar _demuxErrors2 = _interopRequireDefault(_demuxErrors);\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nvar ErrorTypes = exports.ErrorTypes = {\r\n    NETWORK_ERROR: 'NetworkError',\r\n    MEDIA_ERROR: 'MediaError',\r\n    OTHER_ERROR: 'OtherError'\r\n};\r\n\r\nvar ErrorDetails = exports.ErrorDetails = {\r\n    NETWORK_EXCEPTION: _loader.LoaderErrors.EXCEPTION,\r\n    NETWORK_STATUS_CODE_INVALID: _loader.LoaderErrors.HTTP_STATUS_CODE_INVALID,\r\n    NETWORK_TIMEOUT: _loader.LoaderErrors.CONNECTING_TIMEOUT,\r\n    NETWORK_UNRECOVERABLE_EARLY_EOF: _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF,\r\n\r\n    MEDIA_MSE_ERROR: 'MediaMSEError',\r\n\r\n    MEDIA_FORMAT_ERROR: _demuxErrors2.default.FORMAT_ERROR,\r\n    MEDIA_FORMAT_UNSUPPORTED: _demuxErrors2.default.FORMAT_UNSUPPORTED,\r\n    MEDIA_CODEC_UNSUPPORTED: _demuxErrors2.default.CODEC_UNSUPPORTED\r\n};\r\n\r\n},{\"../demux/demux-errors.js\":16,\"../io/loader.js\":24}],35:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n  value: true\r\n});\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nvar PlayerEvents = {\r\n  ERROR: 'error',\r\n  LOADING_COMPLETE: 'loading_complete',\r\n  RECOVERED_EARLY_EOF: 'recovered_early_eof',\r\n  MEDIA_INFO: 'media_info',\r\n  STATISTICS_INFO: 'statistics_info'\r\n};\r\n\r\nexports.default = PlayerEvents;\r\n\r\n},{}],36:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * This file is modified from dailymotion's hls.js library (hls.js/src/helper/aac.js)\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nvar AAC = function () {\r\n    function AAC() {\r\n        _classCallCheck(this, AAC);\r\n    }\r\n\r\n    _createClass(AAC, null, [{\r\n        key: 'getSilentFrame',\r\n        value: function getSilentFrame(codec, channelCount) {\r\n            if (codec === 'mp4a.40.2') {\r\n                // handle LC-AAC\r\n                if (channelCount === 1) {\r\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x23, 0x80]);\r\n                } else if (channelCount === 2) {\r\n                    return new Uint8Array([0x21, 0x00, 0x49, 0x90, 0x02, 0x19, 0x00, 0x23, 0x80]);\r\n                } else if (channelCount === 3) {\r\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x8e]);\r\n                } else if (channelCount === 4) {\r\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x80, 0x2c, 0x80, 0x08, 0x02, 0x38]);\r\n                } else if (channelCount === 5) {\r\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x38]);\r\n                } else if (channelCount === 6) {\r\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x00, 0xb2, 0x00, 0x20, 0x08, 0xe0]);\r\n                }\r\n            } else {\r\n                // handle HE-AAC (mp4a.40.5 / mp4a.40.29)\r\n                if (channelCount === 1) {\r\n                    // ffmpeg -y -f lavfi -i \"aevalsrc=0:d=0.05\" -c:a libfdk_aac -profile:a aac_he -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\r\n                    return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x4e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x1c, 0x6, 0xf1, 0xc1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\r\n                } else if (channelCount === 2) {\r\n                    // ffmpeg -y -f lavfi -i \"aevalsrc=0|0:d=0.05\" -c:a libfdk_aac -profile:a aac_he_v2 -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\r\n                    return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x5e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x0, 0x95, 0x0, 0x6, 0xf1, 0xa1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\r\n                } else if (channelCount === 3) {\r\n                    // ffmpeg -y -f lavfi -i \"aevalsrc=0|0|0:d=0.05\" -c:a libfdk_aac -profile:a aac_he_v2 -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\r\n                    return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x5e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x0, 0x95, 0x0, 0x6, 0xf1, 0xa1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n    }]);\r\n\r\n    return AAC;\r\n}();\r\n\r\nexports.default = AAC;\r\n\r\n},{}],37:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * This file is derived from dailymotion's hls.js library (hls.js/src/remux/mp4-generator.js)\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\n//  MP4 boxes generator for ISO BMFF (ISO Base Media File Format, defined in ISO/IEC 14496-12)\r\nvar MP4 = function () {\r\n    function MP4() {\r\n        _classCallCheck(this, MP4);\r\n    }\r\n\r\n    _createClass(MP4, null, [{\r\n        key: 'init',\r\n        value: function init() {\r\n            MP4.types = {\r\n                avc1: [], avcC: [], btrt: [], dinf: [],\r\n                dref: [], esds: [], ftyp: [], hdlr: [],\r\n                mdat: [], mdhd: [], mdia: [], mfhd: [],\r\n                minf: [], moof: [], moov: [], mp4a: [],\r\n                mvex: [], mvhd: [], sdtp: [], stbl: [],\r\n                stco: [], stsc: [], stsd: [], stsz: [],\r\n                stts: [], tfdt: [], tfhd: [], traf: [],\r\n                trak: [], trun: [], trex: [], tkhd: [],\r\n                vmhd: [], smhd: [], '.mp3': []\r\n            };\r\n\r\n            for (var name in MP4.types) {\r\n                if (MP4.types.hasOwnProperty(name)) {\r\n                    MP4.types[name] = [name.charCodeAt(0), name.charCodeAt(1), name.charCodeAt(2), name.charCodeAt(3)];\r\n                }\r\n            }\r\n\r\n            var constants = MP4.constants = {};\r\n\r\n            constants.FTYP = new Uint8Array([0x69, 0x73, 0x6F, 0x6D, // major_brand: isom\r\n            0x0, 0x0, 0x0, 0x1, // minor_version: 0x01\r\n            0x69, 0x73, 0x6F, 0x6D, // isom\r\n            0x61, 0x76, 0x63, 0x31 // avc1\r\n            ]);\r\n\r\n            constants.STSD_PREFIX = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\r\n            0x00, 0x00, 0x00, 0x01 // entry_count\r\n            ]);\r\n\r\n            constants.STTS = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\r\n            0x00, 0x00, 0x00, 0x00 // entry_count\r\n            ]);\r\n\r\n            constants.STSC = constants.STCO = constants.STTS;\r\n\r\n            constants.STSZ = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\r\n            0x00, 0x00, 0x00, 0x00, // sample_size\r\n            0x00, 0x00, 0x00, 0x00 // sample_count\r\n            ]);\r\n\r\n            constants.HDLR_VIDEO = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\r\n            0x00, 0x00, 0x00, 0x00, // pre_defined\r\n            0x76, 0x69, 0x64, 0x65, // handler_type: 'vide'\r\n            0x00, 0x00, 0x00, 0x00, // reserved: 3 * 4 bytes\r\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x56, 0x69, 0x64, 0x65, 0x6F, 0x48, 0x61, 0x6E, 0x64, 0x6C, 0x65, 0x72, 0x00 // name: VideoHandler\r\n            ]);\r\n\r\n            constants.HDLR_AUDIO = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\r\n            0x00, 0x00, 0x00, 0x00, // pre_defined\r\n            0x73, 0x6F, 0x75, 0x6E, // handler_type: 'soun'\r\n            0x00, 0x00, 0x00, 0x00, // reserved: 3 * 4 bytes\r\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x53, 0x6F, 0x75, 0x6E, 0x64, 0x48, 0x61, 0x6E, 0x64, 0x6C, 0x65, 0x72, 0x00 // name: SoundHandler\r\n            ]);\r\n\r\n            constants.DREF = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\r\n            0x00, 0x00, 0x00, 0x01, // entry_count\r\n            0x00, 0x00, 0x00, 0x0C, // entry_size\r\n            0x75, 0x72, 0x6C, 0x20, // type 'url '\r\n            0x00, 0x00, 0x00, 0x01 // version(0) + flags\r\n            ]);\r\n\r\n            // Sound media header\r\n            constants.SMHD = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\r\n            0x00, 0x00, 0x00, 0x00 // balance(2) + reserved(2)\r\n            ]);\r\n\r\n            // video media header\r\n            constants.VMHD = new Uint8Array([0x00, 0x00, 0x00, 0x01, // version(0) + flags\r\n            0x00, 0x00, // graphicsmode: 2 bytes\r\n            0x00, 0x00, 0x00, 0x00, // opcolor: 3 * 2 bytes\r\n            0x00, 0x00]);\r\n        }\r\n\r\n        // Generate a box\r\n\r\n    }, {\r\n        key: 'box',\r\n        value: function box(type) {\r\n            var size = 8;\r\n            var result = null;\r\n            var datas = Array.prototype.slice.call(arguments, 1);\r\n            var arrayCount = datas.length;\r\n\r\n            for (var i = 0; i < arrayCount; i++) {\r\n                size += datas[i].byteLength;\r\n            }\r\n\r\n            result = new Uint8Array(size);\r\n            result[0] = size >>> 24 & 0xFF; // size\r\n            result[1] = size >>> 16 & 0xFF;\r\n            result[2] = size >>> 8 & 0xFF;\r\n            result[3] = size & 0xFF;\r\n\r\n            result.set(type, 4); // type\r\n\r\n            var offset = 8;\r\n            for (var _i = 0; _i < arrayCount; _i++) {\r\n                // data body\r\n                result.set(datas[_i], offset);\r\n                offset += datas[_i].byteLength;\r\n            }\r\n\r\n            return result;\r\n        }\r\n\r\n        // emit ftyp & moov\r\n\r\n    }, {\r\n        key: 'generateInitSegment',\r\n        value: function generateInitSegment(meta) {\r\n            var ftyp = MP4.box(MP4.types.ftyp, MP4.constants.FTYP);\r\n            var moov = MP4.moov(meta);\r\n\r\n            var result = new Uint8Array(ftyp.byteLength + moov.byteLength);\r\n            result.set(ftyp, 0);\r\n            result.set(moov, ftyp.byteLength);\r\n            return result;\r\n        }\r\n\r\n        // Movie metadata box\r\n\r\n    }, {\r\n        key: 'moov',\r\n        value: function moov(meta) {\r\n            var mvhd = MP4.mvhd(meta.timescale, meta.duration);\r\n            var trak = MP4.trak(meta);\r\n            var mvex = MP4.mvex(meta);\r\n            return MP4.box(MP4.types.moov, mvhd, trak, mvex);\r\n        }\r\n\r\n        // Movie header box\r\n\r\n    }, {\r\n        key: 'mvhd',\r\n        value: function mvhd(timescale, duration) {\r\n            return MP4.box(MP4.types.mvhd, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\r\n            0x00, 0x00, 0x00, 0x00, // creation_time\r\n            0x00, 0x00, 0x00, 0x00, // modification_time\r\n            timescale >>> 24 & 0xFF, // timescale: 4 bytes\r\n            timescale >>> 16 & 0xFF, timescale >>> 8 & 0xFF, timescale & 0xFF, duration >>> 24 & 0xFF, // duration: 4 bytes\r\n            duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, 0x00, 0x01, 0x00, 0x00, // Preferred rate: 1.0\r\n            0x01, 0x00, 0x00, 0x00, // PreferredVolume(1.0, 2bytes) + reserved(2bytes)\r\n            0x00, 0x00, 0x00, 0x00, // reserved: 4 + 4 bytes\r\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, // ----begin composition matrix----\r\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, // ----end composition matrix----\r\n            0x00, 0x00, 0x00, 0x00, // ----begin pre_defined 6 * 4 bytes----\r\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // ----end pre_defined 6 * 4 bytes----\r\n            0xFF, 0xFF, 0xFF, 0xFF // next_track_ID\r\n            ]));\r\n        }\r\n\r\n        // Track box\r\n\r\n    }, {\r\n        key: 'trak',\r\n        value: function trak(meta) {\r\n            return MP4.box(MP4.types.trak, MP4.tkhd(meta), MP4.mdia(meta));\r\n        }\r\n\r\n        // Track header box\r\n\r\n    }, {\r\n        key: 'tkhd',\r\n        value: function tkhd(meta) {\r\n            var trackId = meta.id,\r\n                duration = meta.duration;\r\n            var width = meta.presentWidth,\r\n                height = meta.presentHeight;\r\n\r\n            return MP4.box(MP4.types.tkhd, new Uint8Array([0x00, 0x00, 0x00, 0x07, // version(0) + flags\r\n            0x00, 0x00, 0x00, 0x00, // creation_time\r\n            0x00, 0x00, 0x00, 0x00, // modification_time\r\n            trackId >>> 24 & 0xFF, // track_ID: 4 bytes\r\n            trackId >>> 16 & 0xFF, trackId >>> 8 & 0xFF, trackId & 0xFF, 0x00, 0x00, 0x00, 0x00, // reserved: 4 bytes\r\n            duration >>> 24 & 0xFF, // duration: 4 bytes\r\n            duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, 0x00, 0x00, 0x00, 0x00, // reserved: 2 * 4 bytes\r\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // layer(2bytes) + alternate_group(2bytes)\r\n            0x00, 0x00, 0x00, 0x00, // volume(2bytes) + reserved(2bytes)\r\n            0x00, 0x01, 0x00, 0x00, // ----begin composition matrix----\r\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, // ----end composition matrix----\r\n            width >>> 8 & 0xFF, // width and height\r\n            width & 0xFF, 0x00, 0x00, height >>> 8 & 0xFF, height & 0xFF, 0x00, 0x00]));\r\n        }\r\n\r\n        // Media Box\r\n\r\n    }, {\r\n        key: 'mdia',\r\n        value: function mdia(meta) {\r\n            return MP4.box(MP4.types.mdia, MP4.mdhd(meta), MP4.hdlr(meta), MP4.minf(meta));\r\n        }\r\n\r\n        // Media header box\r\n\r\n    }, {\r\n        key: 'mdhd',\r\n        value: function mdhd(meta) {\r\n            var timescale = meta.timescale;\r\n            var duration = meta.duration;\r\n            return MP4.box(MP4.types.mdhd, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\r\n            0x00, 0x00, 0x00, 0x00, // creation_time\r\n            0x00, 0x00, 0x00, 0x00, // modification_time\r\n            timescale >>> 24 & 0xFF, // timescale: 4 bytes\r\n            timescale >>> 16 & 0xFF, timescale >>> 8 & 0xFF, timescale & 0xFF, duration >>> 24 & 0xFF, // duration: 4 bytes\r\n            duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, 0x55, 0xC4, // language: und (undetermined)\r\n            0x00, 0x00 // pre_defined = 0\r\n            ]));\r\n        }\r\n\r\n        // Media handler reference box\r\n\r\n    }, {\r\n        key: 'hdlr',\r\n        value: function hdlr(meta) {\r\n            var data = null;\r\n            if (meta.type === 'audio') {\r\n                data = MP4.constants.HDLR_AUDIO;\r\n            } else {\r\n                data = MP4.constants.HDLR_VIDEO;\r\n            }\r\n            return MP4.box(MP4.types.hdlr, data);\r\n        }\r\n\r\n        // Media infomation box\r\n\r\n    }, {\r\n        key: 'minf',\r\n        value: function minf(meta) {\r\n            var xmhd = null;\r\n            if (meta.type === 'audio') {\r\n                xmhd = MP4.box(MP4.types.smhd, MP4.constants.SMHD);\r\n            } else {\r\n                xmhd = MP4.box(MP4.types.vmhd, MP4.constants.VMHD);\r\n            }\r\n            return MP4.box(MP4.types.minf, xmhd, MP4.dinf(), MP4.stbl(meta));\r\n        }\r\n\r\n        // Data infomation box\r\n\r\n    }, {\r\n        key: 'dinf',\r\n        value: function dinf() {\r\n            var result = MP4.box(MP4.types.dinf, MP4.box(MP4.types.dref, MP4.constants.DREF));\r\n            return result;\r\n        }\r\n\r\n        // Sample table box\r\n\r\n    }, {\r\n        key: 'stbl',\r\n        value: function stbl(meta) {\r\n            var result = MP4.box(MP4.types.stbl, // type: stbl\r\n            MP4.stsd(meta), // Sample Description Table\r\n            MP4.box(MP4.types.stts, MP4.constants.STTS), // Time-To-Sample\r\n            MP4.box(MP4.types.stsc, MP4.constants.STSC), // Sample-To-Chunk\r\n            MP4.box(MP4.types.stsz, MP4.constants.STSZ), // Sample size\r\n            MP4.box(MP4.types.stco, MP4.constants.STCO // Chunk offset\r\n            ));\r\n            return result;\r\n        }\r\n\r\n        // Sample description box\r\n\r\n    }, {\r\n        key: 'stsd',\r\n        value: function stsd(meta) {\r\n            if (meta.type === 'audio') {\r\n                if (meta.codec === 'mp3') {\r\n                    return MP4.box(MP4.types.stsd, MP4.constants.STSD_PREFIX, MP4.mp3(meta));\r\n                }\r\n                // else: aac -> mp4a\r\n                return MP4.box(MP4.types.stsd, MP4.constants.STSD_PREFIX, MP4.mp4a(meta));\r\n            } else {\r\n                return MP4.box(MP4.types.stsd, MP4.constants.STSD_PREFIX, MP4.avc1(meta));\r\n            }\r\n        }\r\n    }, {\r\n        key: 'mp3',\r\n        value: function mp3(meta) {\r\n            var channelCount = meta.channelCount;\r\n            var sampleRate = meta.audioSampleRate;\r\n\r\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // reserved(4)\r\n            0x00, 0x00, 0x00, 0x01, // reserved(2) + data_reference_index(2)\r\n            0x00, 0x00, 0x00, 0x00, // reserved: 2 * 4 bytes\r\n            0x00, 0x00, 0x00, 0x00, 0x00, channelCount, // channelCount(2)\r\n            0x00, 0x10, // sampleSize(2)\r\n            0x00, 0x00, 0x00, 0x00, // reserved(4)\r\n            sampleRate >>> 8 & 0xFF, // Audio sample rate\r\n            sampleRate & 0xFF, 0x00, 0x00]);\r\n\r\n            return MP4.box(MP4.types['.mp3'], data);\r\n        }\r\n    }, {\r\n        key: 'mp4a',\r\n        value: function mp4a(meta) {\r\n            var channelCount = meta.channelCount;\r\n            var sampleRate = meta.audioSampleRate;\r\n\r\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // reserved(4)\r\n            0x00, 0x00, 0x00, 0x01, // reserved(2) + data_reference_index(2)\r\n            0x00, 0x00, 0x00, 0x00, // reserved: 2 * 4 bytes\r\n            0x00, 0x00, 0x00, 0x00, 0x00, channelCount, // channelCount(2)\r\n            0x00, 0x10, // sampleSize(2)\r\n            0x00, 0x00, 0x00, 0x00, // reserved(4)\r\n            sampleRate >>> 8 & 0xFF, // Audio sample rate\r\n            sampleRate & 0xFF, 0x00, 0x00]);\r\n\r\n            return MP4.box(MP4.types.mp4a, data, MP4.esds(meta));\r\n        }\r\n    }, {\r\n        key: 'esds',\r\n        value: function esds(meta) {\r\n            var config = meta.config || [];\r\n            var configSize = config.length;\r\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version 0 + flags\r\n\r\n            0x03, // descriptor_type\r\n            0x17 + configSize, // length3\r\n            0x00, 0x01, // es_id\r\n            0x00, // stream_priority\r\n\r\n            0x04, // descriptor_type\r\n            0x0F + configSize, // length\r\n            0x40, // codec: mpeg4_audio\r\n            0x15, // stream_type: Audio\r\n            0x00, 0x00, 0x00, // buffer_size\r\n            0x00, 0x00, 0x00, 0x00, // maxBitrate\r\n            0x00, 0x00, 0x00, 0x00, // avgBitrate\r\n\r\n            0x05 // descriptor_type\r\n            ].concat([configSize]).concat(config).concat([0x06, 0x01, 0x02 // GASpecificConfig\r\n            ]));\r\n            return MP4.box(MP4.types.esds, data);\r\n        }\r\n    }, {\r\n        key: 'avc1',\r\n        value: function avc1(meta) {\r\n            var avcc = meta.avcc;\r\n            var width = meta.codecWidth,\r\n                height = meta.codecHeight;\r\n\r\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // reserved(4)\r\n            0x00, 0x00, 0x00, 0x01, // reserved(2) + data_reference_index(2)\r\n            0x00, 0x00, 0x00, 0x00, // pre_defined(2) + reserved(2)\r\n            0x00, 0x00, 0x00, 0x00, // pre_defined: 3 * 4 bytes\r\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, width >>> 8 & 0xFF, // width: 2 bytes\r\n            width & 0xFF, height >>> 8 & 0xFF, // height: 2 bytes\r\n            height & 0xFF, 0x00, 0x48, 0x00, 0x00, // horizresolution: 4 bytes\r\n            0x00, 0x48, 0x00, 0x00, // vertresolution: 4 bytes\r\n            0x00, 0x00, 0x00, 0x00, // reserved: 4 bytes\r\n            0x00, 0x01, // frame_count\r\n            0x0A, // strlen\r\n            0x78, 0x71, 0x71, 0x2F, // compressorname: 32 bytes\r\n            0x66, 0x6C, 0x76, 0x2E, 0x6A, 0x73, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, // depth\r\n            0xFF, 0xFF // pre_defined = -1\r\n            ]);\r\n            return MP4.box(MP4.types.avc1, data, MP4.box(MP4.types.avcC, avcc));\r\n        }\r\n\r\n        // Movie Extends box\r\n\r\n    }, {\r\n        key: 'mvex',\r\n        value: function mvex(meta) {\r\n            return MP4.box(MP4.types.mvex, MP4.trex(meta));\r\n        }\r\n\r\n        // Track Extends box\r\n\r\n    }, {\r\n        key: 'trex',\r\n        value: function trex(meta) {\r\n            var trackId = meta.id;\r\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\r\n            trackId >>> 24 & 0xFF, // track_ID\r\n            trackId >>> 16 & 0xFF, trackId >>> 8 & 0xFF, trackId & 0xFF, 0x00, 0x00, 0x00, 0x01, // default_sample_description_index\r\n            0x00, 0x00, 0x00, 0x00, // default_sample_duration\r\n            0x00, 0x00, 0x00, 0x00, // default_sample_size\r\n            0x00, 0x01, 0x00, 0x01 // default_sample_flags\r\n            ]);\r\n            return MP4.box(MP4.types.trex, data);\r\n        }\r\n\r\n        // Movie fragment box\r\n\r\n    }, {\r\n        key: 'moof',\r\n        value: function moof(track, baseMediaDecodeTime) {\r\n            return MP4.box(MP4.types.moof, MP4.mfhd(track.sequenceNumber), MP4.traf(track, baseMediaDecodeTime));\r\n        }\r\n    }, {\r\n        key: 'mfhd',\r\n        value: function mfhd(sequenceNumber) {\r\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, sequenceNumber >>> 24 & 0xFF, // sequence_number: int32\r\n            sequenceNumber >>> 16 & 0xFF, sequenceNumber >>> 8 & 0xFF, sequenceNumber & 0xFF]);\r\n            return MP4.box(MP4.types.mfhd, data);\r\n        }\r\n\r\n        // Track fragment box\r\n\r\n    }, {\r\n        key: 'traf',\r\n        value: function traf(track, baseMediaDecodeTime) {\r\n            var trackId = track.id;\r\n\r\n            // Track fragment header box\r\n            var tfhd = MP4.box(MP4.types.tfhd, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) & flags\r\n            trackId >>> 24 & 0xFF, // track_ID\r\n            trackId >>> 16 & 0xFF, trackId >>> 8 & 0xFF, trackId & 0xFF]));\r\n            // Track Fragment Decode Time\r\n            var tfdt = MP4.box(MP4.types.tfdt, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) & flags\r\n            baseMediaDecodeTime >>> 24 & 0xFF, // baseMediaDecodeTime: int32\r\n            baseMediaDecodeTime >>> 16 & 0xFF, baseMediaDecodeTime >>> 8 & 0xFF, baseMediaDecodeTime & 0xFF]));\r\n            var sdtp = MP4.sdtp(track);\r\n            var trun = MP4.trun(track, sdtp.byteLength + 16 + 16 + 8 + 16 + 8 + 8);\r\n\r\n            return MP4.box(MP4.types.traf, tfhd, tfdt, trun, sdtp);\r\n        }\r\n\r\n        // Sample Dependency Type box\r\n\r\n    }, {\r\n        key: 'sdtp',\r\n        value: function sdtp(track) {\r\n            var samples = track.samples || [];\r\n            var sampleCount = samples.length;\r\n            var data = new Uint8Array(4 + sampleCount);\r\n            // 0~4 bytes: version(0) & flags\r\n            for (var i = 0; i < sampleCount; i++) {\r\n                var flags = samples[i].flags;\r\n                data[i + 4] = flags.isLeading << 6 | // is_leading: 2 (bit)\r\n                flags.dependsOn << 4 // sample_depends_on\r\n                | flags.isDependedOn << 2 // sample_is_depended_on\r\n                | flags.hasRedundancy; // sample_has_redundancy\r\n            }\r\n            return MP4.box(MP4.types.sdtp, data);\r\n        }\r\n\r\n        // Track fragment run box\r\n\r\n    }, {\r\n        key: 'trun',\r\n        value: function trun(track, offset) {\r\n            var samples = track.samples || [];\r\n            var sampleCount = samples.length;\r\n            var dataSize = 12 + 16 * sampleCount;\r\n            var data = new Uint8Array(dataSize);\r\n            offset += 8 + dataSize;\r\n\r\n            data.set([0x00, 0x00, 0x0F, 0x01, // version(0) & flags\r\n            sampleCount >>> 24 & 0xFF, // sample_count\r\n            sampleCount >>> 16 & 0xFF, sampleCount >>> 8 & 0xFF, sampleCount & 0xFF, offset >>> 24 & 0xFF, // data_offset\r\n            offset >>> 16 & 0xFF, offset >>> 8 & 0xFF, offset & 0xFF], 0);\r\n\r\n            for (var i = 0; i < sampleCount; i++) {\r\n                var duration = samples[i].duration;\r\n                var size = samples[i].size;\r\n                var flags = samples[i].flags;\r\n                var cts = samples[i].cts;\r\n                data.set([duration >>> 24 & 0xFF, // sample_duration\r\n                duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, size >>> 24 & 0xFF, // sample_size\r\n                size >>> 16 & 0xFF, size >>> 8 & 0xFF, size & 0xFF, flags.isLeading << 2 | flags.dependsOn, // sample_flags\r\n                flags.isDependedOn << 6 | flags.hasRedundancy << 4 | flags.isNonSync, 0x00, 0x00, // sample_degradation_priority\r\n                cts >>> 24 & 0xFF, // sample_composition_time_offset\r\n                cts >>> 16 & 0xFF, cts >>> 8 & 0xFF, cts & 0xFF], 12 + 16 * i);\r\n            }\r\n            return MP4.box(MP4.types.trun, data);\r\n        }\r\n    }, {\r\n        key: 'mdat',\r\n        value: function mdat(data) {\r\n            return MP4.box(MP4.types.mdat, data);\r\n        }\r\n    }]);\r\n\r\n    return MP4;\r\n}();\r\n\r\nMP4.init();\r\n\r\nexports.default = MP4;\r\n\r\n},{}],38:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _logger = _dereq_('../utils/logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nvar _mp4Generator = _dereq_('./mp4-generator.js');\r\n\r\nvar _mp4Generator2 = _interopRequireDefault(_mp4Generator);\r\n\r\nvar _aacSilent = _dereq_('./aac-silent.js');\r\n\r\nvar _aacSilent2 = _interopRequireDefault(_aacSilent);\r\n\r\nvar _browser = _dereq_('../utils/browser.js');\r\n\r\nvar _browser2 = _interopRequireDefault(_browser);\r\n\r\nvar _mediaSegmentInfo = _dereq_('../core/media-segment-info.js');\r\n\r\nvar _exception = _dereq_('../utils/exception.js');\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n// Fragmented mp4 remuxer\r\nvar MP4Remuxer = function () {\r\n    function MP4Remuxer(config) {\r\n        _classCallCheck(this, MP4Remuxer);\r\n\r\n        this.TAG = 'MP4Remuxer';\r\n\r\n        this._config = config;\r\n        this._isLive = config.isLive === true ? true : false;\r\n\r\n        this._dtsBase = -1;\r\n        this._dtsBaseInited = false;\r\n        this._audioDtsBase = Infinity;\r\n        this._videoDtsBase = Infinity;\r\n        this._audioNextDts = undefined;\r\n        this._videoNextDts = undefined;\r\n\r\n        this._audioMeta = null;\r\n        this._videoMeta = null;\r\n\r\n        this._audioSegmentInfoList = new _mediaSegmentInfo.MediaSegmentInfoList('audio');\r\n        this._videoSegmentInfoList = new _mediaSegmentInfo.MediaSegmentInfoList('video');\r\n\r\n        this._onInitSegment = null;\r\n        this._onMediaSegment = null;\r\n\r\n        // Workaround for chrome < 50: Always force first sample as a Random Access Point in media segment\r\n        // see https://bugs.chromium.org/p/chromium/issues/detail?id=229412\r\n        this._forceFirstIDR = _browser2.default.chrome && (_browser2.default.version.major < 50 || _browser2.default.version.major === 50 && _browser2.default.version.build < 2661) ? true : false;\r\n\r\n        // Workaround for IE11/Edge: Fill silent aac frame after keyframe-seeking\r\n        // Make audio beginDts equals with video beginDts, in order to fix seek freeze\r\n        this._fillSilentAfterSeek = _browser2.default.msedge || _browser2.default.msie;\r\n\r\n        // While only FireFox supports 'audio/mp4, codecs=\"mp3\"', use 'audio/mpeg' for chrome, safari, ...\r\n        this._mp3UseMpegAudio = !_browser2.default.firefox;\r\n\r\n        this._fillAudioTimestampGap = this._config.fixAudioTimestampGap;\r\n    }\r\n\r\n    _createClass(MP4Remuxer, [{\r\n        key: 'destroy',\r\n        value: function destroy() {\r\n            this._dtsBase = -1;\r\n            this._dtsBaseInited = false;\r\n            this._audioMeta = null;\r\n            this._videoMeta = null;\r\n            this._audioSegmentInfoList.clear();\r\n            this._audioSegmentInfoList = null;\r\n            this._videoSegmentInfoList.clear();\r\n            this._videoSegmentInfoList = null;\r\n            this._onInitSegment = null;\r\n            this._onMediaSegment = null;\r\n        }\r\n    }, {\r\n        key: 'bindDataSource',\r\n        value: function bindDataSource(producer) {\r\n            producer.onDataAvailable = this.remux.bind(this);\r\n            producer.onTrackMetadata = this._onTrackMetadataReceived.bind(this);\r\n            return this;\r\n        }\r\n\r\n        /* prototype: function onInitSegment(type: string, initSegment: ArrayBuffer): void\r\n           InitSegment: {\r\n               type: string,\r\n               data: ArrayBuffer,\r\n               codec: string,\r\n               container: string\r\n           }\r\n        */\r\n\r\n    }, {\r\n        key: 'insertDiscontinuity',\r\n        value: function insertDiscontinuity() {\r\n            this._audioNextDts = this._videoNextDts = undefined;\r\n        }\r\n    }, {\r\n        key: 'seek',\r\n        value: function seek(originalDts) {\r\n            this._videoSegmentInfoList.clear();\r\n            this._audioSegmentInfoList.clear();\r\n        }\r\n    }, {\r\n        key: 'remux',\r\n        value: function remux(audioTrack, videoTrack) {\r\n            if (!this._onMediaSegment) {\r\n                throw new _exception.IllegalStateException('MP4Remuxer: onMediaSegment callback must be specificed!');\r\n            }\r\n            if (!this._dtsBaseInited) {\r\n                this._calculateDtsBase(audioTrack, videoTrack);\r\n            }\r\n            this._remuxVideo(videoTrack);\r\n            this._remuxAudio(audioTrack);\r\n        }\r\n    }, {\r\n        key: '_onTrackMetadataReceived',\r\n        value: function _onTrackMetadataReceived(type, metadata) {\r\n            var metabox = null;\r\n\r\n            var container = 'mp4';\r\n            var codec = metadata.codec;\r\n\r\n            if (type === 'audio') {\r\n                this._audioMeta = metadata;\r\n                if (metadata.codec === 'mp3' && this._mp3UseMpegAudio) {\r\n                    // 'audio/mpeg' for MP3 audio track\r\n                    container = 'mpeg';\r\n                    codec = '';\r\n                    metabox = new Uint8Array();\r\n                } else {\r\n                    // 'audio/mp4, codecs=\"codec\"'\r\n                    metabox = _mp4Generator2.default.generateInitSegment(metadata);\r\n                }\r\n            } else if (type === 'video') {\r\n                this._videoMeta = metadata;\r\n                metabox = _mp4Generator2.default.generateInitSegment(metadata);\r\n            } else {\r\n                return;\r\n            }\r\n\r\n            // dispatch metabox (Initialization Segment)\r\n            if (!this._onInitSegment) {\r\n                throw new _exception.IllegalStateException('MP4Remuxer: onInitSegment callback must be specified!');\r\n            }\r\n            this._onInitSegment(type, {\r\n                type: type,\r\n                data: metabox.buffer,\r\n                codec: codec,\r\n                container: type + '/' + container,\r\n                mediaDuration: metadata.duration // in timescale 1000 (milliseconds)\r\n            });\r\n        }\r\n    }, {\r\n        key: '_calculateDtsBase',\r\n        value: function _calculateDtsBase(audioTrack, videoTrack) {\r\n            if (this._dtsBaseInited) {\r\n                return;\r\n            }\r\n\r\n            if (audioTrack.samples && audioTrack.samples.length) {\r\n                this._audioDtsBase = audioTrack.samples[0].dts;\r\n            }\r\n            if (videoTrack.samples && videoTrack.samples.length) {\r\n                this._videoDtsBase = videoTrack.samples[0].dts;\r\n            }\r\n\r\n            this._dtsBase = Math.min(this._audioDtsBase, this._videoDtsBase);\r\n            this._dtsBaseInited = true;\r\n        }\r\n    }, {\r\n        key: '_remuxAudio',\r\n        value: function _remuxAudio(audioTrack) {\r\n            if (this._audioMeta == null) {\r\n                return;\r\n            }\r\n\r\n            var track = audioTrack;\r\n            var samples = track.samples;\r\n            var dtsCorrection = undefined;\r\n            var firstDts = -1,\r\n                lastDts = -1,\r\n                lastPts = -1;\r\n            var refSampleDuration = this._audioMeta.refSampleDuration;\r\n\r\n            var mpegRawTrack = this._audioMeta.codec === 'mp3' && this._mp3UseMpegAudio;\r\n            var firstSegmentAfterSeek = this._dtsBaseInited && this._audioNextDts === undefined;\r\n\r\n            var insertPrefixSilentFrame = false;\r\n\r\n            if (!samples || samples.length === 0) {\r\n                return;\r\n            }\r\n\r\n            var offset = 0;\r\n            var mdatbox = null;\r\n            var mdatBytes = 0;\r\n\r\n            // calculate initial mdat size\r\n            if (mpegRawTrack) {\r\n                // for raw mpeg buffer\r\n                offset = 0;\r\n                mdatBytes = track.length;\r\n            } else {\r\n                // for fmp4 mdat box\r\n                offset = 8; // size + type\r\n                mdatBytes = 8 + track.length;\r\n            }\r\n\r\n            var firstSampleOriginalDts = samples[0].dts - this._dtsBase;\r\n\r\n            // calculate dtsCorrection\r\n            if (this._audioNextDts) {\r\n                dtsCorrection = firstSampleOriginalDts - this._audioNextDts;\r\n            } else {\r\n                // this._audioNextDts == undefined\r\n                if (this._audioSegmentInfoList.isEmpty()) {\r\n                    dtsCorrection = 0;\r\n                    if (this._fillSilentAfterSeek && !this._videoSegmentInfoList.isEmpty()) {\r\n                        if (this._audioMeta.originalCodec !== 'mp3') {\r\n                            insertPrefixSilentFrame = true;\r\n                        }\r\n                    }\r\n                } else {\r\n                    var lastSample = this._audioSegmentInfoList.getLastSampleBefore(firstSampleOriginalDts);\r\n                    if (lastSample != null) {\r\n                        var distance = firstSampleOriginalDts - (lastSample.originalDts + lastSample.duration);\r\n                        if (distance <= 3) {\r\n                            distance = 0;\r\n                        }\r\n                        var expectedDts = lastSample.dts + lastSample.duration + distance;\r\n                        dtsCorrection = firstSampleOriginalDts - expectedDts;\r\n                    } else {\r\n                        // lastSample == null, cannot found\r\n                        dtsCorrection = 0;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (insertPrefixSilentFrame) {\r\n                // align audio segment beginDts to match with current video segment's beginDts\r\n                var firstSampleDts = firstSampleOriginalDts - dtsCorrection;\r\n                var videoSegment = this._videoSegmentInfoList.getLastSegmentBefore(firstSampleOriginalDts);\r\n                if (videoSegment != null && videoSegment.beginDts < firstSampleDts) {\r\n                    var silentUnit = _aacSilent2.default.getSilentFrame(this._audioMeta.originalCodec, this._audioMeta.channelCount);\r\n                    if (silentUnit) {\r\n                        var dts = videoSegment.beginDts;\r\n                        var silentFrameDuration = firstSampleDts - videoSegment.beginDts;\r\n                        _logger2.default.v(this.TAG, 'InsertPrefixSilentAudio: dts: ' + dts + ', duration: ' + silentFrameDuration);\r\n                        samples.unshift({ unit: silentUnit, dts: dts, pts: dts });\r\n                        mdatBytes += silentUnit.byteLength;\r\n                    } // silentUnit == null: Cannot generate, skip\r\n                } else {\r\n                    insertPrefixSilentFrame = false;\r\n                }\r\n            }\r\n\r\n            var mp4Samples = [];\r\n\r\n            // Correct dts for each sample, and calculate sample duration. Then output to mp4Samples\r\n            for (var i = 0; i < samples.length; i++) {\r\n                var sample = samples[i];\r\n                var unit = sample.unit;\r\n                var originalDts = sample.dts - this._dtsBase;\r\n                var _dts = originalDts - dtsCorrection;\r\n\r\n                if (firstDts === -1) {\r\n                    firstDts = _dts;\r\n                }\r\n\r\n                var sampleDuration = 0;\r\n\r\n                if (i !== samples.length - 1) {\r\n                    var nextDts = samples[i + 1].dts - this._dtsBase - dtsCorrection;\r\n                    sampleDuration = nextDts - _dts;\r\n                } else {\r\n                    // the last sample\r\n                    if (mp4Samples.length >= 1) {\r\n                        // use second last sample duration\r\n                        sampleDuration = mp4Samples[mp4Samples.length - 1].duration;\r\n                    } else {\r\n                        // the only one sample, use reference sample duration\r\n                        sampleDuration = Math.floor(refSampleDuration);\r\n                    }\r\n                }\r\n\r\n                var needFillSilentFrames = false;\r\n                var silentFrames = null;\r\n\r\n                // Silent frame generation, if large timestamp gap detected && config.fixAudioTimestampGap\r\n                if (sampleDuration > refSampleDuration * 1.5 && this._audioMeta.codec !== 'mp3' && this._fillAudioTimestampGap && !_browser2.default.safari) {\r\n                    // We need to insert silent frames to fill timestamp gap\r\n                    needFillSilentFrames = true;\r\n                    var delta = Math.abs(sampleDuration - refSampleDuration);\r\n                    var frameCount = Math.ceil(delta / refSampleDuration);\r\n                    var currentDts = _dts + refSampleDuration; // Notice: in float\r\n\r\n                    _logger2.default.w(this.TAG, 'Large audio timestamp gap detected, may cause AV sync to drift. ' + 'Silent frames will be generated to avoid unsync.\\n' + ('dts: ' + (_dts + sampleDuration) + ' ms, expected: ' + (_dts + Math.round(refSampleDuration)) + ' ms, ') + ('delta: ' + Math.round(delta) + ' ms, generate: ' + frameCount + ' frames'));\r\n\r\n                    var _silentUnit = _aacSilent2.default.getSilentFrame(this._audioMeta.originalCodec, this._audioMeta.channelCount);\r\n                    if (_silentUnit == null) {\r\n                        _logger2.default.w(this.TAG, 'Unable to generate silent frame for ' + (this._audioMeta.originalCodec + ' with ' + this._audioMeta.channelCount + ' channels, repeat last frame'));\r\n                        // Repeat last frame\r\n                        _silentUnit = unit;\r\n                    }\r\n                    silentFrames = [];\r\n\r\n                    for (var j = 0; j < frameCount; j++) {\r\n                        var intDts = Math.round(currentDts); // round to integer\r\n                        if (silentFrames.length > 0) {\r\n                            // Set previous frame sample duration\r\n                            var previousFrame = silentFrames[silentFrames.length - 1];\r\n                            previousFrame.duration = intDts - previousFrame.dts;\r\n                        }\r\n                        var frame = {\r\n                            dts: intDts,\r\n                            pts: intDts,\r\n                            cts: 0,\r\n                            unit: _silentUnit,\r\n                            size: _silentUnit.byteLength,\r\n                            duration: 0, // wait for next sample\r\n                            originalDts: originalDts,\r\n                            flags: {\r\n                                isLeading: 0,\r\n                                dependsOn: 1,\r\n                                isDependedOn: 0,\r\n                                hasRedundancy: 0\r\n                            }\r\n                        };\r\n                        silentFrames.push(frame);\r\n                        mdatBytes += unit.byteLength;\r\n                        currentDts += refSampleDuration;\r\n                    }\r\n\r\n                    // last frame: align end time to next frame dts\r\n                    var lastFrame = silentFrames[silentFrames.length - 1];\r\n                    lastFrame.duration = _dts + sampleDuration - lastFrame.dts;\r\n\r\n                    // silentFrames.forEach((frame) => {\r\n                    //     Log.w(this.TAG, `SilentAudio: dts: ${frame.dts}, duration: ${frame.duration}`);\r\n                    // });\r\n\r\n                    // Set correct sample duration for current frame\r\n                    sampleDuration = Math.round(refSampleDuration);\r\n                }\r\n\r\n                mp4Samples.push({\r\n                    dts: _dts,\r\n                    pts: _dts,\r\n                    cts: 0,\r\n                    unit: sample.unit,\r\n                    size: sample.unit.byteLength,\r\n                    duration: sampleDuration,\r\n                    originalDts: originalDts,\r\n                    flags: {\r\n                        isLeading: 0,\r\n                        dependsOn: 1,\r\n                        isDependedOn: 0,\r\n                        hasRedundancy: 0\r\n                    }\r\n                });\r\n\r\n                if (needFillSilentFrames) {\r\n                    // Silent frames should be inserted after wrong-duration frame\r\n                    mp4Samples.push.apply(mp4Samples, silentFrames);\r\n                }\r\n            }\r\n\r\n            // allocate mdatbox\r\n            if (mpegRawTrack) {\r\n                // allocate for raw mpeg buffer\r\n                mdatbox = new Uint8Array(mdatBytes);\r\n            } else {\r\n                // allocate for fmp4 mdat box\r\n                mdatbox = new Uint8Array(mdatBytes);\r\n                // size field\r\n                mdatbox[0] = mdatBytes >>> 24 & 0xFF;\r\n                mdatbox[1] = mdatBytes >>> 16 & 0xFF;\r\n                mdatbox[2] = mdatBytes >>> 8 & 0xFF;\r\n                mdatbox[3] = mdatBytes & 0xFF;\r\n                // type field (fourCC)\r\n                mdatbox.set(_mp4Generator2.default.types.mdat, 4);\r\n            }\r\n\r\n            // Write samples into mdatbox\r\n            for (var _i = 0; _i < mp4Samples.length; _i++) {\r\n                var _unit = mp4Samples[_i].unit;\r\n                mdatbox.set(_unit, offset);\r\n                offset += _unit.byteLength;\r\n            }\r\n\r\n            var latest = mp4Samples[mp4Samples.length - 1];\r\n            lastDts = latest.dts + latest.duration;\r\n            this._audioNextDts = lastDts;\r\n\r\n            // fill media segment info & add to info list\r\n            var info = new _mediaSegmentInfo.MediaSegmentInfo();\r\n            info.beginDts = firstDts;\r\n            info.endDts = lastDts;\r\n            info.beginPts = firstDts;\r\n            info.endPts = lastDts;\r\n            info.originalBeginDts = mp4Samples[0].originalDts;\r\n            info.originalEndDts = latest.originalDts + latest.duration;\r\n            info.firstSample = new _mediaSegmentInfo.SampleInfo(mp4Samples[0].dts, mp4Samples[0].pts, mp4Samples[0].duration, mp4Samples[0].originalDts, false);\r\n            info.lastSample = new _mediaSegmentInfo.SampleInfo(latest.dts, latest.pts, latest.duration, latest.originalDts, false);\r\n            if (!this._isLive) {\r\n                this._audioSegmentInfoList.append(info);\r\n            }\r\n\r\n            track.samples = mp4Samples;\r\n            track.sequenceNumber++;\r\n\r\n            var moofbox = null;\r\n\r\n            if (mpegRawTrack) {\r\n                // Generate empty buffer, because useless for raw mpeg\r\n                moofbox = new Uint8Array();\r\n            } else {\r\n                // Generate moof for fmp4 segment\r\n                moofbox = _mp4Generator2.default.moof(track, firstDts);\r\n            }\r\n\r\n            track.samples = [];\r\n            track.length = 0;\r\n\r\n            var segment = {\r\n                type: 'audio',\r\n                data: this._mergeBoxes(moofbox, mdatbox).buffer,\r\n                sampleCount: mp4Samples.length,\r\n                info: info\r\n            };\r\n\r\n            if (mpegRawTrack && firstSegmentAfterSeek) {\r\n                // For MPEG audio stream in MSE, if seeking occurred, before appending new buffer\r\n                // We need explicitly set timestampOffset to the desired point in timeline for mpeg SourceBuffer.\r\n                segment.timestampOffset = firstDts;\r\n            }\r\n\r\n            this._onMediaSegment('audio', segment);\r\n        }\r\n    }, {\r\n        key: '_remuxVideo',\r\n        value: function _remuxVideo(videoTrack) {\r\n            if (this._videoMeta == null) {\r\n                return;\r\n            }\r\n\r\n            var track = videoTrack;\r\n            var samples = track.samples;\r\n            var dtsCorrection = undefined;\r\n            var firstDts = -1,\r\n                lastDts = -1;\r\n            var firstPts = -1,\r\n                lastPts = -1;\r\n\r\n            if (!samples || samples.length === 0) {\r\n                return;\r\n            }\r\n\r\n            var offset = 8;\r\n            var mdatBytes = 8 + videoTrack.length;\r\n            var mdatbox = new Uint8Array(mdatBytes);\r\n            mdatbox[0] = mdatBytes >>> 24 & 0xFF;\r\n            mdatbox[1] = mdatBytes >>> 16 & 0xFF;\r\n            mdatbox[2] = mdatBytes >>> 8 & 0xFF;\r\n            mdatbox[3] = mdatBytes & 0xFF;\r\n            mdatbox.set(_mp4Generator2.default.types.mdat, 4);\r\n\r\n            var firstSampleOriginalDts = samples[0].dts - this._dtsBase;\r\n\r\n            // calculate dtsCorrection\r\n            if (this._videoNextDts) {\r\n                dtsCorrection = firstSampleOriginalDts - this._videoNextDts;\r\n            } else {\r\n                // this._videoNextDts == undefined\r\n                if (this._videoSegmentInfoList.isEmpty()) {\r\n                    dtsCorrection = 0;\r\n                } else {\r\n                    var lastSample = this._videoSegmentInfoList.getLastSampleBefore(firstSampleOriginalDts);\r\n                    if (lastSample != null) {\r\n                        var distance = firstSampleOriginalDts - (lastSample.originalDts + lastSample.duration);\r\n                        if (distance <= 3) {\r\n                            distance = 0;\r\n                        }\r\n                        var expectedDts = lastSample.dts + lastSample.duration + distance;\r\n                        dtsCorrection = firstSampleOriginalDts - expectedDts;\r\n                    } else {\r\n                        // lastSample == null, cannot found\r\n                        dtsCorrection = 0;\r\n                    }\r\n                }\r\n            }\r\n\r\n            var info = new _mediaSegmentInfo.MediaSegmentInfo();\r\n            var mp4Samples = [];\r\n\r\n            // Correct dts for each sample, and calculate sample duration. Then output to mp4Samples\r\n            for (var i = 0; i < samples.length; i++) {\r\n                var sample = samples[i];\r\n                var originalDts = sample.dts - this._dtsBase;\r\n                var isKeyframe = sample.isKeyframe;\r\n                var dts = originalDts - dtsCorrection;\r\n                var cts = sample.cts;\r\n                var pts = dts + cts;\r\n\r\n                if (firstDts === -1) {\r\n                    firstDts = dts;\r\n                    firstPts = pts;\r\n                }\r\n\r\n                var sampleDuration = 0;\r\n\r\n                if (i !== samples.length - 1) {\r\n                    var nextDts = samples[i + 1].dts - this._dtsBase - dtsCorrection;\r\n                    sampleDuration = nextDts - dts;\r\n                } else {\r\n                    // the last sample\r\n                    if (mp4Samples.length >= 1) {\r\n                        // use second last sample duration\r\n                        sampleDuration = mp4Samples[mp4Samples.length - 1].duration;\r\n                    } else {\r\n                        // the only one sample, use reference sample duration\r\n                        sampleDuration = Math.floor(this._videoMeta.refSampleDuration);\r\n                    }\r\n                }\r\n\r\n                if (isKeyframe) {\r\n                    var syncPoint = new _mediaSegmentInfo.SampleInfo(dts, pts, sampleDuration, sample.dts, true);\r\n                    syncPoint.fileposition = sample.fileposition;\r\n                    info.appendSyncPoint(syncPoint);\r\n                }\r\n\r\n                mp4Samples.push({\r\n                    dts: dts,\r\n                    pts: pts,\r\n                    cts: cts,\r\n                    units: sample.units,\r\n                    size: sample.length,\r\n                    isKeyframe: isKeyframe,\r\n                    duration: sampleDuration,\r\n                    originalDts: originalDts,\r\n                    flags: {\r\n                        isLeading: 0,\r\n                        dependsOn: isKeyframe ? 2 : 1,\r\n                        isDependedOn: isKeyframe ? 1 : 0,\r\n                        hasRedundancy: 0,\r\n                        isNonSync: isKeyframe ? 0 : 1\r\n                    }\r\n                });\r\n            }\r\n\r\n            // Write samples into mdatbox\r\n            for (var _i2 = 0; _i2 < mp4Samples.length; _i2++) {\r\n                var units = mp4Samples[_i2].units;\r\n                while (units.length) {\r\n                    var unit = units.shift();\r\n                    var data = unit.data;\r\n                    mdatbox.set(data, offset);\r\n                    offset += data.byteLength;\r\n                }\r\n            }\r\n\r\n            var latest = mp4Samples[mp4Samples.length - 1];\r\n            lastDts = latest.dts + latest.duration;\r\n            lastPts = latest.pts + latest.duration;\r\n            this._videoNextDts = lastDts;\r\n\r\n            // fill media segment info & add to info list\r\n            info.beginDts = firstDts;\r\n            info.endDts = lastDts;\r\n            info.beginPts = firstPts;\r\n            info.endPts = lastPts;\r\n            info.originalBeginDts = mp4Samples[0].originalDts;\r\n            info.originalEndDts = latest.originalDts + latest.duration;\r\n            info.firstSample = new _mediaSegmentInfo.SampleInfo(mp4Samples[0].dts, mp4Samples[0].pts, mp4Samples[0].duration, mp4Samples[0].originalDts, mp4Samples[0].isKeyframe);\r\n            info.lastSample = new _mediaSegmentInfo.SampleInfo(latest.dts, latest.pts, latest.duration, latest.originalDts, latest.isKeyframe);\r\n            if (!this._isLive) {\r\n                this._videoSegmentInfoList.append(info);\r\n            }\r\n\r\n            track.samples = mp4Samples;\r\n            track.sequenceNumber++;\r\n\r\n            // workaround for chrome < 50: force first sample as a random access point\r\n            // see https://bugs.chromium.org/p/chromium/issues/detail?id=229412\r\n            if (this._forceFirstIDR) {\r\n                var flags = mp4Samples[0].flags;\r\n                flags.dependsOn = 2;\r\n                flags.isNonSync = 0;\r\n            }\r\n\r\n            var moofbox = _mp4Generator2.default.moof(track, firstDts);\r\n            track.samples = [];\r\n            track.length = 0;\r\n\r\n            this._onMediaSegment('video', {\r\n                type: 'video',\r\n                data: this._mergeBoxes(moofbox, mdatbox).buffer,\r\n                sampleCount: mp4Samples.length,\r\n                info: info\r\n            });\r\n        }\r\n    }, {\r\n        key: '_mergeBoxes',\r\n        value: function _mergeBoxes(moof, mdat) {\r\n            var result = new Uint8Array(moof.byteLength + mdat.byteLength);\r\n            result.set(moof, 0);\r\n            result.set(mdat, moof.byteLength);\r\n            return result;\r\n        }\r\n    }, {\r\n        key: 'onInitSegment',\r\n        get: function get() {\r\n            return this._onInitSegment;\r\n        },\r\n        set: function set(callback) {\r\n            this._onInitSegment = callback;\r\n        }\r\n\r\n        /* prototype: function onMediaSegment(type: string, mediaSegment: MediaSegment): void\r\n           MediaSegment: {\r\n               type: string,\r\n               data: ArrayBuffer,\r\n               sampleCount: int32\r\n               info: MediaSegmentInfo\r\n           }\r\n        */\r\n\r\n    }, {\r\n        key: 'onMediaSegment',\r\n        get: function get() {\r\n            return this._onMediaSegment;\r\n        },\r\n        set: function set(callback) {\r\n            this._onMediaSegment = callback;\r\n        }\r\n    }]);\r\n\r\n    return MP4Remuxer;\r\n}();\r\n\r\nexports.default = MP4Remuxer;\r\n\r\n},{\"../core/media-segment-info.js\":8,\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./aac-silent.js\":36,\"./mp4-generator.js\":37}],39:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nvar Browser = {};\r\n\r\nfunction detect() {\r\n    // modified from jquery-browser-plugin\r\n\r\n    var ua = self.navigator.userAgent.toLowerCase();\r\n\r\n    var match = /(edge)\\/([\\w.]+)/.exec(ua) || /(opr)[\\/]([\\w.]+)/.exec(ua) || /(chrome)[ \\/]([\\w.]+)/.exec(ua) || /(iemobile)[\\/]([\\w.]+)/.exec(ua) || /(version)(applewebkit)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(ua) || /(webkit)[ \\/]([\\w.]+).*(version)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(ua) || /(webkit)[ \\/]([\\w.]+)/.exec(ua) || /(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec(ua) || /(msie) ([\\w.]+)/.exec(ua) || ua.indexOf('trident') >= 0 && /(rv)(?::| )([\\w.]+)/.exec(ua) || ua.indexOf('compatible') < 0 && /(firefox)[ \\/]([\\w.]+)/.exec(ua) || [];\r\n\r\n    var platform_match = /(ipad)/.exec(ua) || /(ipod)/.exec(ua) || /(windows phone)/.exec(ua) || /(iphone)/.exec(ua) || /(kindle)/.exec(ua) || /(android)/.exec(ua) || /(windows)/.exec(ua) || /(mac)/.exec(ua) || /(linux)/.exec(ua) || /(cros)/.exec(ua) || [];\r\n\r\n    var matched = {\r\n        browser: match[5] || match[3] || match[1] || '',\r\n        version: match[2] || match[4] || '0',\r\n        majorVersion: match[4] || match[2] || '0',\r\n        platform: platform_match[0] || ''\r\n    };\r\n\r\n    var browser = {};\r\n    if (matched.browser) {\r\n        browser[matched.browser] = true;\r\n\r\n        var versionArray = matched.majorVersion.split('.');\r\n        browser.version = {\r\n            major: parseInt(matched.majorVersion, 10),\r\n            string: matched.version\r\n        };\r\n        if (versionArray.length > 1) {\r\n            browser.version.minor = parseInt(versionArray[1], 10);\r\n        }\r\n        if (versionArray.length > 2) {\r\n            browser.version.build = parseInt(versionArray[2], 10);\r\n        }\r\n    }\r\n\r\n    if (matched.platform) {\r\n        browser[matched.platform] = true;\r\n    }\r\n\r\n    if (browser.chrome || browser.opr || browser.safari) {\r\n        browser.webkit = true;\r\n    }\r\n\r\n    // MSIE. IE11 has 'rv' identifer\r\n    if (browser.rv || browser.iemobile) {\r\n        if (browser.rv) {\r\n            delete browser.rv;\r\n        }\r\n        var msie = 'msie';\r\n        matched.browser = msie;\r\n        browser[msie] = true;\r\n    }\r\n\r\n    // Microsoft Edge\r\n    if (browser.edge) {\r\n        delete browser.edge;\r\n        var msedge = 'msedge';\r\n        matched.browser = msedge;\r\n        browser[msedge] = true;\r\n    }\r\n\r\n    // Opera 15+\r\n    if (browser.opr) {\r\n        var opera = 'opera';\r\n        matched.browser = opera;\r\n        browser[opera] = true;\r\n    }\r\n\r\n    // Stock android browsers are marked as Safari\r\n    if (browser.safari && browser.android) {\r\n        var android = 'android';\r\n        matched.browser = android;\r\n        browser[android] = true;\r\n    }\r\n\r\n    browser.name = matched.browser;\r\n    browser.platform = matched.platform;\r\n\r\n    for (var key in Browser) {\r\n        if (Browser.hasOwnProperty(key)) {\r\n            delete Browser[key];\r\n        }\r\n    }\r\n    Object.assign(Browser, browser);\r\n}\r\n\r\ndetect();\r\n\r\nexports.default = Browser;\r\n\r\n},{}],40:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\r\n\r\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nvar RuntimeException = exports.RuntimeException = function () {\r\n    function RuntimeException(message) {\r\n        _classCallCheck(this, RuntimeException);\r\n\r\n        this._message = message;\r\n    }\r\n\r\n    _createClass(RuntimeException, [{\r\n        key: 'toString',\r\n        value: function toString() {\r\n            return this.name + ': ' + this.message;\r\n        }\r\n    }, {\r\n        key: 'name',\r\n        get: function get() {\r\n            return 'RuntimeException';\r\n        }\r\n    }, {\r\n        key: 'message',\r\n        get: function get() {\r\n            return this._message;\r\n        }\r\n    }]);\r\n\r\n    return RuntimeException;\r\n}();\r\n\r\nvar IllegalStateException = exports.IllegalStateException = function (_RuntimeException) {\r\n    _inherits(IllegalStateException, _RuntimeException);\r\n\r\n    function IllegalStateException(message) {\r\n        _classCallCheck(this, IllegalStateException);\r\n\r\n        return _possibleConstructorReturn(this, (IllegalStateException.__proto__ || Object.getPrototypeOf(IllegalStateException)).call(this, message));\r\n    }\r\n\r\n    _createClass(IllegalStateException, [{\r\n        key: 'name',\r\n        get: function get() {\r\n            return 'IllegalStateException';\r\n        }\r\n    }]);\r\n\r\n    return IllegalStateException;\r\n}(RuntimeException);\r\n\r\nvar InvalidArgumentException = exports.InvalidArgumentException = function (_RuntimeException2) {\r\n    _inherits(InvalidArgumentException, _RuntimeException2);\r\n\r\n    function InvalidArgumentException(message) {\r\n        _classCallCheck(this, InvalidArgumentException);\r\n\r\n        return _possibleConstructorReturn(this, (InvalidArgumentException.__proto__ || Object.getPrototypeOf(InvalidArgumentException)).call(this, message));\r\n    }\r\n\r\n    _createClass(InvalidArgumentException, [{\r\n        key: 'name',\r\n        get: function get() {\r\n            return 'InvalidArgumentException';\r\n        }\r\n    }]);\r\n\r\n    return InvalidArgumentException;\r\n}(RuntimeException);\r\n\r\nvar NotImplementedException = exports.NotImplementedException = function (_RuntimeException3) {\r\n    _inherits(NotImplementedException, _RuntimeException3);\r\n\r\n    function NotImplementedException(message) {\r\n        _classCallCheck(this, NotImplementedException);\r\n\r\n        return _possibleConstructorReturn(this, (NotImplementedException.__proto__ || Object.getPrototypeOf(NotImplementedException)).call(this, message));\r\n    }\r\n\r\n    _createClass(NotImplementedException, [{\r\n        key: 'name',\r\n        get: function get() {\r\n            return 'NotImplementedException';\r\n        }\r\n    }]);\r\n\r\n    return NotImplementedException;\r\n}(RuntimeException);\r\n\r\n},{}],41:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _events = _dereq_('events');\r\n\r\nvar _events2 = _interopRequireDefault(_events);\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nvar Log = function () {\r\n    function Log() {\r\n        _classCallCheck(this, Log);\r\n    }\r\n\r\n    _createClass(Log, null, [{\r\n        key: 'e',\r\n        value: function e(tag, msg) {\r\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\r\n\r\n            var str = '[' + tag + '] > ' + msg;\r\n\r\n            if (Log.ENABLE_CALLBACK) {\r\n                Log.emitter.emit('log', 'error', str);\r\n            }\r\n\r\n            if (!Log.ENABLE_ERROR) {\r\n                return;\r\n            }\r\n\r\n            if (console.error) {\r\n                console.error(str);\r\n            } else if (console.warn) {\r\n                console.warn(str);\r\n            } else {\r\n                console.log(str);\r\n            }\r\n        }\r\n    }, {\r\n        key: 'i',\r\n        value: function i(tag, msg) {\r\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\r\n\r\n            var str = '[' + tag + '] > ' + msg;\r\n\r\n            if (Log.ENABLE_CALLBACK) {\r\n                Log.emitter.emit('log', 'info', str);\r\n            }\r\n\r\n            if (!Log.ENABLE_INFO) {\r\n                return;\r\n            }\r\n\r\n            if (console.info) {\r\n                console.info(str);\r\n            } else {\r\n                console.log(str);\r\n            }\r\n        }\r\n    }, {\r\n        key: 'w',\r\n        value: function w(tag, msg) {\r\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\r\n\r\n            var str = '[' + tag + '] > ' + msg;\r\n\r\n            if (Log.ENABLE_CALLBACK) {\r\n                Log.emitter.emit('log', 'warn', str);\r\n            }\r\n\r\n            if (!Log.ENABLE_WARN) {\r\n                return;\r\n            }\r\n\r\n            if (console.warn) {\r\n                console.warn(str);\r\n            } else {\r\n                console.log(str);\r\n            }\r\n        }\r\n    }, {\r\n        key: 'd',\r\n        value: function d(tag, msg) {\r\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\r\n\r\n            var str = '[' + tag + '] > ' + msg;\r\n\r\n            if (Log.ENABLE_CALLBACK) {\r\n                Log.emitter.emit('log', 'debug', str);\r\n            }\r\n\r\n            if (!Log.ENABLE_DEBUG) {\r\n                return;\r\n            }\r\n\r\n            if (console.debug) {\r\n                console.debug(str);\r\n            } else {\r\n                console.log(str);\r\n            }\r\n        }\r\n    }, {\r\n        key: 'v',\r\n        value: function v(tag, msg) {\r\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\r\n\r\n            var str = '[' + tag + '] > ' + msg;\r\n\r\n            if (Log.ENABLE_CALLBACK) {\r\n                Log.emitter.emit('log', 'verbose', str);\r\n            }\r\n\r\n            if (!Log.ENABLE_VERBOSE) {\r\n                return;\r\n            }\r\n\r\n            console.log(str);\r\n        }\r\n    }]);\r\n\r\n    return Log;\r\n}();\r\n\r\nLog.GLOBAL_TAG = 'flv.js';\r\nLog.FORCE_GLOBAL_TAG = false;\r\nLog.ENABLE_ERROR = true;\r\nLog.ENABLE_INFO = true;\r\nLog.ENABLE_WARN = true;\r\nLog.ENABLE_DEBUG = true;\r\nLog.ENABLE_VERBOSE = true;\r\n\r\nLog.ENABLE_CALLBACK = false;\r\n\r\nLog.emitter = new _events2.default();\r\n\r\nexports.default = Log;\r\n\r\n},{\"events\":2}],42:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\r\n\r\nvar _events = _dereq_('events');\r\n\r\nvar _events2 = _interopRequireDefault(_events);\r\n\r\nvar _logger = _dereq_('./logger.js');\r\n\r\nvar _logger2 = _interopRequireDefault(_logger);\r\n\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nvar LoggingControl = function () {\r\n    function LoggingControl() {\r\n        _classCallCheck(this, LoggingControl);\r\n    }\r\n\r\n    _createClass(LoggingControl, null, [{\r\n        key: 'getConfig',\r\n        value: function getConfig() {\r\n            return {\r\n                globalTag: _logger2.default.GLOBAL_TAG,\r\n                forceGlobalTag: _logger2.default.FORCE_GLOBAL_TAG,\r\n                enableVerbose: _logger2.default.ENABLE_VERBOSE,\r\n                enableDebug: _logger2.default.ENABLE_DEBUG,\r\n                enableInfo: _logger2.default.ENABLE_INFO,\r\n                enableWarn: _logger2.default.ENABLE_WARN,\r\n                enableError: _logger2.default.ENABLE_ERROR,\r\n                enableCallback: _logger2.default.ENABLE_CALLBACK\r\n            };\r\n        }\r\n    }, {\r\n        key: 'applyConfig',\r\n        value: function applyConfig(config) {\r\n            _logger2.default.GLOBAL_TAG = config.globalTag;\r\n            _logger2.default.FORCE_GLOBAL_TAG = config.forceGlobalTag;\r\n            _logger2.default.ENABLE_VERBOSE = config.enableVerbose;\r\n            _logger2.default.ENABLE_DEBUG = config.enableDebug;\r\n            _logger2.default.ENABLE_INFO = config.enableInfo;\r\n            _logger2.default.ENABLE_WARN = config.enableWarn;\r\n            _logger2.default.ENABLE_ERROR = config.enableError;\r\n            _logger2.default.ENABLE_CALLBACK = config.enableCallback;\r\n        }\r\n    }, {\r\n        key: '_notifyChange',\r\n        value: function _notifyChange() {\r\n            var emitter = LoggingControl.emitter;\r\n\r\n            if (emitter.listenerCount('change') > 0) {\r\n                var config = LoggingControl.getConfig();\r\n                emitter.emit('change', config);\r\n            }\r\n        }\r\n    }, {\r\n        key: 'registerListener',\r\n        value: function registerListener(listener) {\r\n            LoggingControl.emitter.addListener('change', listener);\r\n        }\r\n    }, {\r\n        key: 'removeListener',\r\n        value: function removeListener(listener) {\r\n            LoggingControl.emitter.removeListener('change', listener);\r\n        }\r\n    }, {\r\n        key: 'addLogListener',\r\n        value: function addLogListener(listener) {\r\n            _logger2.default.emitter.addListener('log', listener);\r\n            if (_logger2.default.emitter.listenerCount('log') > 0) {\r\n                _logger2.default.ENABLE_CALLBACK = true;\r\n                LoggingControl._notifyChange();\r\n            }\r\n        }\r\n    }, {\r\n        key: 'removeLogListener',\r\n        value: function removeLogListener(listener) {\r\n            _logger2.default.emitter.removeListener('log', listener);\r\n            if (_logger2.default.emitter.listenerCount('log') === 0) {\r\n                _logger2.default.ENABLE_CALLBACK = false;\r\n                LoggingControl._notifyChange();\r\n            }\r\n        }\r\n    }, {\r\n        key: 'forceGlobalTag',\r\n        get: function get() {\r\n            return _logger2.default.FORCE_GLOBAL_TAG;\r\n        },\r\n        set: function set(enable) {\r\n            _logger2.default.FORCE_GLOBAL_TAG = enable;\r\n            LoggingControl._notifyChange();\r\n        }\r\n    }, {\r\n        key: 'globalTag',\r\n        get: function get() {\r\n            return _logger2.default.GLOBAL_TAG;\r\n        },\r\n        set: function set(tag) {\r\n            _logger2.default.GLOBAL_TAG = tag;\r\n            LoggingControl._notifyChange();\r\n        }\r\n    }, {\r\n        key: 'enableAll',\r\n        get: function get() {\r\n            return _logger2.default.ENABLE_VERBOSE && _logger2.default.ENABLE_DEBUG && _logger2.default.ENABLE_INFO && _logger2.default.ENABLE_WARN && _logger2.default.ENABLE_ERROR;\r\n        },\r\n        set: function set(enable) {\r\n            _logger2.default.ENABLE_VERBOSE = enable;\r\n            _logger2.default.ENABLE_DEBUG = enable;\r\n            _logger2.default.ENABLE_INFO = enable;\r\n            _logger2.default.ENABLE_WARN = enable;\r\n            _logger2.default.ENABLE_ERROR = enable;\r\n            LoggingControl._notifyChange();\r\n        }\r\n    }, {\r\n        key: 'enableDebug',\r\n        get: function get() {\r\n            return _logger2.default.ENABLE_DEBUG;\r\n        },\r\n        set: function set(enable) {\r\n            _logger2.default.ENABLE_DEBUG = enable;\r\n            LoggingControl._notifyChange();\r\n        }\r\n    }, {\r\n        key: 'enableVerbose',\r\n        get: function get() {\r\n            return _logger2.default.ENABLE_VERBOSE;\r\n        },\r\n        set: function set(enable) {\r\n            _logger2.default.ENABLE_VERBOSE = enable;\r\n            LoggingControl._notifyChange();\r\n        }\r\n    }, {\r\n        key: 'enableInfo',\r\n        get: function get() {\r\n            return _logger2.default.ENABLE_INFO;\r\n        },\r\n        set: function set(enable) {\r\n            _logger2.default.ENABLE_INFO = enable;\r\n            LoggingControl._notifyChange();\r\n        }\r\n    }, {\r\n        key: 'enableWarn',\r\n        get: function get() {\r\n            return _logger2.default.ENABLE_WARN;\r\n        },\r\n        set: function set(enable) {\r\n            _logger2.default.ENABLE_WARN = enable;\r\n            LoggingControl._notifyChange();\r\n        }\r\n    }, {\r\n        key: 'enableError',\r\n        get: function get() {\r\n            return _logger2.default.ENABLE_ERROR;\r\n        },\r\n        set: function set(enable) {\r\n            _logger2.default.ENABLE_ERROR = enable;\r\n            LoggingControl._notifyChange();\r\n        }\r\n    }]);\r\n\r\n    return LoggingControl;\r\n}();\r\n\r\nLoggingControl.emitter = new _events2.default();\r\n\r\nexports.default = LoggingControl;\r\n\r\n},{\"./logger.js\":41,\"events\":2}],43:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nvar Polyfill = function () {\r\n    function Polyfill() {\r\n        _classCallCheck(this, Polyfill);\r\n    }\r\n\r\n    _createClass(Polyfill, null, [{\r\n        key: 'install',\r\n        value: function install() {\r\n            // ES6 Object.setPrototypeOf\r\n            Object.setPrototypeOf = Object.setPrototypeOf || function (obj, proto) {\r\n                obj.__proto__ = proto;\r\n                return obj;\r\n            };\r\n\r\n            // ES6 Object.assign\r\n            Object.assign = Object.assign || function (target) {\r\n                if (target === undefined || target === null) {\r\n                    throw new TypeError('Cannot convert undefined or null to object');\r\n                }\r\n\r\n                var output = Object(target);\r\n                for (var i = 1; i < arguments.length; i++) {\r\n                    var source = arguments[i];\r\n                    if (source !== undefined && source !== null) {\r\n                        for (var key in source) {\r\n                            if (source.hasOwnProperty(key)) {\r\n                                output[key] = source[key];\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return output;\r\n            };\r\n\r\n            // ES6 Promise (missing support in IE11)\r\n            if (typeof self.Promise !== 'function') {\r\n                _dereq_('es6-promise').polyfill();\r\n            }\r\n        }\r\n    }]);\r\n\r\n    return Polyfill;\r\n}();\r\n\r\nPolyfill.install();\r\n\r\nexports.default = Polyfill;\r\n\r\n},{\"es6-promise\":1}],44:[function(_dereq_,module,exports){\r\n'use strict';\r\n\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * This file is derived from C++ project libWinTF8 (https://github.com/m13253/libWinTF8)\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nfunction checkContinuation(uint8array, start, checkLength) {\r\n    var array = uint8array;\r\n    if (start + checkLength < array.length) {\r\n        while (checkLength--) {\r\n            if ((array[++start] & 0xC0) !== 0x80) return false;\r\n        }\r\n        return true;\r\n    } else {\r\n        return false;\r\n    }\r\n}\r\n\r\nfunction decodeUTF8(uint8array) {\r\n    var out = [];\r\n    var input = uint8array;\r\n    var i = 0;\r\n    var length = uint8array.length;\r\n\r\n    while (i < length) {\r\n        if (input[i] < 0x80) {\r\n            out.push(String.fromCharCode(input[i]));\r\n            ++i;\r\n            continue;\r\n        } else if (input[i] < 0xC0) {\r\n            // fallthrough\r\n        } else if (input[i] < 0xE0) {\r\n            if (checkContinuation(input, i, 1)) {\r\n                var ucs4 = (input[i] & 0x1F) << 6 | input[i + 1] & 0x3F;\r\n                if (ucs4 >= 0x80) {\r\n                    out.push(String.fromCharCode(ucs4 & 0xFFFF));\r\n                    i += 2;\r\n                    continue;\r\n                }\r\n            }\r\n        } else if (input[i] < 0xF0) {\r\n            if (checkContinuation(input, i, 2)) {\r\n                var _ucs = (input[i] & 0xF) << 12 | (input[i + 1] & 0x3F) << 6 | input[i + 2] & 0x3F;\r\n                if (_ucs >= 0x800 && (_ucs & 0xF800) !== 0xD800) {\r\n                    out.push(String.fromCharCode(_ucs & 0xFFFF));\r\n                    i += 3;\r\n                    continue;\r\n                }\r\n            }\r\n        } else if (input[i] < 0xF8) {\r\n            if (checkContinuation(input, i, 3)) {\r\n                var _ucs2 = (input[i] & 0x7) << 18 | (input[i + 1] & 0x3F) << 12 | (input[i + 2] & 0x3F) << 6 | input[i + 3] & 0x3F;\r\n                if (_ucs2 > 0x10000 && _ucs2 < 0x110000) {\r\n                    _ucs2 -= 0x10000;\r\n                    out.push(String.fromCharCode(_ucs2 >>> 10 | 0xD800));\r\n                    out.push(String.fromCharCode(_ucs2 & 0x3FF | 0xDC00));\r\n                    i += 4;\r\n                    continue;\r\n                }\r\n            }\r\n        }\r\n        out.push(String.fromCharCode(0xFFFD));\r\n        ++i;\r\n    }\r\n\r\n    return out.join('');\r\n}\r\n\r\nexports.default = decodeUTF8;\r\n\r\n},{}]},{},[21])(21)\r\n});\r\n\r\n//# sourceMappingURL=flv.js.map\r\n"]}