{"version":3,"sources":["../../../src/ipcs/dahua/dhnetsdk.js"],"names":["ffi","require","ref","struct","Enum","ArrayType","_","path","process","isX64","arch","iswin","platform","EventEmitter","util","legacy","config","global","server_config","dll","join","getLibDir","bool","types","char","uchar","int","ushort","long","ulong","longlong","float","string","CString","ENUM","BYTE","WORD","DWORD","LDWORD","LLONG","LONG","BOOL","voidPtr","refType","HWND","charPtr","BYTEPtr","intPtr","int64","enums","structs","callbacks","consts","utils","DH_SERIALNO_LEN","PTZ_PRESET_NAME_LEN","DH_DEVSTATE_IPC","DH_MAX_IPADDR_LEN","DH_USER_NAME_LENGTH_EX","DH_USER_PSW_LENGTH_EX","DH_MAX_IPADDR_OR_DOMAIN_LEN","DH_DEVSTATE_PTZ_LOCATION","DH_DEVSTATE_PTZ_PRESET_LIST","CFG_CMD_ENCODE","DEVSTATE_TALK_ECTYPE","DH_MACADDR_LEN","DH_DEV_TYPE_LEN","DH_DEV_SERIALNO_LEN","DH_MAX_URL_LEN","DH_MAX_STRING_LEN","DH_MACHINE_NAME_NUM","fDisConnect","fn","Callback","apply","concat","fRealDataCallBackEx","pfAudioDataCallBack","fRealPlayDisConnect","fHaveReConnect","fDecCallBack","fSearchDevicesCB","loginType","playType","PTZ","REALPLAY_DISCONNECT_EVENT","CTRL_TYPE","USEDEV_MODE","TALK_CODING_TYPE","Dev_State","IPC_TYPE","DH_SYS_ABILITY","DH_DEV_ENABLE","EM_DH_PTZ_PRESET_STATUS","EM_USEDEV_MODE","DH_TALK_CODING_TYPE","NET_EM_VIDEO_COMPRESSION","EM_H264_PROFILE_RANK","NET_EM_FORMAT_TYPE","NET_EM_BITRATE_CONTROL","NET_EM_IMAGE_QUALITY","Q10","Q30","Q50","Q60","Q80","Q100","EM_DECODE_FRAME_TYPE","UNKNOWN","VIDEO","AUDIO","NET_DEVICEINFO","NET_DEVICEINFO_Ex","ALARMCTRL_PARAM","NET_SPEAK_PARAM","NET_TALK_TRANSFER_PARAM","NET_PTZ_PRESET","NET_PTZ_PRESET_LIST","DH_DEV_IPC_INFO","DEV_ENCODER_INFO","CFG_VIDEO_FORMAT","CFG_AUDIO_ENCODE_FORMAT","CFG_VIDEOENC_OPT","DH_DEV_ENABLE_INFO","PTZ_SPACE_UNIT","PTZ_SPEED_UNIT","PTZ_CONTROL_ABSOLUTELY","DH_PTZ_LOCATION_INFO","TALKDECODE_INFO","NET_ENCODE_VIDEO_INFO","TALKFORMAT_LIST","nSupportNum","type","reserved","NET_TIME_EX","dwYear","dwMonth","dwDay","dwHour","dwMinute","dwSecond","dwMillisecond","dwReserved","SYSTEMTIME","wYear","wMonth","wDayOfWeek","wDay","wHour","wMinute","wSecond","wMilliseconds","NET_FRAME_INFO_EX","dwSize","emFrameType","nFrameSeq","nStamp","nWidth","nHeight","nFrameRate","nChannels","nBitPerSample","nSamplesPerSec","nRemainData","nDataTime","FRAME_INFO_EX","nReserved","NET_FRAME_DECODE_INFO","pAudioData","nAudioDataLen","pVideoData","nStride","AUDIO_FORMAT","byFormatTag","wBitsPerSample","DEVICE_NET_INFO_EX","iIPVersion","szIP","nPort","szSubmask","szGateway","szMac","szDeviceType","byManuFactory","byDefinition","bDhcpEn","byReserved1","verifyData","szSerialNo","szDevSoftVersion","szDetailType","szVendor","szDevName","szUserName","szPassWord","nHttpPort","wVideoInputCh","wRemoteVideoInputCh","wVideoOutputCh","wAlarmInputCh","wAlarmOutputCh","cReserved","fns","readBuffer","bytePtr","size","readPointer","mbcs2Utf8","buf","untilZeros","buffer","decode","utf82Mbcs","encode","structParser","_struct","data","ret","each","toObject","val","key","fields","name","readCString","exports","module","DHLib","assign","Library","asyncFunctions","functions","fun","argus","Promise","resolve","reject","async","err","inherits"],"mappings":";;;;;;;;;;AAAA,IAAMA,MAAIC,QAAQ,KAAR,CAAV;AACA,IAAMC,MAAMD,QAAQ,KAAR,CAAZ;AACA,IAAME,SAASF,QAAQ,YAAR,CAAf;AACA,IAAMG,OAAKH,QAAQ,MAAR,CAAX;AACA,IAAMI,YAAUJ,QAAQ,WAAR,CAAhB;AACA,IAAMK,IAAEL,QAAQ,QAAR,CAAR;AACA,IAAMM,OAAKN,QAAQ,MAAR,CAAX;AACA,IAAMO,UAAQP,QAAQ,SAAR,CAAd;AACA,IAAMQ,QAAMD,QAAQE,IAAR,KAAe,KAA3B;AACA,IAAMC,QAAMH,QAAQI,QAAR,KAAmB,OAA/B;AACA;AACA,IAAMC,eAAeZ,QAAQ,QAAR,CAArB;AACA,IAAMa,OAAOb,QAAQ,MAAR,CAAb;AACA,IAAMc,SAASd,QAAQ,iBAAR,CAAf;AACA,IAAMe,SAAOC,OAAOC,aAAP,IAAsBjB,QAAQ,qBAAR,CAAnC;AACA;AACA;AACA,IAAIkB,MAAIZ,KAAKa,IAAL,CAAUJ,OAAOK,SAAP,EAAV,EAA8BV,QAAMF,QAAM,uBAAN,GAA8B,uBAApC,GAA4D,+BAA1F,CAAR;AACA,IAAIa,OAAKpB,IAAIqB,KAAJ,CAAUD,IAAnB;AACA,IAAIE,OAAKtB,IAAIqB,KAAJ,CAAUC,IAAnB;AACA,IAAIC,QAAMvB,IAAIqB,KAAJ,CAAUE,KAApB;AACA,IAAIC,MAAIxB,IAAIqB,KAAJ,CAAUG,GAAlB;AACA,IAAIC,SAAOzB,IAAIqB,KAAJ,CAAUI,MAArB;AACA,IAAIC,OAAK1B,IAAIqB,KAAJ,CAAUK,IAAnB;AACA,IAAIC,QAAM3B,IAAIqB,KAAJ,CAAUM,KAApB;AACA,IAAIC,WAAS5B,IAAIqB,KAAJ,CAAUO,QAAvB;AACA,IAAIC,QAAM7B,IAAIqB,KAAJ,CAAUQ,KAApB;AACA,IAAIC,SAAO9B,IAAIqB,KAAJ,CAAUU,OAArB;AACA,IAAIC,OAAKR,GAAT;;AAEA,IAAIS,OAAKV,KAAT;AACA,IAAIW,OAAKT,MAAT;AACA,IAAIU,QAAMR,KAAV;AACA,IAAIS,SAAOT,KAAX;AACA,IAAIU,QAAMX,IAAV;AACA,IAAIY,OAAKZ,IAAT;AACA,IAAIa,OAAKf,GAAT;;AAEA,IAAIgB,UAAQxC,IAAIyC,OAAJ,CAAY,MAAZ,CAAZ;AACA,IAAIC,OAAKF,OAAT;AACA,IAAIG,UAAQ3C,IAAIyC,OAAJ,CAAY,MAAZ,CAAZ;AACA,IAAIG,UAAQ5C,IAAIyC,OAAJ,CAAY,OAAZ,CAAZ;AACA,IAAII,SAAO7C,IAAIyC,OAAJ,CAAY,KAAZ,CAAX;;AAEA,IAAGlC,KAAH,EAAS;AACL8B,YAAMrC,IAAIqB,KAAJ,CAAUyB,KAAhB;AACAV,aAAOpC,IAAIqB,KAAJ,CAAUyB,KAAjB;AACH;AACD,IAAIC,QAAM,EAAV;AACA,IAAIC,UAAQ,EAAZ;AACA,IAAIC,YAAU,EAAd;AACA,IAAIC,SAAO,EAAX;AACA,IAAIC,QAAM,EAAV;;AAEAD,OAAOE,eAAP,GAAuB,EAAvB;AACAF,OAAOG,mBAAP,GAA2B,EAA3B;AACAH,OAAOI,eAAP,GAAuB,MAAvB;AACAJ,OAAOK,iBAAP,GAAyB,EAAzB;AACAL,OAAOM,sBAAP,GAA8B,EAA9B;AACAN,OAAOO,qBAAP,GAA6B,EAA7B;AACAP,OAAOQ,2BAAP,GAAmC,EAAnC;AACAR,OAAOS,wBAAP,GAAgC,IAAhC;AACAT,OAAOU,2BAAP,GAAmC,IAAnC;AACAV,OAAOW,cAAP,GAAsB,QAAtB;AACAX,OAAOY,oBAAP,GAA4B,CAA5B;AACAZ,OAAOa,cAAP,GAAsB,EAAtB;AACAb,OAAOc,eAAP,GAAuB,EAAvB;AACAd,OAAOe,mBAAP,GAA2B,EAA3B;AACAf,OAAOgB,cAAP,GAAsB,GAAtB;AACAhB,OAAOc,eAAP,GAAuB,EAAvB;AACAd,OAAOiB,iBAAP,GAAyB,GAAzB;AACAjB,OAAOkB,mBAAP,GAA2B,EAA3B;AACAlB,OAAOM,sBAAP,GAA8B,EAA9B;;AAEAP,UAAUoB,WAAV,GAAsB,UAACC,EAAD,EAAM;AACxB,WAAOxE,IAAIyE,QAAJ,CAAaC,KAAb,CAAmB1E,GAAnB,EAAuB,CAAC,MAAD,EAAQ,CAAC8B,QAAD,EAAUE,MAAV,EAAiBJ,IAAjB,EAAsBU,MAAtB,CAAR,EAAuCqC,MAAvC,CAA8CH,EAA9C,CAAvB,CAAP;AACH,CAFD;AAGArB,UAAUyB,mBAAV,GAA8B,UAACJ,EAAD,EAAM;AAChC,WAAOxE,IAAIyE,QAAJ,CAAaC,KAAb,CAAmB1E,GAAnB,EAAuB,CAAC,MAAD,EAAQ,CAACuC,KAAD,EAAOF,KAAP,EAAaS,OAAb,EAAqBT,KAArB,EAA2BG,IAA3B,EAAgCF,MAAhC,CAAR,EAAiDqC,MAAjD,CAAwDH,EAAxD,CAAvB,CAAP;AACH,CAFD;AAGArB,UAAU0B,mBAAV,GAA8B,UAACL,EAAD,EAAO;AACjC,WAAOxE,IAAIyE,QAAJ,CAAaC,KAAb,CAAmB1E,GAAnB,EAAuB,CAAC,MAAD,EAAQ,CAACuC,KAAD,EAAOO,OAAP,EAAeT,KAAf,EAAqBF,IAArB,EAA0BG,MAA1B,CAAR,EAA2CqC,MAA3C,CAAkDH,EAAlD,CAAvB,CAAP;AACH,CAFD;AAGArB,UAAU2B,mBAAV,GAA8B,UAACN,EAAD,EAAO;AACjC,WAAOxE,IAAIyE,QAAJ,CAAaC,KAAb,CAAmB1E,GAAnB,EAAuB,CAAC,MAAD,EAAQ,CAACuC,KAAD,EAAOL,IAAP,EAAYQ,OAAZ,EAAoBJ,MAApB,CAAR,EAAqCqC,MAArC,CAA4CH,EAA5C,CAAvB,CAAP;AACH,CAFD;;AAIArB,UAAU4B,cAAV,GAAyB,UAACP,EAAD,EAAO;AAC5B,WAAOxE,IAAIyE,QAAJ,CAAaC,KAAb,CAAmB1E,GAAnB,EAAuB,CAAC,MAAD,EAAQ,CAACuC,KAAD,EAAOP,MAAP,EAAcQ,IAAd,EAAmBF,MAAnB,CAAR,EAAoCqC,MAApC,CAA2CH,EAA3C,CAAvB,CAAP;AACH,CAFD;;AAIArB,UAAU6B,YAAV,GAAuB,UAACR,EAAD,EAAM;AACzB,WAAOxE,IAAIyE,QAAJ,CAAaC,KAAb,CAAmB1E,GAAnB,EAAuB,CAAC,MAAD,EAAQ,CAACuC,KAAD,EAAOP,MAAP,EAAcQ,IAAd,EAAmBF,MAAnB,CAAR,EAAoCqC,MAApC,CAA2CH,EAA3C,CAAvB,CAAP;AACH,CAFD;;AAIArB,UAAU8B,gBAAV,GAA4B,UAACT,EAAD,EAAO;AAC/B,WAAOxE,IAAIyE,QAAJ,CAAaC,KAAb,CAAmB1E,GAAnB,EAAuB,CAAC,MAAD,EAAQ,CAAC,SAAD,EAAW0C,OAAX,CAAR,EAA6BiC,MAA7B,CAAoCH,EAApC,CAAvB,CAAP;AACH,CAFD;;AAIAvB,MAAMiC,SAAN,GAAiB,IAAI9E,IAAJ,CAAS,EAAC,OAAM,CAAP,EAAT,EAAoB,EAAE,SAAS,IAAX,EAApB,CAAjB;AACA6C,MAAMkC,QAAN,GAAe,IAAI/E,IAAJ,CAAS;AACpB,gBAAW,CADS,EACP,aAAY,CADL,EACO,cAAa,CADpB,EACsB,cAAa,CADnC;AAEpB,kBAAa,CAFO,EAEL,cAAa,CAFR,EAAT,EAEoB,EAAE,SAAS,IAAX,EAFpB,CAAf;AAGA6C,MAAMmC,GAAN,GAAU,IAAIhF,IAAJ,CAAS;AACf,cAAS,CADM,EACJ,YAAW,CADP,EACS,YAAW,CADpB,EACsB,aAAY,CADlC,EACoC,gBAAe,CADnD;AAEf,oBAAe,CAFA,EAEE,iBAAgB,CAFlB,EAEoB,iBAAgB,CAFpC,EAEsC,oBAAmB,CAFzD;AAGf,wBAAmB,CAHJ,EAGM,kBAAiB,EAHvB,EAG0B,iBAAgB,EAH1C,EAG6C,iBAAgB,EAH7D;AAIf,sBAAiB,EAJF,EAIK,YAAW,EAJhB;AAKf,sBAAiB,IALF,EAKO,mBAAkB,IALzB,EAK8B,mBAAkB,IALhD,EAKqD,oBAAmB,IALxE;AAMf,8BAAyB;AANV,CAAT,EAOR,EAAE,SAAS,IAAX,EAPQ,CAAV;AAQA6C,MAAMoC,yBAAN,GAAgC,IAAIjF,IAAJ,CAAS,EAAC,SAAQ,CAAT,EAAW,aAAY,CAAvB,EAAyB,cAAa,CAAtC,EAAT,EAAkD,EAAE,SAAS,IAAX,EAAlD,CAAhC;AACA6C,MAAMqC,SAAN,GAAgB,IAAIlF,IAAJ,CAAS;AACrB,wBAAmB,GADE,EACE,qBAAoB,GADtB,EAAT,EACoC,EAAE,SAAS,IAAX,EADpC,CAAhB;AAEA6C,MAAMsC,WAAN,GAAkB,IAAInF,IAAJ,CAAS,EAAC,oBAAmB,CAApB,EAAsB,oBAAmB,CAAzC,EAA2C,oBAAmB,CAA9D;AACvB,oBAAe,CADQ,EACN,oBAAmB,CADb,EACe,cAAa,CAD5B,EAC8B,sBAAqB;AADnD,CAAT,EAEhB,EAAE,SAAS,IAAX,EAFgB,CAAlB;AAGA6C,MAAMuC,gBAAN,GAAuB,IAAIpF,IAAJ,CAAS,EAAC,WAAU,CAAX,EAAa,OAAM,CAAnB,EAAqB,SAAQ,CAA7B,EAA+B,OAAM,CAArC,EAAuC,SAAQ,CAA/C,EAAiD,QAAO,CAAxD,EAA0D,WAAU,CAApE;AAC3B,eAAU,CADiB,EACf,OAAM,CADS,EACP,OAAM,CADC,EACC,QAAO,EADR,EACW,SAAQ,EADnB,EACsB,gBAAe,EADrC,EACwC,UAAS,EADjD,EACoD,SAAQ,EAD5D,EAC+D,OAAM;AADrE,CAAT,EAErB,EAAE,SAAS,IAAX,EAFqB,CAAvB;AAGA6C,MAAMwC,SAAN,GAAgB,IAAIrF,IAAJ,CAAS,EAAC,eAAc,CAAf,EAAiB,iBAAgB,IAAjC,EAAsC,mBAAkB,IAAxD,EAAT,EAAuE,EAAE,SAAS,IAAX,EAAvE,CAAhB;AACA6C,MAAMyC,QAAN,GAAe,IAAItF,IAAJ,CAAS;AACpB,UAAK,CADe,EACb,QAAO,CADM,EACJ,MAAK,CADD,EACG,MAAK,CADR,EACU,aAAY,CADtB,EACwB,QAAO,CAD/B,EACiC,MAAK,CADtC,EACwC,QAAO,CAD/C,EACiD,WAAU,CAD3D,EAC6D,MAAK,CADlE;AAEpB,aAAQ,EAFY,EAET,SAAQ,EAFC,EAEE,YAAW,EAFb,EAEgB,QAAO,EAFvB,EAE0B,WAAU,EAFpC,EAEuC,WAAU,EAFjD,EAEoD,aAAY,EAFhE,EAEmE,UAAS,EAF5E,EAE+E,SAAQ,EAFvF;AAGpB,YAAO,EAHa,EAGV,OAAM,EAHI,EAGD,WAAU,EAHT,EAGY,WAAU,EAHtB,EAGyB,MAAK,EAH9B,EAGiC,MAAK,EAHtC,EAGyC,UAAS,EAHlD,EAGqD,QAAO,EAH5D,EAG+D,MAAK,EAHpE,EAGuE,MAAK,EAH5E;AAIpB,UAAK,EAJe,EAIZ,OAAM,EAJM,EAIH,MAAK,EAJF,EAIK,YAAW,EAJhB,EAImB,WAAU,EAJ7B,EAIgC,OAAM,EAJtC,EAIyC,SAAQ,EAJjD,EAIoD,MAAK,EAJzD,EAI4D,OAAM,EAJlE,EAIqE,OAAM,EAJ3E;AAKrB,gBAAW,EALU,EAKP,YAAW,EALJ,EAKO,YAAW,EALlB,EAKqB,cAAa,EALlC,EAKqC,aAAY,EALjD,EAKoD,QAAO,EAL3D,EAK8D,QAAO,EALrE,EAKwE,UAAS,EALjF,EAKoF,QAAO,EAL3F;AAMpB,aAAQ,EANY,EAMT,cAAa,EANJ,EAMO,cAAa,EANpB,EAMuB,WAAU,EANjC,EAMoC,OAAM,EAN1C,EAM6C,UAAS,EANtD,EAMyD,QAAO,EANhE,EAMmE,eAAc,EANjF;AAOpB,YAAO,EAPa,EAOV,MAAK,EAPK,EAOF,QAAO,EAPL,EAOQ,OAAM,EAPd,EAOiB,OAAM,EAPvB,EAO0B,OAAM,EAPhC,EAOmC,QAAO,EAP1C,EAO6C,aAAY,EAPzD,EAO4D,MAAK,EAPjE,EAOoE,QAAO,EAP3E;AAQpB,UAAK,EARe,EAQZ,OAAM;AARM,CAAT,EASb,EAAE,SAAS,IAAX,EATa,CAAf;AAUA6C,MAAM0C,cAAN,GAAqB,IAAIvF,IAAJ,CAAS,EAAC,eAAc,EAAf,EAAT,EAA4B,EAAE,SAAS,IAAX,EAA5B,CAArB;AACA6C,MAAM2C,aAAN,GAAoB,IAAIxF,IAAJ,CAAS,EAAC,eAAc,EAAf,EAAkB,iBAAgB,EAAlC,EAAT,EAA+C,EAAE,SAAS,IAAX,EAA/C,CAApB;AACA6C,MAAM4C,uBAAN,GAA8B,IAAIzF,IAAJ,CAAS,EAAC,WAAU,CAAX,EAAa,SAAQ,CAArB,EAAuB,WAAU,CAAjC,EAAT,EAA6C,EAAE,SAAS,IAAX,EAA7C,CAA9B;AACA6C,MAAM6C,cAAN,GAAqB,IAAI1F,IAAJ,CAAS,EAAC,oBAAmB,CAApB,EAAsB,oBAAmB,CAAzC,EAA2C,oBAAmB,CAA9D,EAAgE,qBAAoB,CAApF;AAC1B,6BAAwB,CADE,EACA,qBAAoB,CADpB,EACsB,sBAAqB,CAD3C,EAC6C,oBAAmB,CADhE,EACkE,eAAc,CADhF;AAE1B,kBAAa,CAFa,EAEX,0BAAyB,EAFd,EAEiB,sBAAqB,EAFtC,EAEyC,iBAAgB,EAFzD,EAE4D,iBAAgB;AAF5E,CAAT,EAGnB,EAAE,SAAS,IAAX,EAHmB,CAArB;AAIA6C,MAAM8C,mBAAN,GAA0B,IAAI3F,IAAJ,CAAS,EAAC,OAAM,CAAP,EAAT,EAAmB,EAAE,SAAS,IAAX,EAAnB,CAA1B;AACA6C,MAAM+C,wBAAN,GAA+B,IAAI5F,IAAJ,CAAS,EAAC,QAAO,CAAR,EAAT,EAAoB,EAAE,SAAS,IAAX,EAApB,CAA/B;AACA6C,MAAMgD,oBAAN,GAA2B,IAAI7F,IAAJ,CAAS,EAAC,YAAW,CAAZ,EAAc,QAAO,CAArB,EAAuB,YAAW,CAAlC,EAAoC,QAAO,CAA3C,EAAT,EAAuD,EAAE,SAAS,IAAX,EAAvD,CAA3B;AACA6C,MAAMiD,kBAAN,GAAyB,IAAI9F,IAAJ,CAAS,EAAC,UAAS,CAAV,EAAY,UAAS,CAArB,EAAuB,UAAS,CAAhC,EAAT,EAA4C,EAAC,SAAS,IAAV,EAA5C,CAAzB;AACA6C,MAAMkD,sBAAN,GAA6B,IAAI/F,IAAJ,CAAS,EAAC,OAAM,CAAP,EAAS,OAAM,CAAf,EAAT,EAA2B,EAAC,SAAS,IAAV,EAA3B,CAA7B;AACA6C,MAAMmD,oBAAN,GAA2B,IAAIhG,IAAJ,CAAS,EAACiG,KAAI,CAAL,EAAOC,KAAI,CAAX,EAAaC,KAAI,CAAjB,EAAmBC,KAAI,CAAvB,EAAyBC,KAAI,CAA7B,EAA+BC,MAAK,CAApC,EAAT,EAAgD,EAAC,SAAS,IAAV,EAAhD,CAA3B;AACAzD,MAAM0D,oBAAN,GAA2B,IAAIvG,IAAJ,CAAS,EAACwG,SAAQ,CAAC,CAAV,EAAYC,OAAM,CAAlB,EAAoBC,OAAM,CAA1B,EAAT,EAAsC,EAAC,SAAS,IAAV,EAAtC,CAA3B;;AAEA5D,QAAQ6D,cAAR,GAAuB5G,OAAO;AAC1B,qBAAgBE,UAAU8B,IAAV,EAAeiB,OAAOE,eAAtB,CADU;AAE1B,uBAAkBnB,IAFQ;AAG1B,wBAAmBA,IAHO;AAI1B,iBAAYA,IAJc;AAK1B,iBAAYA,IALc;AAM1B,iBAAYA;AANc,CAAP,CAAvB;AAQAe,QAAQ8D,iBAAR,GAA0B7G,OAAO;AAC7B,qBAAgBE,UAAU8B,IAAV,EAAeiB,OAAOE,eAAtB,CADa;AAE7B,uBAAkB5B,GAFW;AAG7B,wBAAmBA,GAHU;AAI7B,gBAAWA,GAJkB;AAK7B,gBAAWA,GALkB;AAM7B,gBAAWA,GANkB;AAO7B,wBAAmBS,IAPU;AAQ7B,sBAAiBA,IARY;AAS7B,iBAAY9B,UAAU8B,IAAV,EAAe,CAAf,CATiB;AAU7B,qBAAgBT,GAVa;AAW7B,gBAAWrB,UAAUmB,IAAV,EAAe,EAAf;AAXkB,CAAP,CAA1B;AAaA0B,QAAQ+D,eAAR,GAAwB9G,OAAO;AAC3B,cAASkC,KADkB;AAE3B,gBAAWX,GAFgB;AAG3B,eAAUA;AAHiB,CAAP,CAAxB;AAKAwB,QAAQgE,eAAR,GAAwB/G,OAAO,EAAC,UAASkC,KAAV,EAAgB,SAAQX,GAAxB,EAA4B,mBAAkBA,GAA9C,EAAP,CAAxB;AACAwB,QAAQiE,uBAAR,GAAgChH,OAAO,EAAC,UAASkC,KAAV,EAAgB,aAAYI,IAA5B,EAAP,CAAhC;AACAS,QAAQkE,cAAR,GAAuBjH,OAAO,EAAC,UAASuB,GAAV,EAAc,UAASrB,UAAUmB,IAAV,EAAe4B,OAAOG,mBAAtB,CAAvB,EAAkE,aAAYlD,UAAUmB,IAAV,EAAe,EAAf,CAA9E,EAAP,CAAvB;AACA0B,QAAQmE,mBAAR,GAA4BlH,OAAO,EAAC,UAASkC,KAAV,EAAgB,kBAAiBA,KAAjC,EAAuC,kBAAiBA,KAAxD,EAA8D,qBAAoB,SAAlF,EAAP,CAA5B;AACAa,QAAQoE,eAAR,GAAwBnH,OAAO,EAAC,cAAauB,GAAd,EAAkB,iBAAgBrB,UAAU8B,IAAV,EAAe,GAAf,CAAlC,EAAP,CAAxB;AACAe,QAAQqE,gBAAR,GAAyBpH,OAAO;AAC5B,eAAUE,UAAUmB,IAAV,EAAe4B,OAAOK,iBAAtB,CADkB;AAE5B,gBAAWrB,IAFiB;AAG5B,qBAAgBD,IAHY;AAI5B,mBAAcA,IAJc;AAK5B,iBAAY9B,UAAUmB,IAAV,EAAe4B,OAAOM,sBAAtB,CALgB;AAM5B,gBAAWrD,UAAUmB,IAAV,EAAe4B,OAAOO,qBAAtB,CANiB;AAO5B,mBAAcjC,GAPc;AAQ5B,mBAAcA,GARc;AAS5B,kBAAaS,IATe;AAU5B,kBAAaA,IAVe;AAW5B,mBAAcC,IAXc;AAY5B,mBAAcC,KAZc;AAa5B,iBAAYhC,UAAUmB,IAAV,EAAe,EAAf,CAbgB;AAc5B,qBAAgBW,IAdY;AAe5B,iBAAY9B,UAAUmB,IAAV,EAAe4B,OAAOQ,2BAAtB,CAfgB;AAgB5B,kBAAazB,IAhBe;AAiB5B,qBAAgBA,IAjBY;AAkB5B,oBAAeA,IAlBa;AAmB5B,sBAAiBA,IAnBW;AAoB5B,iBAAY9B,UAAU8B,IAAV,EAAe,CAAf,CApBgB;AAqB5B,kBAAaE,KArBe;AAsB5B,kBAAaA,KAtBe;AAuB5B,iBAAYhC,UAAUmB,IAAV,EAAe,EAAf,CAvBgB;AAwB5B,mBAAca;AAxBc,CAAP,CAAzB;AA0BAa,QAAQsE,gBAAR,GAAyBrH,OAAO;AAC5B,qBAAgBmB,IADY;AAE5B,eAAUA,IAFkB;AAG5B,gBAAWA,IAHiB;AAI5B,wBAAmBA,IAJS;AAK5B,iBAAYA,IALgB;AAM5B,mBAAcA,IANc;AAO5B,sBAAiBA,IAPW;AAQ5B,mBAAcA,IARc;AAS5B,qBAAgBY,IATY;AAU5B,cAASR,GAVmB;AAW5B,eAAUA,GAXkB;AAY5B,wBAAmBQ,IAZS;AAa5B,gBAAWR,GAbiB;AAc5B,kBAAaA,GAde;AAe5B,uBAAkBA,GAfU;AAgB5B,sBAAiBA,GAhBW;AAiB5B,kBAAaA;AAjBe,CAAP,CAAzB;AAmBAwB,QAAQuE,uBAAR,GAAgCtH,OAAO;AACnC,qBAAgBmB,IADmB;AAEnC,eAAUA,IAFyB;AAGnC,mBAAcA,IAHqB;AAInC,cAASA,IAJ0B;AAKnC,mBAAcA,IALqB;AAMnC,sBAAiBA,IANkB;AAOnC,qBAAgBY,IAPmB;AAQnC,cAASR,GAR0B;AASnC,kBAAaA,GATsB;AAUnC,aAAQA,GAV2B;AAWnC,kBAAaA,GAXsB;AAYnC,qBAAgBA;AAZmB,CAAP,CAAhC;AAcAwB,QAAQwE,gBAAR,GAAyBvH,OAAO;AAC5B,qBAAgBmB,IADY;AAE5B,qBAAgBA,IAFY;AAG5B,oBAAeA,IAHa;AAI5B,kBAAaA,IAJe;AAK5B,qBAAgBA,IALY;AAM5B,oBAAemB,IANa;AAO5B,sBAAiBS,QAAQsE,gBAPG;AAQ5B,oBAAe/E,IARa;AAS5B,mBAAcA,IATc;AAU5B,sBAAiBS,QAAQuE;AAVG,CAAP,CAAzB;AAYAvE,QAAQyE,kBAAR,GAA2BxH,OAAO,EAAE,eAAcE,UAAUgC,KAAV,EAAgB,GAAhB,CAAhB,EAAP,CAA3B;AACAa,QAAQ0E,cAAR,GAAuBzH,OAAO;AAC1B,kBAAauB,GADa;AAE1B,kBAAaA,GAFa;AAG1B,aAAQA,GAHkB;AAI1B,iBAAYrB,UAAUmB,IAAV,EAAe,EAAf;AAJc,CAAP,CAAvB;AAMA0B,QAAQ2E,cAAR,GAAuB1H,OAAO;AAC1B,kBAAa4B,KADa;AAE1B,kBAAaA,KAFa;AAG1B,aAAQL,GAHkB;AAI1B,iBAAYrB,UAAUmB,IAAV,EAAe,EAAf;AAJc,CAAP,CAAvB;AAMA0B,QAAQ4E,sBAAR,GAA+B3H,OAAO;AAClC,mBAAc+C,QAAQ0E,cADY;AAElC,gBAAW1E,QAAQ2E,cAFe;AAGlC,iBAAYxH,UAAUmB,IAAV,EAAe,EAAf;AAHsB,CAAP,CAA/B;AAKA0B,QAAQ6E,oBAAR,GAA6B5H,OAAO;AAChC,kBAAauB,GADmB;AAEhC,eAAUA,GAFsB;AAGhC,gBAAWA,GAHqB;AAIhC,gBAAWA,GAJqB;AAKhC,cAASS,IALuB;AAMhC,eAAUA,IANsB;AAOhC,mBAAcA,IAPkB;AAQhC,+BAA0BA,IARM;AAShC,oBAAeT,GATiB;AAUhC,kBAAaW,KAVmB;AAWhC,sBAAiBN,KAXe;AAYhC,kBAAaI,IAZmB;AAahC,iBAAY9B,UAAU8B,IAAV,EAAe,CAAf,CAboB;AAchC,kBAAaE,KAdmB;AAehC,aAAQA,KAfwB;AAgBhC,sBAAiBH,IAhBe;AAiBhC,kBAAaR,GAjBmB;AAkBhC,gBAAWrB,UAAUqB,GAAV,EAAc,GAAd;AAlBqB,CAAP,CAA7B;AAoBAwB,QAAQgE,eAAR,GAAwB/G,OAAO;AAC3B,cAASkC,KADkB;AAE3B,aAAQX,GAFmB,EAEf;AACZ,uBAAkBA,GAHS,EAGL;AACtB,mBAAce,IAJa,CAIT;AAJS,CAAP,CAAxB;AAMAS,QAAQiE,uBAAR,GAAgChH,OAAO;AACnC,cAASkC,KAD0B;AAEnC,iBAAYI,IAFuB,CAEnB;AAFmB,CAAP,CAAhC;AAIAS,QAAQ8E,eAAR,GAAwB7H,OAAO;AAC3B,kBAAa+B,IADc;AAE3B,iBAAYR,GAFe;AAG3B,oBAAeW,KAHY;AAI3B,qBAAgBX,GAJW,EAIP;AACpB,gBAAWrB,UAAUmB,IAAV,EAAe,EAAf;AALgB,CAAP,CAAxB;AAOA0B,QAAQ+E,qBAAR,GAA8B9H,OAAO;AACjC,cAASkC,KADwB;AAEjC,oBAAeH,IAFkB;AAGjC,oBAAeO,IAHkB;AAIjC,qBAAgBP,IAJiB;AAKjC,cAASR,GALwB;AAMjC,eAAUA,GANuB;AAOjC,wBAAmBQ,IAPc;AAQjC,gBAAWR,GARsB;AASjC,kBAAaK,KAToB;AAUjC,uBAAkBL,GAVe;AAWjC,sBAAiBQ;AAXgB,CAAP,CAA9B;AAaAgB,QAAQgF,eAAR,GAAwB/H,OAAO;AAC3BgI,iBAAYzG,GADe;AAE3B0G,UAAK/H,UAAU6C,QAAQ8E,eAAlB,EAAkC,EAAlC,CAFsB;AAG3BK,cAAShI,UAAUmB,IAAV,EAAe,EAAf;AAHkB,CAAP,CAAxB;;AAMA0B,QAAQoF,WAAR,GAAoBnI,OAAO;AACvBoI,YAAOlG,KADgB,EACV;AACbmG,aAAQnG,KAFe,EAET;AACdoG,WAAMpG,KAHiB,EAGX;AACZqG,YAAOrG,KAJgB,EAIV;AACbsG,cAAStG,KALc,EAKR;AACfuG,cAASvG,KANc,EAMR;AACfwG,mBAAcxG,KAPS,EAOH;AACpByG,gBAAWzI,UAAUgC,KAAV,EAAgB,CAAhB,CARY,CAQM;AARN,CAAP,CAApB;;AAWAa,QAAQ6F,UAAR,GAAmB5I,OAAO;AACtB6I,WAAM5G,IADgB;AAEtB6G,YAAO7G,IAFe;AAGtB8G,gBAAW9G,IAHW;AAItB+G,UAAK/G,IAJiB;AAKtBgH,WAAMhH,IALgB;AAMtBiH,aAAQjH,IANc;AAOtBkH,aAAQlH,IAPc;AAQtBmH,mBAAcnH;AARQ,CAAP,CAAnB;;AAWAc,QAAQsG,iBAAR,GAA0BrJ,OAAO;AAC7BsJ,YAAOpH,KADsB;AAE7BqH,iBAAYxH,IAFiB,EAEZ;AACjByH,eAAUjI,GAHmB,EAGf;AACdkI,YAAOlI,GAJsB,EAIlB;AACXmI,YAAOnI,GALsB,EAKlB;AACXoI,aAAQpI,GANqB,EAMjB;AACZqI,gBAAWrI,GAPkB,EAOd;AACfsI,eAAUtI,GARmB,EAQf;AACduI,mBAAcvI,GATe,EASX;AAClBwI,oBAAexI,GAVc,EAUV;AACnByI,iBAAYzI,GAXiB,EAWb;AAChB0I,eAAUlH,QAAQoF,WAZW,CAYC;AAZD,CAAP,CAA1B;;AAeApF,QAAQmH,aAAR,GAAsBlK,OAAO;AACzBuJ,iBAAYhI,GADa,EACT;AAChBiI,eAAUjI,GAFe,EAEX;AACdkI,YAAOlI,GAHkB,EAGd;AACXmI,YAAOnI,GAJkB,EAId;AACXoI,aAAQpI,GALiB,EAKb;AACZqI,gBAAWrI,GANc,EAMV;AACfsI,eAAUtI,GAPe,EAOX;AACduI,mBAAcvI,GARW,EAQP;AAClBwI,oBAAexI,GATU,EASN;AACnByI,iBAAYzI,GAVa,EAUT;AAChB0I,eAAUlH,QAAQ6F,UAXO,EAWI;AAC7BuB,eAAUjK,UAAUqB,GAAV,EAAc,EAAd;AAZe,CAAP,CAAtB;;AAeAwB,QAAQqH,qBAAR,GAA8BpK,OAC9B;AACIsJ,YAAOpH,KADX;AAEIqH,iBAAYxH,IAFhB,EAEqB;AACjBsI,gBAAW9H,OAHf,EAGuB;AACnB+H,mBAAc/I,GAJlB,EAIsB;AAClBgJ,gBAAWrK,UAAUqC,OAAV,EAAkB,CAAlB,CALf,EAKoC;AAChCiI,aAAQtK,UAAUqB,GAAV,EAAc,CAAd,CANZ,EAM6B;AACzBmI,YAAOxJ,UAAUqB,GAAV,EAAc,CAAd,CAPX,EAO4B;AACxBoI,aAAQzJ,UAAUqB,GAAV,EAAc,CAAd,CARZ,CAQ4B;AAR5B,CAD8B,CAA9B;;AAYAwB,QAAQ0H,YAAR,GAAqBzK,OAAO;AACxB0K,iBAAY1I,IADY;AAExB6H,eAAU5H,IAFc;AAGxB0I,oBAAe1I,IAHS;AAIxB8H,oBAAe7H;AAJS,CAAP,CAArB;;AAOAa,QAAQ6H,kBAAR,GAA2B5K,OAAO;AAC9B6K,gBAAWtJ,GADmB;AAE9BuJ,UAAK5K,UAAUmB,IAAV,EAAe,EAAf,CAFyB;AAG9B0J,WAAMxJ,GAHwB;AAI9ByJ,eAAU9K,UAAUmB,IAAV,EAAe,EAAf,CAJoB;AAK9B4J,eAAU/K,UAAUmB,IAAV,EAAe,EAAf,CALoB;AAM9B6J,WAAMhL,UAAUmB,IAAV,EAAe4B,OAAOa,cAAtB,CANwB;AAO9BqH,kBAAajL,UAAUmB,IAAV,EAAe4B,OAAOc,eAAtB,CAPiB;AAQ9BqH,mBAAcpJ,IARgB;AAS9BqJ,kBAAarJ,IATiB;AAU9BsJ,aAAQnK,IAVsB;AAW9BoK,iBAAYvJ,IAXkB;AAY9BwJ,gBAAWtL,UAAUmB,IAAV,EAAe,EAAf,CAZmB;AAa9BoK,gBAAWvL,UAAUmB,IAAV,EAAe4B,OAAOe,mBAAtB,CAbmB;AAc9B0H,sBAAiBxL,UAAUmB,IAAV,EAAe4B,OAAOgB,cAAtB,CAda;AAe9B0H,kBAAazL,UAAUmB,IAAV,EAAe4B,OAAOc,eAAtB,CAfiB;AAgB9B6H,cAAS1L,UAAUmB,IAAV,EAAe4B,OAAOiB,iBAAtB,CAhBqB;AAiB9B2H,eAAU3L,UAAUmB,IAAV,EAAe4B,OAAOkB,mBAAtB,CAjBoB;AAkB9B2H,gBAAW5L,UAAUmB,IAAV,EAAe4B,OAAOM,sBAAtB,CAlBmB;AAmB9BwI,gBAAW7L,UAAUmB,IAAV,EAAe4B,OAAOM,sBAAtB,CAnBmB;AAoB9ByI,eAAUxK,MApBoB;AAqB9ByK,mBAAcjK,IArBgB;AAsB9BkK,yBAAoBlK,IAtBU;AAuB9BmK,oBAAenK,IAvBe;AAwB9BoK,mBAAcpK,IAxBgB;AAyB9BqK,oBAAerK,IAzBe;AA0B9BsK,eAAUpM,UAAUmB,IAAV,EAAe,GAAf;AA1BoB,CAAP,CAA3B;;AA6BA;AACA,IAAIkL,MAAI;AACJ,mBAAc,CAACjK,IAAD,EAAM,CAAC,SAAD,EAAWH,MAAX,CAAN,CADV;AAEH,sBAAiB,CAAC,MAAD,EAAQ,EAAR,CAFd;AAGH,oBAAe,CAACC,KAAD,EAAO,CAACP,MAAD,EAAQI,IAAR,EAAaJ,MAAb,EAAoBA,MAApB,EAA2B,SAA3B,EAAqCe,MAArC,CAAP,CAHZ;AAIH,uBAAkB,CAACR,KAAD,EAAO,CAACP,MAAD,EAAQI,IAAR,EAAaJ,MAAb,EAAoBA,MAApB,EAA2BE,IAA3B,EAAgCQ,OAAhC,EAAwC,SAAxC,EAAkDK,MAAlD,CAAP,CAJf;AAKH,qBAAgB,CAACN,IAAD,EAAM,CAACF,KAAD,CAAN,CALb;AAMH,+BAA0B,CAAC,MAAD,EAAQ,CAAC,SAAD,EAAWD,MAAX,CAAR;AAC3B;AAPI,MAQH,wBAAuB,CAACC,KAAD,EAAO,CAACA,KAAD,EAAOb,GAAP,EAAWkB,IAAX,EAAgBV,IAAhB,EAAqB,SAArB,EAA+B,SAA/B,EAAyCI,MAAzC,EAAgDD,KAAhD,CAAP,CARpB;AASH,yBAAoB,CAACE,KAAD,EAAO,CAACA,KAAD,EAAOb,GAAP,EAAWkB,IAAX,EAAgBV,IAAhB,CAAP,CATjB;AAUH,6BAAwB,CAAC,MAAD,EAAQ,CAAC,SAAD,EAAWI,MAAX,EAAkBC,KAAlB,CAAR,CAVrB;AAWH,6BAAwB,CAACE,IAAD,EAAM,CAACF,KAAD,CAAN,CAXrB;AAYH,oCAA+B,CAACE,IAAD,EAAM,CAACF,KAAD,EAAO,SAAP,EAAiBD,MAAjB,EAAwBD,KAAxB,CAAN,CAZ5B;AAaH,2BAAsB,CAACI,IAAD,EAAM,CAACF,KAAD,EAAOP,MAAP,CAAN,CAbnB;AAcH,+BAA0B,CAACS,IAAD,EAAM,CAACF,KAAD,CAAN,CAdvB;AAeH,2BAAsB,CAACF,KAAD,EAAO,EAAP,CAfnB;AAgBH,yBAAoB,CAACI,IAAD,EAAM,CAACF,KAAD,EAAOb,GAAP,EAAWW,KAAX,EAAiBA,KAAjB,EAAuBI,IAAvB,CAAN,CAhBjB;AAiBH,2BAAsB,CAACA,IAAD,EAAM,CAACF,KAAD,EAAOb,GAAP,EAAWW,KAAX,EAAiBF,IAAjB,EAAsBA,IAAtB,EAA2BA,IAA3B,EAAgCM,IAAhC,CAAN,CAjBnB;AAkBH,8BAAyB,CAACA,IAAD,EAAM,CAACF,KAAD,EAAOb,GAAP,EAAWW,KAAX,EAAiBT,IAAjB,EAAsBA,IAAtB,EAA2BA,IAA3B,EAAgCa,IAAhC,EAAqCC,OAArC,CAAN,CAlBtB;AAmBH,4BAAuB,CAACD,IAAD,EAAM,CAACF,KAAD,EAAOL,IAAP,EAAYQ,OAAZ,EAAoBhB,GAApB,CAAN,CAnBpB;AAoBH,8BAAyB,CAACe,IAAD,EAAM,CAACF,KAAD,EAAOL,IAAP,EAAYQ,OAAZ,EAAoBA,OAApB,EAA4BhB,GAA5B,CAAN,CApBtB;AAqBH,0BAAqB,CAACa,KAAD,EAAO,CAACA,KAAD,EAAO,SAAP,EAAiBD,MAAjB,CAAP,CArBlB;AAsBH,yBAAoB,CAACG,IAAD,EAAM,CAACF,KAAD,CAAN,CAtBjB;AAuBH,2BAAsB,CAACC,IAAD,EAAM,CAACD,KAAD,EAAOM,OAAP,EAAeR,KAAf,CAAN,CAvBnB;AAwBH,wBAAmB,CAACI,IAAD,EAAM,CAACF,KAAD,EAAOb,GAAP,CAAN,CAxBhB;AAyBH,4BAAuB,CAACe,IAAD,EAAM,CAACF,KAAD,EAAOL,IAAP,EAAYQ,OAAZ,CAAN,CAzBpB;AA0BH,8BAAyB,CAACD,IAAD,EAAM,CAACF,KAAD,EAAOb,GAAP,EAAWmB,OAAX,EAAmBnB,GAAnB,EAAuBqB,MAAvB,EAA8BrB,GAA9B,CAAN,CA1BtB;AA2BH,wBAAmB,CAACe,IAAD,EAAM,CAACF,KAAD,EAAOL,IAAP,EAAYR,GAAZ,EAAgBgB,OAAhB,EAAwBL,KAAxB,EAA8BX,GAA9B,EAAkCgB,OAAlC,CAAN,CA3BhB;AA4BH,8BAAyB,CAACD,IAAD,EAAM,CAACF,KAAD,EAAOP,MAAP,EAAcN,GAAd,EAAkBmB,OAAlB,EAA0BR,KAA1B,EAAgCU,MAAhC,EAAuCrB,GAAvC,CAAN,CA5BtB;AA6BH,4BAAuB,CAACe,IAAD,EAAM,CAACF,KAAD,EAAOb,GAAP,EAAWmB,OAAX,EAAmBnB,GAAnB,EAAuBqB,MAAvB,EAA8BrB,GAA9B,CAAN;AACxB;AA9BI,MA+BH,8BAA6B,CAACe,IAAD,EAAM,CAACF,KAAD,EAAOb,GAAP,EAAW,SAAX,EAAqBA,GAArB,CAAN;AAC9B;AACA;AAjCI,MAkCH,6BAA4B,CAACa,KAAD,EAAO,CAAC,SAAD,EAAWG,OAAX,EAAmBV,MAAnB,CAAP,CAlCzB;AAmCH,gCAA2B,CAACS,IAAD,EAAM,CAACF,KAAD,CAAN;AAnCxB,CAAR;AAqCA;AACA;AACA;AACA;;;;;;;AAOAc,MAAMsJ,UAAN,GAAiB,UAASC,OAAT,EAAiBC,IAAjB,EAAuB;AACpC,WAAO3M,IAAI4M,WAAJ,CAAgBF,QAAQ1M,GAAR,EAAhB,EAA8B,CAA9B,EAAgC2M,IAAhC,CAAP;AACH,CAFD;;AAIAxJ,MAAM0J,SAAN,GAAgB,UAASC,GAAT,EAAc;AAC1BA,UAAI3M,UAAUmB,IAAV,EAAgByL,UAAhB,CAA2BD,GAA3B,EAAgCE,MAApC;AACA,WAAOnM,OAAOoM,MAAP,CAAcH,GAAd,EAAkB,QAAlB,CAAP;AACH,CAHD;;AAKA3J,MAAM+J,SAAN,GAAgB,UAASJ,GAAT,EAAa;AACzB,WAAOjM,OAAOsM,MAAP,CAAcL,GAAd,EAAkB,QAAlB,CAAP;AACH,CAFD;;AAIA3J,MAAMiK,YAAN,GAAmB,UAAUC,OAAV,EAAkBC,IAAlB,EAAwB;AACvC,QAAIC,MAAI,EAAR;AACAnN,MAAEoN,IAAF,CAAOF,KAAKG,QAAL,EAAP,EAAuB,UAACC,GAAD,EAAKC,GAAL,EAAW;AAC9B,YAAGN,QAAQO,MAAR,CAAeD,GAAf,EAAoBzF,IAApB,CAAyB2F,IAAzB,KAAgC,WAAhC,IACGR,QAAQO,MAAR,CAAeD,GAAf,EAAoBzF,IAApB,CAAyBA,IAAzB,CAA8B2F,IAA9B,KAAqC,MAD3C,EACkD;AAC9CN,gBAAII,GAAJ,IAASD,IAAIV,MAAJ,CAAWc,WAAX,CAAuB,CAAvB,CAAT;AACA;AACH;AACDP,YAAII,GAAJ,IAASD,GAAT;AACH,KAPD;AAQA,WAAOH,GAAP;AACH,CAXD;;AAaAQ,UAAQC,OAAOD,OAAP,GAAiB,YAAU;AAC/B,aAASE,KAAT,GAAgB;AAAA;;AACZ7N,UAAE8N,MAAF,CAAS,IAAT,EAAc;AACV,yBAAYpO,IAAIqO,OAAJ,CAAYlN,GAAZ,EAAiBuL,GAAjB,CADF;AAEV,qBAAQzJ,KAFE;AAGV,yBAAYE,SAHF;AAIV,uBAAUD,OAJA;AAKV,sBAASE,MALC;AAMV,qBAAQC;AANE,SAAd;AAQA,aAAKiL,cAAL,GAAoB,EAApB;AACAhO,UAAEoN,IAAF,CAAO,KAAKa,SAAZ,EAAsB,UAACC,GAAD,EAAKT,IAAL,EAAY;AAC9B,kBAAKO,cAAL,CAAoBP,IAApB,+DAA0B;AAAA,kDAAUU,KAAV;AAAUA,yBAAV;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,iEACf,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAASC,MAAT,EAAkB;AACjCJ,wCAAIK,KAAJ,CAAUnK,KAAV,QAAqB,GAAGC,MAAH,CAAU8J,KAAV,EAAgB,UAACK,GAAD,EAAKrB,GAAL,EAAW;AAC5C,4CAAGqB,GAAH,EAAQ,OAAOF,OAAOE,GAAP,CAAP;AACRH,gDAAQlB,GAAR;AACH,qCAHoB,CAArB;AAIH,iCALM,CADe;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAA1B;AAQH,SATD;AAUH;AACD3M,SAAKiO,QAAL,CAAcZ,KAAd,EAAqBtN,YAArB;AACA,WAAO,IAAIsN,KAAJ,EAAP;AACH,CAxBuB,EAAxB","file":"dhnetsdk.js","sourcesContent":["const ffi=require('ffi');\r\nconst ref = require('ref');\r\nconst struct = require('ref-struct');\r\nconst Enum=require('enum');\r\nconst ArrayType=require('ref-array');\r\nconst _=require('lodash');\r\nconst path=require('path');\r\nconst process=require('process');\r\nconst isX64=process.arch==='x64';\r\nconst iswin=process.platform==='win32';\r\n//const isLinux=process.platform.indexOf('win')===-1;\r\nconst EventEmitter = require('events');\r\nconst util = require('util');\r\nconst legacy = require('legacy-encoding');\r\nconst config=global.server_config||require('../../config/config');\r\n//let dll=path.join(config.getLibDir(),(isX64?'DHNetSDK/x64/dhnetsdk':'DHNetSDK/x32/dhnetsdk'));\r\n//console.log(\"dll path\" + dll);\r\nlet dll=path.join(config.getLibDir(),(iswin?isX64?'DHNetSDK/x64/dhnetsdk':'DHNetSDK/x32/dhnetsdk':'DHNetSDK/linux/libdhnetsdk.so'));\r\nlet bool=ref.types.bool;\r\nlet char=ref.types.char;\r\nlet uchar=ref.types.uchar;\r\nlet int=ref.types.int;\r\nlet ushort=ref.types.ushort;\r\nlet long=ref.types.long;\r\nlet ulong=ref.types.ulong;\r\nlet longlong=ref.types.longlong;\r\nlet float=ref.types.float;\r\nlet string=ref.types.CString;\r\nlet ENUM=int;\r\n\r\nlet BYTE=uchar;\r\nlet WORD=ushort;\r\nlet DWORD=ulong;\r\nlet LDWORD=ulong;\r\nlet LLONG=long;\r\nlet LONG=long;\r\nlet BOOL=int;\r\n\r\nlet voidPtr=ref.refType('void');\r\nlet HWND=voidPtr;\r\nlet charPtr=ref.refType('char');\r\nlet BYTEPtr=ref.refType('uchar');\r\nlet intPtr=ref.refType('int');\r\n\r\nif(isX64){\r\n    LLONG=ref.types.int64;\r\n    LDWORD=ref.types.int64;\r\n}\r\nlet enums={};\r\nlet structs={};\r\nlet callbacks={};\r\nlet consts={};\r\nlet utils={};\r\n\r\nconsts.DH_SERIALNO_LEN=48;\r\nconsts.PTZ_PRESET_NAME_LEN=64;\r\nconsts.DH_DEVSTATE_IPC=0x0025;\r\nconsts.DH_MAX_IPADDR_LEN=16;\r\nconsts.DH_USER_NAME_LENGTH_EX=16;\r\nconsts.DH_USER_PSW_LENGTH_EX=16;\r\nconsts.DH_MAX_IPADDR_OR_DOMAIN_LEN=64;\r\nconsts.DH_DEVSTATE_PTZ_LOCATION=0x36;\r\nconsts.DH_DEVSTATE_PTZ_PRESET_LIST=0x57;\r\nconsts.CFG_CMD_ENCODE='Encode';\r\nconsts.DEVSTATE_TALK_ECTYPE=9;\r\nconsts.DH_MACADDR_LEN=40;\r\nconsts.DH_DEV_TYPE_LEN=32;\r\nconsts.DH_DEV_SERIALNO_LEN=48;\r\nconsts.DH_MAX_URL_LEN=128;\r\nconsts.DH_DEV_TYPE_LEN=32;\r\nconsts.DH_MAX_STRING_LEN=128;\r\nconsts.DH_MACHINE_NAME_NUM=64;\r\nconsts.DH_USER_NAME_LENGTH_EX=16;\r\n\r\ncallbacks.fDisConnect=(fn)=>{\r\n    return ffi.Callback.apply(ffi,['void',[longlong,string,long,LDWORD]].concat(fn));\r\n};\r\ncallbacks.fRealDataCallBackEx=(fn)=>{\r\n    return ffi.Callback.apply(ffi,['void',[LLONG,DWORD,BYTEPtr,DWORD,LONG,LDWORD]].concat(fn));\r\n};\r\ncallbacks.pfAudioDataCallBack=(fn)=> {\r\n    return ffi.Callback.apply(ffi,['void',[LLONG,BYTEPtr,DWORD,BYTE,LDWORD]].concat(fn));\r\n};\r\ncallbacks.fRealPlayDisConnect=(fn)=> {\r\n    return ffi.Callback.apply(ffi,['void',[LLONG,ENUM,voidPtr,LDWORD]].concat(fn));\r\n};\r\n\r\ncallbacks.fHaveReConnect=(fn)=> {\r\n    return ffi.Callback.apply(ffi,['void',[LLONG,string,LONG,LDWORD]].concat(fn));\r\n};\r\n\r\ncallbacks.fDecCallBack=(fn)=>{\r\n    return ffi.Callback.apply(ffi,['void',[LLONG,string,LONG,LDWORD]].concat(fn));\r\n};\r\n\r\ncallbacks.fSearchDevicesCB= (fn)=> {\r\n    return ffi.Callback.apply(ffi,['void',['pointer',voidPtr]].concat(fn));\r\n};\r\n\r\nenums.loginType= new Enum({\"TCP\":0}, { 'freez': true });\r\nenums.playType=new Enum({\r\n    'Realplay':0,'Multiplay':1,'Realplay_0':2,'Realplay_1':3,\r\n    'Realplay_2':4,'Realplay_3':5},{ 'freez': true });\r\nenums.PTZ=new Enum({\r\n    'PTZ_UP':0,'PTZ_DOWN':1,'PTZ_LEFT':2,'PTZ_RIGHT':3,'PTZ_ZOOM_ADD':4,\r\n    'PTZ_ZOOM_DEC':5,'PTZ_FOCUS_ADD':6,'PTZ_FOCUS_DEC':7,'PTZ_APERTURE_ADD':8,\r\n    'PTZ_APERTURE_DEC':9,'PTZ_POINT_MOVE':10,'PTZ_POINT_SET':11,'PTZ_POINT_DEL':12,\r\n    'PTZ_POINT_LOOP':13,'PTZ_LAMP':14,\r\n    'EXTPTZ_LEFTTOP':0x20,'EXTPTZ_RIGHTTOP':0x21,'EXTPTZ_LEFTDOWN':0x22,'EXTPTZ_RIGHTDOWN':0x23,\r\n    'EXTPTZ_MOVE_ABSOLUTELY':0x45\r\n},{ 'freez': true });\r\nenums.REALPLAY_DISCONNECT_EVENT=new Enum({'REAVE':0,'NETFORBID':1,'SUBCONNECT':2},{ 'freez': true });\r\nenums.CTRL_TYPE=new Enum({\r\n    'TRIGGER_ALARM_IN':100,'TRIGGER_ALARM_OUT':101},{ 'freez': true });\r\nenums.USEDEV_MODE=new Enum({'TALK_CLIENT_MODE':0,'TALK_SERVER_MODE':1,'TALK_ENCODE_TYPE':2,\r\n    'TALK_CHANNEL':5,'TALK_SPEAK_PARAM':7,'TALK_MODE3':9,'TALK_TRANSFER_MODE':11\r\n},{ 'freez': true });\r\nenums.TALK_CODING_TYPE=new Enum({'DEFAULT':0,'PCM':1,'G711a':2,'ARM':3,'G711u':4,'G726':5,'G723_53':6\r\n    ,'G723_63':7,'AAC':8,'OGG':9,'G729':10,'MPEG2':11,'MPEG2_Layer2':12,'G722_1':13,'ADPCM':21,'MP3':22\r\n},{ 'freez': true });\r\nenums.Dev_State=new Enum({'TALK_ECTYPE':9,'LOCATION_INFO':0x36,'PTZ_PRESET_LIST':0x57},{ 'freez': true });\r\nenums.IPC_TYPE=new Enum({\r\n    '大华':0,'美电贝尔':1,'松下':2,'索尼':3,'Dynacolor':4,'天城威视':5,'三星':6,'YOKO':7,'安讯视AXIS':8,'三洋':9,\r\n    'Bosch':10,'Peclo':11,'Provideo':12,'ACTi':13,'Vivotek':14,'Arecont':15,'PrivateEH':16,'IMatek':17,'Shany':18,\r\n    '动力盈科':19,'Ura':20,'Bticino':21,'Onvif协议':22,'视霸':23,'亚安':24,'Airpop':25,'TYCO':26,'讯美':27,'海康':28,\r\n    'LG':29,'奥奇曼':30,'宝康':31,'Watchnet':32,'Xvision':33,'富士通':34,'Canon':35,'GE':36,'巴斯勒':37,'帕特罗':38,\r\n   'CPPLUS K':39,'CPPLUS R':40,'CPPLUS U':41,'CPPLUS IPC':42,'讯美s-ONVIF':43,'广东电网':44,'PSIA':45,'GB2818':46,'GDYX':47,\r\n    '其他自定义':48,'CPPLUS NVR':49,'CPPLUS DVR':50,'Airlive':51,'NPE':52,'AXVIEW':53,'东方网力':54,'HYUNDAI DVR':56,\r\n    '爱普华顿':57,'微创':58,'成都佳发':59,'JVC':60,'英飞拓':61,'ADT':62,'海南创先':63,'CPPLUS 球机':64,'海信':65,'天津高速':66,\r\n    '组播':79,'RVi':84\r\n},{ 'freez': true });\r\nenums.DH_SYS_ABILITY=new Enum({'DEVALL_INFO':26},{ 'freez': true })\r\nenums.DH_DEV_ENABLE=new Enum({'JSON_CONFIG':30,'HIDE_FUNCTION':31},{ 'freez': true });\r\nenums.EM_DH_PTZ_PRESET_STATUS=new Enum({'UNKNOWN':0,'REACH':1,'UNREACH':2},{ 'freez': true });\r\nenums.EM_USEDEV_MODE=new Enum({'TALK_CLIENT_MODE':0,'TALK_SERVER_MODE':1,'TALK_ENCODE_TYPE':2,'ALARM_LISTEN_MODE':3,\r\n    'CONFIG_AUTHORITY_MODE':4,'TALK_TALK_CHANNEL':5,'RECORD_STREAM_TYPE':6,'TALK_SPEAK_PARAM':7,'RECORD_TYPE':8,\r\n    'TALK_MODE3':9,'PLAYBACK_REALTIME_MODE':10,'TALK_TRANSFER_MODE':11,'TALK_VT_PARAM':12,'TARGET_DEV_ID':13\r\n},{ 'freez': true });\r\nenums.DH_TALK_CODING_TYPE=new Enum({'AAC':8},{ 'freez': true });\r\nenums.NET_EM_VIDEO_COMPRESSION=new Enum({'H264':7},{ 'freez': true });\r\nenums.EM_H264_PROFILE_RANK=new Enum({'BASELINE':1,'MAIN':2,'EXTENDED':3,'HIGH':4},{ 'freez': true });\r\nenums.NET_EM_FORMAT_TYPE=new Enum({'EXTRA1':4,'EXTRA2':4,'EXTRA3':6},{'freez': true });\r\nenums.NET_EM_BITRATE_CONTROL=new Enum({'CBR':0,'VBR':1},{'freez': true });\r\nenums.NET_EM_IMAGE_QUALITY=new Enum({Q10:1,Q30:2,Q50:3,Q60:4,Q80:5,Q100:6},{'freez': true });\r\nenums.EM_DECODE_FRAME_TYPE=new Enum({UNKNOWN:-1,VIDEO:0,AUDIO:1},{'freez': true });\r\n\r\nstructs.NET_DEVICEINFO=struct({\r\n    'sSerialNumber':ArrayType(BYTE,consts.DH_SERIALNO_LEN),\r\n    'nAlarmInPortNum':BYTE,\r\n    'nAlarmOutPortNum':BYTE,\r\n    'byDiskNum':BYTE,\r\n    'byDVRType':BYTE,\r\n    'byChanNum':BYTE\r\n});\r\nstructs.NET_DEVICEINFO_Ex=struct({\r\n    'sSerialNumber':ArrayType(BYTE,consts.DH_SERIALNO_LEN),\r\n    'nAlarmInPortNum':int,\r\n    'nAlarmOutPortNum':int,\r\n    'nDiskNum':int,\r\n    'nDVRType':int,\r\n    'nChanNum':int,\r\n    'byLimitLoginTime':BYTE,\r\n    'byLeftLogTimes':BYTE,\r\n    'bReserved':ArrayType(BYTE,2),\r\n    'nLockLeftTime':int,\r\n    'Reserved':ArrayType(char,32)\r\n});\r\nstructs.ALARMCTRL_PARAM=struct({\r\n    'dwSize':DWORD,\r\n    'nAlarmNo':int,\r\n    'nAction':int\r\n});\r\nstructs.NET_SPEAK_PARAM=struct({'dwSize':DWORD,'nMode':int,'nSpeakerChannel':int});\r\nstructs.NET_TALK_TRANSFER_PARAM=struct({'dwSize':DWORD,'bTransfer':BOOL});\r\nstructs.NET_PTZ_PRESET=struct({'nIndex':int,'szName':ArrayType(char,consts.PTZ_PRESET_NAME_LEN),'szReserve':ArrayType(char,64)});\r\nstructs.NET_PTZ_PRESET_LIST=struct({'dwSize':DWORD,'dwMaxPresetNum':DWORD,'dwRetPresetNum':DWORD,'pstuPtzPorsetList':'pointer'});\r\nstructs.DH_DEV_IPC_INFO=struct({'nTypeCount':int,'bSupportTypes':ArrayType(BYTE,128)});\r\nstructs.DEV_ENCODER_INFO=struct({\r\n    'szDevIp':ArrayType(char,consts.DH_MAX_IPADDR_LEN),\r\n    'wDevPort':WORD,\r\n    'bDevChnEnable':BYTE,\r\n    'byDecoderID':BYTE,\r\n    'szDevUser':ArrayType(char,consts.DH_USER_NAME_LENGTH_EX),\r\n    'szDevPwd':ArrayType(char,consts.DH_USER_PSW_LENGTH_EX),\r\n    'nDevChannel':int,\r\n    'nStreamType':int,\r\n    'byConnType':BYTE,\r\n    'byWorkMode':BYTE,\r\n    'wListenPort':WORD,\r\n    'dwProtoType':DWORD,\r\n    'szDevName':ArrayType(char,64),\r\n    'byVideoInType':BYTE,\r\n    'szDevIpEx':ArrayType(char,consts.DH_MAX_IPADDR_OR_DOMAIN_LEN),\r\n    'bySnapMode':BYTE,\r\n    'byManuFactory':BYTE,\r\n    'byDeviceType':BYTE,\r\n    'byDecodePolicy':BYTE,\r\n    'bReserved':ArrayType(BYTE,3),\r\n    'dwHttpPort':DWORD,\r\n    'dwRtspPort':DWORD,\r\n    'szChnName':ArrayType(char,32),\r\n    'dwDecoderID':DWORD\r\n});\r\nstructs.CFG_VIDEO_FORMAT=struct({\r\n    'abCompression':bool,\r\n    'abWitdh':bool,\r\n    'abHeight':bool,\r\n    'abBitRateControl':bool,\r\n    'abBitRate':bool,\r\n    'abFrameRate':bool,\r\n    'abImageQuality':bool,\r\n    'abFrameType':bool,\r\n    'emCompression':ENUM,\r\n    'nWidth':int,\r\n    'nHeight':int,\r\n    'emBitRateControl':ENUM,\r\n    'nBitRate':int,\r\n    'nFrameRate':int,\r\n    'nIFrameInterval':int,\r\n    'emImageQuality':int,\r\n    'nFrameType':int\r\n});\r\nstructs.CFG_AUDIO_ENCODE_FORMAT=struct({\r\n    'abCompression':bool,\r\n    'abDepth':bool,\r\n    'abFrequency':bool,\r\n    'abMode':bool,\r\n    'abFrameType':bool,\r\n    'abPacketPeriod':bool,\r\n    'emCompression':ENUM,\r\n    'nDepth':int,\r\n    'nFrequency':int,\r\n    'nMode':int,\r\n    'nFrameType':int,\r\n    'nPacketPeriod':int\r\n});\r\nstructs.CFG_VIDEOENC_OPT=struct({\r\n    'abVideoEnable':bool,\r\n    'abAudioEnable':bool,\r\n    'abSnapEnable':bool,\r\n    'abAudioAdd':bool,\r\n    'abAudioFormat':bool,\r\n    'bVideoEnable':BOOL,\r\n    'stuVideoFormat':structs.CFG_VIDEO_FORMAT,\r\n    'bAudioEnable':BOOL,\r\n    'bSnapEnable':BOOL,\r\n    'stuAudioFormat':structs.CFG_AUDIO_ENCODE_FORMAT\r\n});\r\nstructs.DH_DEV_ENABLE_INFO=struct({ 'IsFucEnable':ArrayType(DWORD,512)});\r\nstructs.PTZ_SPACE_UNIT=struct({\r\n    'nPositionX':int,\r\n    'nPositionY':int,\r\n    'nZoom':int,\r\n    'szReserve':ArrayType(char,32)\r\n});\r\nstructs.PTZ_SPEED_UNIT=struct({\r\n    'fPositionX':float,\r\n    'fPositionY':float,\r\n    'fZoom':int,\r\n    'szReserve':ArrayType(char,32)\r\n});\r\nstructs.PTZ_CONTROL_ABSOLUTELY=struct({\r\n    'stuPosition':structs.PTZ_SPACE_UNIT,\r\n    'stuSpeed':structs.PTZ_SPEED_UNIT,\r\n    'szReserve':ArrayType(char,64)\r\n});\r\nstructs.DH_PTZ_LOCATION_INFO=struct({\r\n    'nChannelID':int,\r\n    'nPTZPan':int,\r\n    'nPTZTilt':int,\r\n    'nPTZZoom':int,\r\n    'bState':BYTE,\r\n    'bAction':BYTE,\r\n    'bFocusState':BYTE,\r\n    'bEffectiveInTimeSection':BYTE,\r\n    'nPtzActionID':int,\r\n    'dwPresetID':DWORD,\r\n    'fFocusPosition':float,\r\n    'bZoomState':BYTE,\r\n    'bReserved':ArrayType(BYTE,3),\r\n    'dwSequence':DWORD,\r\n    'dwUTC':DWORD,\r\n    'emPresetStatus':ENUM,\r\n    'nZoomValue':int,\r\n    'reserved':ArrayType(int,244)\r\n});\r\nstructs.NET_SPEAK_PARAM=struct({\r\n    'dwSize':DWORD,\r\n    'nMode':int,//0d对讲，1喊话\r\n    'nSpeakerChannel':int,//喊话时有效\r\n    'bEnableWait':BOOL//等待设备响应，默认不等待\r\n});\r\nstructs.NET_TALK_TRANSFER_PARAM=struct({\r\n    'dwSize':DWORD,\r\n    'bTransfer':BOOL//true开启转发,false 关闭转发\r\n});\r\nstructs.TALKDECODE_INFO=struct({\r\n    'encodeType':ENUM,\r\n    'nAudioBit':int,\r\n    'dwSampleRate':DWORD,\r\n    'nPacketPeriod':int,//打包周期，仅仅支持25，单位ms\r\n    'reserved':ArrayType(char,60)\r\n});\r\nstructs.NET_ENCODE_VIDEO_INFO=struct({\r\n    'dwSize':DWORD,\r\n    'emFormatType':ENUM,\r\n    'bVideoEnable':BOOL,\r\n    'emCompression':ENUM,\r\n    'nWidth':int,\r\n    'nHeight':int,\r\n    'emBitRateControl':ENUM,\r\n    'nBitRate':int,\r\n    'nFrameRate':float,\r\n    'nIFrameInterval':int,\r\n    'emImageQuality':ENUM\r\n});\r\nstructs.TALKFORMAT_LIST=struct({\r\n    nSupportNum:int,\r\n    type:ArrayType(structs.TALKDECODE_INFO,64),\r\n    reserved:ArrayType(char,64)\r\n});\r\n\r\nstructs.NET_TIME_EX=struct({\r\n    dwYear:DWORD,// 年\r\n    dwMonth:DWORD,// 月\r\n    dwDay:DWORD,// 日\r\n    dwHour:DWORD,// 时\r\n    dwMinute:DWORD,// 分\r\n    dwSecond:DWORD,// 秒\r\n    dwMillisecond:DWORD,// 毫秒\r\n    dwReserved:ArrayType(DWORD,2)// 保留字段\r\n});\r\n\r\nstructs.SYSTEMTIME=struct({\r\n    wYear:WORD,\r\n    wMonth:WORD,\r\n    wDayOfWeek:WORD ,\r\n    wDay:WORD,\r\n    wHour:WORD,\r\n    wMinute:WORD,\r\n    wSecond:WORD,\r\n    wMilliseconds:WORD,\r\n});\r\n\r\nstructs.NET_FRAME_INFO_EX=struct({\r\n    dwSize:DWORD,\r\n    emFrameType:ENUM,//视频帧类型,见上面定义\r\n    nFrameSeq:int,//帧序号\r\n    nStamp:int,//时标信息,单位毫秒\r\n    nWidth:int,//画面宽,单位像素.如果是音频数据则为0.\r\n    nHeight:int,//画面高,如果是音频数据则为0\r\n    nFrameRate:int,//编码时产生的图像帧率\r\n    nChannels:int,//音频通道数\r\n    nBitPerSample:int,//音频采样位数\r\n    nSamplesPerSec:int,//音频采样频率\r\n    nRemainData:int,//缓冲剩余数据量\r\n    nDataTime:structs.NET_TIME_EX,//时间\r\n});\r\n\r\nstructs.FRAME_INFO_EX=struct({\r\n    emFrameType:int,//视频帧类型,见上面定义\r\n    nFrameSeq:int,//帧序号\r\n    nStamp:int,//时标信息,单位毫秒\r\n    nWidth:int,//画面宽,单位像素.如果是音频数据则为0.\r\n    nHeight:int,//画面高,如果是音频数据则为0\r\n    nFrameRate:int,//编码时产生的图像帧率\r\n    nChannels:int,//音频通道数\r\n    nBitPerSample:int,//音频采样位数\r\n    nSamplesPerSec:int,//音频采样频率\r\n    nRemainData:int,//缓冲剩余数据量\r\n    nDataTime:structs.SYSTEMTIME,//时间\r\n    nReserved:ArrayType(int,59)\r\n});\r\n\r\nstructs.NET_FRAME_DECODE_INFO=struct(\r\n{\r\n    dwSize:DWORD,\r\n    emFrameType:ENUM,//帧类型,定义见FRAME_INFO_EX里nFrameType字段\r\n    pAudioData:voidPtr,//音频数据,如果是音频帧\r\n    nAudioDataLen:int,//音频数据长度\r\n    pVideoData:ArrayType(voidPtr,3),//分别表示视频的YUV三个分量\r\n    nStride:ArrayType(int,3),//分别表示YUV三个分量的跨距\r\n    nWidth:ArrayType(int,3),//分别表示YUV三个分量的宽度\r\n    nHeight:ArrayType(int,3)//分别表示YUV三个分量的高度\r\n});\r\n\r\nstructs.AUDIO_FORMAT=struct({\r\n    byFormatTag:BYTE,\r\n    nChannels:WORD,\r\n    wBitsPerSample:WORD,\r\n    nSamplesPerSec:DWORD\r\n});\r\n\r\nstructs.DEVICE_NET_INFO_EX=struct({\r\n    iIPVersion:int,\r\n    szIP:ArrayType(char,64),\r\n    nPort:int,\r\n    szSubmask:ArrayType(char,64),\r\n    szGateway:ArrayType(char,64),\r\n    szMac:ArrayType(char,consts.DH_MACADDR_LEN),\r\n    szDeviceType:ArrayType(char,consts.DH_DEV_TYPE_LEN),\r\n    byManuFactory:BYTE,\r\n    byDefinition:BYTE,\r\n    bDhcpEn:bool,\r\n    byReserved1:BYTE,\r\n    verifyData:ArrayType(char,88),\r\n    szSerialNo:ArrayType(char,consts.DH_DEV_SERIALNO_LEN),\r\n    szDevSoftVersion:ArrayType(char,consts.DH_MAX_URL_LEN),\r\n    szDetailType:ArrayType(char,consts.DH_DEV_TYPE_LEN),\r\n    szVendor:ArrayType(char,consts.DH_MAX_STRING_LEN),\r\n    szDevName:ArrayType(char,consts.DH_MACHINE_NAME_NUM),\r\n    szUserName:ArrayType(char,consts.DH_USER_NAME_LENGTH_EX),\r\n    szPassWord:ArrayType(char,consts.DH_USER_NAME_LENGTH_EX),\r\n    nHttpPort:ushort,\r\n    wVideoInputCh:BYTE,\r\n    wRemoteVideoInputCh:BYTE,\r\n    wVideoOutputCh:BYTE,\r\n    wAlarmInputCh:BYTE,\r\n    wAlarmOutputCh:BYTE,\r\n    cReserved:ArrayType(char,244)\r\n});\r\n\r\n//CLIENT_GetDevConfig,CLIENT_SetDevConfig,CLIENT_GetDevConfig 设置视频流特性\r\nlet fns={\r\n    'CLIENT_Init':[BOOL,['pointer',LDWORD]]\r\n    ,'CLIENT_Cleanup':['void',[]]\r\n    ,'CLIENT_Login':[LLONG,[string,WORD,string,string,'pointer',intPtr]]\r\n    ,'CLIENT_LoginEx2':[LLONG,[string,WORD,string,string,ENUM,voidPtr,'pointer',intPtr]]\r\n    ,'CLIENT_Logout':[BOOL,[LLONG]]\r\n    ,'CLIENT_SetAutoReconnect':['void',['pointer',LDWORD]]\r\n    //仅仅nvr下可用，摄像头无线超时，可能是nvr的缓存函数后程序问题\r\n    ,'CLIENT_StartRealPlay':[LLONG,[LLONG,int,HWND,ENUM,'pointer','pointer',LDWORD,DWORD]]\r\n    ,'CLIENT_RealPlayEx':[LLONG,[LLONG,int,HWND,ENUM]]\r\n    ,'CLIENT_SetDecCallBack':['void',['pointer',LDWORD,LLONG]]\r\n    ,'CLIENT_StopRealPlayEx':[BOOL,[LLONG]]\r\n    ,'CLIENT_SetRealDataCallBackEx':[BOOL,[LLONG,'pointer',LDWORD,DWORD]]\r\n    ,'CLIENT_SaveRealData':[BOOL,[LLONG,string]]\r\n    ,'CLIENT_StopSaveRealData':[BOOL,[LLONG]]\r\n    ,'CLIENT_GetLastError':[DWORD,[]]\r\n    ,'CLIENT_PTZControl':[BOOL,[LLONG,int,DWORD,DWORD,BOOL]]\r\n    ,'CLIENT_DHPTZControl':[BOOL,[LLONG,int,DWORD,BYTE,BYTE,BYTE,BOOL]]\r\n    ,'CLIENT_DHPTZControlEx2':[BOOL,[LLONG,int,DWORD,long,long,long,BOOL,voidPtr]]\r\n    ,'CLIENT_ControlDevice':[BOOL,[LLONG,ENUM,voidPtr,int]]\r\n    ,'CLIENT_ControlDeviceEx':[BOOL,[LLONG,ENUM,voidPtr,voidPtr,int]]\r\n    ,'CLIENT_StartTalkEx':[LLONG,[LLONG,'pointer',LDWORD]]\r\n    ,'CLIENT_StopTalkEx':[BOOL,[LLONG]]\r\n    ,'CLIENT_TalkSendData':[LONG,[LLONG,charPtr,DWORD]]\r\n    ,'CLIENT_SetVolume':[BOOL,[LLONG,int]]\r\n    ,'CLIENT_SetDeviceMode':[BOOL,[LLONG,ENUM,voidPtr]]\r\n    ,'CLIENT_QuerySystemInfo':[BOOL,[LLONG,int,charPtr,int,intPtr,int]]\r\n    ,'CLIENT_GetConfig':[BOOL,[LLONG,ENUM,int,voidPtr,DWORD,int,voidPtr]]\r\n    ,'CLIENT_GetNewDevConfig':[BOOL,[LLONG,string,int,charPtr,DWORD,intPtr,int]]\r\n    ,'CLIENT_QueryDevState':[BOOL,[LLONG,int,charPtr,int,intPtr,int]]\r\n    //QueryDecEncoderInfo的第二个参数为nvr中的通道号减一\r\n    ,'CLIENT_QueryDecEncoderInfo':[BOOL,[LLONG,int,'pointer',int]]\r\n    //,'CLIENT_OpenSound':[BOOL,[LLONG]]\r\n    //,'CLIENT_CloseSound':[BOOL,[]]*/\r\n    ,'CLIENT_StartSearchDevices':[LLONG,['pointer',voidPtr,string]]\r\n    ,'CLIENT_StopSearchDevices':[BOOL,[LLONG]]\r\n};\r\n//CFG_ENCODE_INFO\r\n//CFG_AUDIO_ENCODE_FORMAT\r\n//\r\n/*if(!isLinux){\r\n    fns=_.defaults(fns, {\r\n        'CLIENT_RecordStartEx': [BOOL, [LLONG]]\r\n        ,'CLIENT_RecordStopEx': [BOOL, [LLONG]]\r\n    });\r\n}*/\r\n\r\nutils.readBuffer=function(bytePtr,size) {\r\n    return ref.readPointer(bytePtr.ref(),0,size);\r\n};\r\n\r\nutils.mbcs2Utf8=function(buf) {\r\n    buf=ArrayType(char).untilZeros(buf).buffer;\r\n    return legacy.decode(buf,'gb2312');\r\n};\r\n\r\nutils.utf82Mbcs=function(buf){\r\n    return legacy.encode(buf,'gb2312');\r\n};\r\n\r\nutils.structParser=function (_struct,data) {\r\n    let ret={};\r\n    _.each(data.toObject(),(val,key)=>{\r\n        if(_struct.fields[key].type.name==='ArrayType'\r\n            &&_struct.fields[key].type.type.name==='char'){\r\n            ret[key]=val.buffer.readCString(0);\r\n            return;\r\n        }\r\n        ret[key]=val;\r\n    });\r\n    return ret;\r\n};\r\n\r\nexports=module.exports= (function(){\r\n    function DHLib(){\r\n        _.assign(this,{\r\n            'functions':ffi.Library(dll, fns),\r\n            'enums':enums,\r\n            'callbacks':callbacks,\r\n            'structs':structs,\r\n            'consts':consts,\r\n            'utils':utils\r\n        });\r\n        this.asyncFunctions={};\r\n        _.each(this.functions,(fun,name)=>{\r\n            this.asyncFunctions[name]=async (...argus)=>{\r\n                return new Promise((resolve,reject)=>{\r\n                    fun.async.apply(this,[].concat(argus,(err,ret)=>{\r\n                        if(err) return reject(err);\r\n                        resolve(ret);\r\n                    }));\r\n                });\r\n            }\r\n        });\r\n    }\r\n    util.inherits(DHLib, EventEmitter);\r\n    return new DHLib();\r\n})();"]}