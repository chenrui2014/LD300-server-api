{"version":3,"sources":["../../src/db/index.js"],"names":["mongoose","require","logger","config","exports","module","connect","Promise","resolve","reject","global","connection","on","error","info","connections","mongo","uri","options"],"mappings":";;AAAA;;;AAGA,IAAMA,WAASC,QAAQ,UAAR,CAAf;AACA,IAAMC,SAAOD,QAAQ,WAAR,CAAb;AACA,IAAME,SAAOF,QAAQ,iBAAR,CAAb;AACA;AACA;AACA;AACA;;AAEA;AACAG,UAAQC,OAAOD,OAAP,GAAe,SAASE,OAAT,GAAmB;;AAEtC,WAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpCT,iBAASO,OAAT,GAAmBG,OAAOH,OAA1B;AACA;AACAP,iBAASW,UAAT,CACKC,EADL,CACQ,OADR,EACiB,UAACC,KAAD;AAAA,mBAAWJ,OAAOI,KAAP,CAAX;AAAA,SADjB,EAEKD,EAFL,CAEQ,OAFR,EAEiB;AAAA,mBAAMV,OAAOY,IAAP,CAAY,6BAAZ,CAAN;AAAA,SAFjB,EAGKF,EAHL,CAGQ,MAHR,EAGgB;AAAA,mBAAMJ,QAAQR,SAASe,WAAT,CAAqB,CAArB,CAAR,CAAN;AAAA,SAHhB;;AAKAf,iBAASM,OAAT,CAAiBH,OAAOa,KAAP,CAAaC,GAA9B,EAAmCd,OAAOa,KAAP,CAAaE,OAAhD;AACH,KATM,CAAP;AAUH,CAZD","file":"index.js","sourcesContent":["/**\r\n * Created by chen on 17-8-21.\r\n */\r\nconst mongoose=require('mongoose');\r\nconst logger=require('../logger');\r\nconst config=require('../config/index');\r\n//import mongoose from 'mongoose';\r\n//import logger from '../logger';\r\n//import config from '../config';\r\n// import bluebird from 'bluebird';\r\n\r\n//export default\r\nexports=module.exports=function connect() {\r\n\r\n    return new Promise((resolve, reject) => {\r\n        mongoose.Promise = global.Promise;\r\n        //mongoose.Promise = bluebird;\r\n        mongoose.connection\r\n            .on('error', (error) => reject(error))\r\n            .on('close', () => logger.info('Database connection closed.'))\r\n            .on('open', () => resolve(mongoose.connections[0]));\r\n\r\n        mongoose.connect(config.mongo.uri, config.mongo.options);\r\n    });\r\n}"]}